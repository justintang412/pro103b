(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a9d052f"],{"68b4":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Ivr-call-statistic"},[n("el-form",{ref:"form",attrs:{model:t.searchForm,inline:""}},[t.isSuper?n("el-form-item",{attrs:{label:"选择企业"}},[n("ui-ent-select",{on:{change:t.onSearch},model:{value:t.searchForm.entId,callback:function(e){t.$set(t.searchForm,"entId",e)},expression:"searchForm.entId"}})],1):t._e(),n("el-form-item",{attrs:{label:"选择时间范围"}},[n("ui-date-range-picker",{attrs:{type:"datetimerange"},on:{change:t.onTimeChange},model:{value:t.timerange,callback:function(e){t.timerange=e},expression:"timerange"}})],1),n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.onReset}},[t._v("重置")])],1)],1),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",["first"===t.activeName?n("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.exportFile}},[t._v("导出")]):t._e()],1)]),n("el-tabs",{on:{"tab-click":t.onSearch},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"统计表",name:"first"}},[n("ui-table",{ref:"table",attrs:{form:t.searchForm}})],1),n("el-tab-pane",{attrs:{label:"统计图",name:"second"}},[n("ui-chart",{ref:"chart"})],1)],1)],1)},a=[],r=n("3835"),o=n("5530"),s=n("a02a"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("chartMonitor",{ref:"ivrcallStatistic",attrs:{options:t.chartOption,spinShowParent:t.spinShow,totalParent:t.totalBol,widthParent:"95%",resize:t.resize}})},l=[],h=n("fba1"),u={components:{chartMonitor:h["a"]},data:function(){return{chartOption:{},spinShow:!0,totalBol:!1,resize:{}}},mounted:function(){window.addEventListener("resize",this.rowResize)},beforeDestroy:function(){window.removeEventListener("resize",this.rowResize)},methods:{onSearch:function(t){var e=this;this.rowResize(),this.$http("/analytics/ivr/chart",{params:t}).then((function(t){var n=t.data;e.spinShow=!0,e.chartOption=n}))},rowResize:function(){var t=this;this.$nextTick((function(){t.resize={},t.resize.width=t.$refs.ivrcallStatistic.offsetWidth,t.resize.height=t.$refs.ivrcallStatistic.offsetHeight}))}}},f=u,m=n("2877"),d=Object(m["a"])(f,c,l,!1,null,null,null),p=d.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-table-view",t._g(t._b({},"ui-table-view",t.viewProps,!1),t.viewListeners))},v=[],w=n("2909"),y=(n("99af"),{mixins:[window.mixTableView],data:function(){return{columnsNormal:[{title:"时间",width:180,key:"timeType",sortable:"custom"},{title:"通话量",key:"callInCount"},{title:"通话时长",render:function(t,e){var n=e.row;return t("span",Object(s["k"])(n.callInTimeLen))}},{title:"平均通话时长",minWidth:120,render:function(t,e){var n=e.row;return t("span",Object(s["k"])(n.aveTime))}},{title:"呼叫放弃数",key:"quitCount"}]}},computed:{isSuper:function(){return this.$store.getters.isAdmin},columns:function(){return this.isSuper?[{title:"企业名称",key:"entname"}].concat(Object(w["a"])(this.columnsNormal)):this.columnsNormal}},methods:{show:function(t){this.searchForm=Object(o["a"])({},t),this.tableForm=Object(o["a"])({},t),this.onSearch()},fetchMethod:function(t){return this.$http("/analytics/ivr/get/list",{params:t}).then((function(t){var e=t.data;return e}))},exportFile:function(){var t=this;this.$confirm("您当前导出数据为该筛选条件下的所有数据,请点击确定,继续导出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(t.tableData.total>5e4)return t.$confirm("当前导出数据量超过最大限制(50000条),请重新筛选数据后重试","注意",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});Object(s["i"])({fileName:"IVR呼叫统计查询导出.xls",action:function(){return t.$http("/analytics/ivr/export",{params:t.searchForm,responseType:"blob"})}})}))}}}),g=y,S=Object(m["a"])(g,b,v,!1,null,null,null),x=S.exports,O={name:"IvrCallStatistic",components:{uiChart:p,uiTable:x},data:function(){return{activeName:"first",searchForm:{},timerange:[]}},computed:{isSuper:function(){return this.$store.getters.isAdmin}},created:function(){this.setInitForm(),this.onSearch(),Object(s["g"])(this,this.onSearch)},methods:{onSearch:function(){var t=this;"first"===this.activeName?this.$nextTick((function(){t.$refs.table.show(Object(o["a"])(Object(o["a"])({},t.searchForm),{},{dateUnitType:t.dateUnitType}))})):this.$refs.chart.onSearch(Object(o["a"])(Object(o["a"])({},this.searchForm),{},{dateUnitTypeChart:this.dateUnitType}))},setInitForm:function(){var t=Object(s["o"])(),e=Object(r["a"])(t,2),n=e[0],i=e[1];this.timerange=[n,i],this.dateUnitType="second",this.searchForm={beginDate:+n,endDate:+i,entId:this.$store.state.userData.entid}},onReset:function(){this.setInitForm(),this.onSearch()},onTimeChange:function(t){var e=t||[],n=Object(r["a"])(e,2),i=n[0],a=n[1];this.searchForm.beginDate=i&&new Date(i).getTime(),this.searchForm.endDate=a&&new Date(a).getTime(),this.onSearch()},exportFile:function(){this.$refs.table.exportFile()}}},T=O,$=Object(m["a"])(T,i,a,!1,null,null,null);e["default"]=$.exports},"8c37":function(t,e,n){"use strict";n("b7fa")},b7fa:function(t,e,n){},fba1:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chartMonitor",style:{width:t.widthParent}},[n("div",{staticClass:"options"}),n("div",{ref:"echart",staticClass:"echart"})])},a=[];n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o=n("5530"),s=(n("b0c0"),n("565a")),c={name:"chartMonitor",data:function(){return{spinShow:!0,chart:null,theme:"echartsThemeGreenYellow",option:{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{data:[],type:"bar"}]}}},props:["options","spinShowParent","totalParent","widthParent","resize"],watch:{options:function(t){this.eChartInit(t)},spinShowParent:function(t){this.spinShow=t},resize:{handler:function(t){this.chart.resize()},deep:!0},totalParent:function(t){this.$alert("当前数据量过大,可能引起统计图卡顿,建议重新筛选数据后重试","提示")}},methods:{eChartInit:function(t){var e=Object(o["a"])({},t);e.dataZoom=[{show:!0,start:0,end:100},{type:"inside",start:0,end:100}],e.grid={right:"10%"},e.tooltip={trigger:"axis",axisPointer:{type:"cross"}},e.toolbox={feature:{dataView:{show:!0,readOnly:!1,optionToContent:function(t){for(var e=t.xAxis[0].data,n=t.series,i='<table style="width:100%;text-align:center"><tbody><tr><td>时间</td>',a=0;a<n.length;a++)i+="<td>"+n[a].name+"</td>";i+="</tr>";for(var r=0,o=e.length;r<o;r++){i+="<tr><td>"+e[r]+"</td>";for(var s=0;s<n.length;s++)i+="<td>"+n[s].data[r]+"</td>";i+="</tr>"}return i+="</tbody></table>",i}},restore:{show:!0},saveAsImage:{show:!0,name:"分析"}},right:20,top:-6,height:100},e&&"object"===r(e)&&(this.chart=s["a"].init(this.$refs.echart,this.theme),this.chart.setOption(e,!0)),this.spinShow=!1}},mounted:function(){this.eChartInit(this.option)}},l=c,h=(n("8c37"),n("2877")),u=Object(h["a"])(l,i,a,!1,null,null,null);e["a"]=u.exports}}]);