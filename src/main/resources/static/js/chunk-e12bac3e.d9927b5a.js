(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e12bac3e"],{"6c4b":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui-absolute-container"},[n("el-alert",{directives:[{name:"show",rawName:"v-show",value:!t.customerId,expression:"!customerId"}],attrs:{"show-icon":"",type:"warning",title:"该客户信息尚未保存，请单击编辑以保存客户信息"}}),n("div",{staticClass:"sub-container"},[n("customer-info",{ref:"CustomerInfo",staticClass:"customer-info",attrs:{params:t.customerParams,operationSource:7,onSendSms:t.onSendSms,mergeAction:t.mergeAction},on:{getCustomerId:t.getCustomerId,merged:t.onMerged}}),t.customerId?n("main",{staticClass:"main"},[n("header",{staticClass:"header"},[n("span",{staticClass:"title"},[t._v("历史动态")]),t.customerId?[n("el-button",{attrs:{icon:"el-icon-plus",type:"primary",plain:""},on:{click:t.onCreateWorkorder}},[t._v("创建工单")]),n("el-button",{attrs:{icon:"el-icon-plus",type:"primary",plain:""},on:{click:t.onAddContactPlan}},[t._v("添加联系计划")])]:t._e()],2),n("ui-tab-view",{ref:"UiTabView",attrs:{tabs:t.tabs,nocache:""}})],1):t._e()],1)],1)},r=[],c=n("1da1"),o=n("5530"),s=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("fd3b")),i=n("977e"),u=n("b2a1"),l=n("c71f"),d=n("65bd"),m=function(t,e){return{render:function(n){return n(t,{props:e})}}},f={components:{CustomerInfo:s["a"]},data:function(){return{customerId:null,customerParams:{}}},computed:{tabs:function(){var t={customerId:this.customerId};return this.customerId?[{label:"呼叫历史",component:m(i["a"],t)},{label:"工单",component:m(u["a"],t)},{label:"IM历史",component:m(l["a"],t)},{label:"联系计划",component:m(d["a"],t)}]:[]},callId:function(){return this.$route.params.callId},callType:function(){return this.$route.params.callType}},watch:{callId:"onMerged"},created:function(){this.setCustomerParams(),this.$route.meta.title=1===+this.callType?"来电信息":"呼叫信息"},beforeRouteUpdate:function(t,e,n){this.$route.meta.title=1===+t.params.callType?"来电信息":"呼叫信息",n()},methods:{setCustomerParams:function(){var t=this,e=this.$route.params;this.customerParams={customerSource:7,phone:e.phone,callId:e.callId,saveAction:function(n){return t.$post("/ccas/call/info/phone/bar/call/bind/customer",Object(o["a"])(Object(o["a"])({},n),{},{callId:e.callId}))}}},refresh:function(){var t=this.$refs.UiTabView;if(t){var e=t.getCurrentView();e&&(e.getData?e.getData():(e=e.$children[0],e&&e.getData()))}},openModal:function(t,e){this.$openModal(t,e,{success:this.refresh})},onCreateWorkorder:function(){this.openModal((function(){return n.e("chunk-497ef431").then(n.bind(null,"4bd2"))}),{customerInfo:{channelId:1,customerId:this.customerId}})},onAddContactPlan:function(){this.openModal((function(){return n.e("chunk-b4cb56ec").then(n.bind(null,"f935"))}),{customerId:this.customerId})},getCustomerId:function(t){this.customerId=t},onSendSms:function(t){this.$openModal((function(){return n.e("chunk-97d13c26").then(n.bind(null,"3772"))}),{row:{contactPhone:t},userData:this.$store.state.userData})},mergeAction:function(t){return this.$post("/ccas/call/info/phone/bar/call/bind/merge/customer",Object(o["a"])(Object(o["a"])({},t),{},{callId:this.callId}))},onMerged:function(){var t=this;this.setCustomerParams(),this.$nextTick(Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.CustomerInfo.getInitData();case 2:t.refresh();case 3:case"end":return e.stop()}}),e)}))))}}},b=f,h=(n("ca2e"),n("2877")),p=Object(h["a"])(b,a,r,!1,null,"6de36bf4",null);e["default"]=p.exports},ca2e:function(t,e,n){"use strict";n("e614")},de0b:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var a=n("ade3"),r="customer-center",c={CUSTOMER_CENTER:1,WECHAT:2,APP:3,PC_WEB:4,WEIBO:5,MOB_WEB:6,CALL_CENTER:7,WO_CENTER:8,ENT_WECHAT:9,WECHAT_APP:10,EMAIL:11},o=function(t){var e;return e={},Object(a["a"])(e,t.CUSTOMER_CENTER,"客户中心"),Object(a["a"])(e,t.WECHAT,"微信"),Object(a["a"])(e,t.APP,"APP"),Object(a["a"])(e,t.PC_WEB,"桌面网站"),Object(a["a"])(e,t.WEIBO,"微博"),Object(a["a"])(e,t.MOB_WEB,"移动网站"),Object(a["a"])(e,t.CALL_CENTER,"呼叫中心"),Object(a["a"])(e,t.WO_CENTER,"工单中心"),Object(a["a"])(e,t.ENT_WECHAT,"企业微信"),Object(a["a"])(e,t.WECHAT_APP,"微信小程序"),Object(a["a"])(e,t.EMAIL,"邮件"),e}(c),s={BASE:1,VIP:2},i=function(t){var e;return e={},Object(a["a"])(e,t.BASE,"普通客户"),Object(a["a"])(e,t.VIP,"VIP客户"),e}(s)},e614:function(t,e,n){}}]);