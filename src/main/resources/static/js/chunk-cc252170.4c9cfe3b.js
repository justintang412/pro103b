(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cc252170"],{"831b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ui-modal",e._g(e._b({},"ui-modal",e.modalProps,!1),e.$listeners),[a("el-form",{ref:"Form",attrs:{"label-width":"6em",model:e.form,rules:e.rules}},[a("div",{staticClass:"form-header"},[e._v("基本信息")]),a("ui-text-field",{attrs:{label:"标题",prop:"triggerName"},model:{value:e.form.triggerName,callback:function(t){e.$set(e.form,"triggerName",t)},expression:"form.triggerName"}}),a("ui-text-field",{attrs:{label:"描述",type:"textarea"},model:{value:e.form.triggerDesc,callback:function(t){e.$set(e.form,"triggerDesc",t)},expression:"form.triggerDesc"}}),a("div",{staticClass:"form-header"},[e._v("触发条件")]),a("ui-select",{attrs:{label:"呼叫类型"},model:{value:e.form.conditionName,callback:function(t){e.$set(e.form,"conditionName",t)},expression:"form.conditionName"}},[a("el-option",{attrs:{label:"呼入",value:"1"}}),a("el-option",{attrs:{label:"呼出",value:"2"}})],1),a("ui-select",{attrs:{label:"呼叫结果",prop:"optionsName"},model:{value:e.form.optionsName,callback:function(t){e.$set(e.form,"optionsName",t)},expression:"form.optionsName"}},e._l(e.options[e.form.conditionName-1],(function(e,t){return a("el-option",{key:t,attrs:{value:e}})})),1),a("div",{staticClass:"form-header"},[e._v("短信选择")]),a("ui-select",{attrs:{label:"选择模板",prop:"templateConfigId",options:e.templateData,props:{key:"id",value:"templateId",label:"templateName"},filterable:""},on:{change:e.changeTemplate},model:{value:e.form.templateConfigId,callback:function(t){e.$set(e.form,"templateConfigId",t)},expression:"form.templateConfigId"}}),a("el-form-item",{attrs:{label:"短信内容"}},[a("el-input",{attrs:{type:"textarea",rows:"8",disabled:""},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}),a("div",{staticStyle:{"text-align":"right"}},[e._v(e._s(e.charCount))])],1)],1)],1)},o=[],n=a("5530"),i=a("1da1"),l=(a("99af"),a("4de4"),a("d3b7"),a("7db0"),a("96cf"),a("a02a")),s={props:["row","entId"],data:function(){var e=this;return{form:{},options:[["坐席接听","振铃未接听","IVR放弃","排队放弃","排队超时","非服务时间来电","客户速挂"],["客户接听","客户未接听","客户拒接","客户关机","暂时无法接通","客户正在通话"]],templateData:[],rules:{triggerName:Object(l["y"])("请输入标题"),optionsName:Object(l["z"])("请选择呼叫结果"),templateConfigId:Object(l["z"])("请选择短信模板")},modalProps:{drawer:!0,isEdit:!!this.row,width:"580px",onSubmit:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:return a=e.row?"/message/trigger/updateTrigger":"/message/trigger/createTrigger",t.next=5,e.$http.post(a,Object(n["a"])(Object(n["a"])({},e.form),{},{entId:e.entId}));case 5:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()}}},computed:{charCount:function(){var e=this.form.content||"",t=e.length,a=t>70?Math.ceil(t/67):1;return"".concat(t,"字/").concat(a,"条")}},mounted:function(){this.getTemplate()},methods:{getTemplate:function(){var e=this;this.$post("/message/template/getMessageTemplate",{entId:this.entId}).then((function(t){var a=t.data;e.templateData=a.list.filter((function(e){return 1===+e.templateStatus}));var r=e.row;e.form=r?Object(n["a"])({},r):{conditionName:"1",content:""},r&&e.changeTemplate(r.templateConfigId)}))},changeTemplate:function(e){var t=this.templateData.find((function(t){return t.templateId===e}));this.form.content=t?t.templateContent:""}}},c=s,m=(a("a6ff"),a("2877")),f=Object(m["a"])(c,r,o,!1,null,"299c1acc",null);t["default"]=f.exports},a6ff:function(e,t,a){"use strict";a("fe78")},fe78:function(e,t,a){}}]);