(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b2aa7e7"],{"0406":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({attrs:{columns:e.columns},scopedSlots:e._u([{key:"search",fn:function(){return[e.isSuper?n("el-form-item",{attrs:{label:"选择企业"}},[n("ui-ent-select",{on:{change:e.onSearch},model:{value:e.searchForm.entId,callback:function(t){e.$set(e.searchForm,"entId",t)},expression:"searchForm.entId"}})],1):e._e(),n("ui-text-field",{attrs:{label:"工号/姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}}),n("el-form-item",{attrs:{label:"选择时间范围"}},[n("ui-date-range-picker",{attrs:{type:"datetimerange",valueFormat:"timestamp"},on:{change:e.onTimeChange},model:{value:e.timerange,callback:function(t){e.timerange=t},expression:"timerange"}})],1),n("ui-text-field",{attrs:{label:"主叫/被叫号码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.callNum,callback:function(t){e.$set(e.searchForm,"callNum",t)},expression:"searchForm.callNum"}}),n("ui-select",{attrs:{label:"呼叫类型",options:e.callTyps},on:{change:e.onSearch},model:{value:e.searchForm.callType,callback:function(t){e.$set(e.searchForm,"callType",t)},expression:"searchForm.callType"}}),n("ui-select",{attrs:{label:"呼叫方向",clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.dir,callback:function(t){e.$set(e.searchForm,"dir",t)},expression:"searchForm.dir"}},[n("el-option",{attrs:{value:"0",label:"呼出"}}),n("el-option",{attrs:{value:"1",label:"呼入"}})],1),n("ui-select",{attrs:{label:"技能组",options:e.queueList,props:{value:"queueId",label:"queueName"},clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.queueid,callback:function(t){e.$set(e.searchForm,"queueid",t)},expression:"searchForm.queueid"}})]},proxy:!0},{key:"actions",fn:function(){return[n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.exportFile}},[e._v("导出")])],1)]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},i=[],r=n("5530"),o=n("3835"),l=n("1da1"),c=(n("96cf"),n("99af"),n("d3b7"),n("a02a")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"})},u=[],d={props:["src"],watch:{src:function(e){this.pause(),this.audio.src=e,this.play()}},mounted:function(){this.audio=new Audio(this.src),this.audio.controls=!0,this.play(),this.$el.appendChild(this.audio)},methods:{play:function(){var e=this;this.audio.play().catch((function(t){e.$message.error({duration:3,content:"<b>播放失败：</b>".concat(t.message)})}))},pause:function(){this.audio.pause()}}},h=d,m=(n("2926"),n("2877")),p=Object(m["a"])(h,s,u,!1,null,"0832446e",null),f=p.exports,b={name:"SeatCallStatistic",mixins:[window.mixTableView],data:function(){return{timerange:[],audioLoading:!1,callTyps:[{label:"IVR",value:"dyflow"},{label:"ACD",value:"user"},{label:"话机直拨",value:"dialout"},{label:"呼损数据",value:"callFailed"}],queueList:[]}},computed:{isSuper:function(){return this.$store.getters.isAdmin},columns:function(){var e=this,t=[{title:"呼叫ID",minWidth:100,key:"callid"},{title:"开始时间",width:140,key:"starttime",sortable:!0},{title:"接通时间",width:140,key:"connecttime",sortable:!0},{title:"结束时间",width:140,key:"endtime",sortable:!0},{title:"呼叫结果",minWidth:100,key:"dropcause",render:function(e,t){var n=t.row;return e("span",n.connecttime?"已接听":"未接听")}},{title:"呼叫类型",minWidth:100,key:"callTypeStr"},{title:"呼叫方向",minWidth:100,key:"dir"},{title:"主叫号码",minWidth:140,key:"caller"},{title:"被叫号码",minWidth:140,key:"called"},{title:"服务坐席姓名",minWidth:110,key:"workname"},{title:"服务坐席工号",minWidth:120,key:"workno"},{title:"技能组",key:"queueName"},{title:"振铃时间",render:function(e,t){var n=t.row;return e("span",Object(c["k"])(n.acmTime))}},{title:"通话时长",render:function(e,t){var n=t.row;return e("span",Object(c["k"])(n.callTime))}},{title:"持续时长",render:function(e,t){var n=t.row;return e("span",Object(c["k"])(n.lastTime))}},{title:"操作",width:100,fixed:"right",render:function(t,n){var a=n.row;return e.$hBtns([a.connecttime&&{label:"播放录音",action:e.onPlay}])(t,{row:a})}}];return this.isSuper?[{title:"企业名称",width:100,key:"entname"}].concat(t):t},entId:function(){return this.$store.state.userData.entid}},mounted:function(){this.setInitForm(),this.getData(),Object(c["g"])(this,this.getData),this.getQueueList()},methods:{getQueueList:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/queue/getAllQueueNoPage?entId=".concat(e.entId));case 2:e.queueList=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},fetchMethod:function(e){return Object(c["m"])(this.searchForm.beginDate)>this.searchForm.endDate?this.$http("/calldetail/search",{params:e}).then((function(e){return e.data})):Object(c["C"])("时间范围不能超过半年")},setInitForm:function(){var e=Object(c["o"])(),t=Object(o["a"])(e,2),n=t[0],a=t[1];this.timerange=[n,a],this.tableForm={entId:this.entId,dateUnitType:"second",callType:"dialout",beginDate:+n,endDate:+a},this.searchForm=Object(r["a"])({},this.tableForm)},onTimeChange:function(e){var t=e||[],n=Object(o["a"])(t,2),a=n[0],i=n[1];this.searchForm=Object(r["a"])(Object(r["a"])({},this.searchForm),{},{beginDate:a,endDate:i}),this.onSearch()},exportFile:function(){var e=this;this.$confirm("您当前导出数据为该筛选条件下的所有数据,请点击确定,继续导出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(e.tableData.total>5e4)return e.$confirm("当前导出数据量超过最大限制(50000条),请重新筛选数据后重试","注意",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});Object(c["i"])({fileName:"通话详情分析数据导出.xls",action:function(){return e.$http("/calldetail/export",{params:e.searchForm,responseType:"blob"})}})}))},onPlay:function(e){var t=this;this.audioLoading||(this.audioLoading=!0,this.$http("/calldetail/get/recorde?recordePath=".concat(e.recordfilename)).then((function(e){var n=e.data,a=t.$createElement;t.$msgbox({title:"录音播放",message:a(f,{props:{src:n.localPath},ref:"AudioPlay"}),showCancelButton:!0,cancelButtonText:"关闭",beforeClose:function(e,n,a){t.$refs.AudioPlay.pause(),a()}})})).finally((function(){t.audioLoading=!1})))}}},y=b,k=Object(m["a"])(y,a,i,!1,null,null,null);t["default"]=k.exports},2926:function(e,t,n){"use strict";n("79c4")},"79c4":function(e,t,n){}}]);