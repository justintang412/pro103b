(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a976c8b0"],{"8c37":function(t,e,n){"use strict";n("b7fa")},b7fa:function(t,e,n){},f2a0:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"Ivr-call-statistic"},[n("el-form",{ref:"form",attrs:{model:t.searchForm,inline:""}},[t.isSuper?n("el-form-item",{attrs:{label:"选择企业"}},[n("ui-ent-select",{on:{change:function(e){return t.changeEntId(t.searchForm.entId)}},model:{value:t.searchForm.entId,callback:function(e){t.$set(t.searchForm,"entId",e)},expression:"searchForm.entId"}})],1):t._e(),n("el-form-item",{attrs:{label:"选择时间范围"}},[n("ui-date-range-picker",{attrs:{type:"datetimerange"},on:{change:t.onTimeChange},model:{value:t.timerange,callback:function(e){t.timerange=e},expression:"timerange"}})],1),n("ui-text-field",{attrs:{label:"工号/姓名"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.searchForm.condition,callback:function(e){t.$set(t.searchForm,"condition",e)},expression:"searchForm.condition"}}),n("ui-select",{attrs:{label:"技能组",options:t.skillGroups,props:{value:"queueName",key:"queueId"},filterable:"",clearable:""},on:{change:t.onSearch},model:{value:t.searchForm.queueName,callback:function(e){t.$set(t.searchForm,"queueName",e)},expression:"searchForm.queueName"}}),n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-search"},on:{click:t.onSearch}},[t._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.onReset}},[t._v("重置")])],1)],1),n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",["first"===t.activeName?n("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.exportFile}},[t._v("导出")]):t._e()],1)]),n("el-tabs",{on:{"tab-click":t.onSearch},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"统计表",name:"first"}},[n("ui-table",{ref:"table",attrs:{form:t.searchForm}})],1),n("el-tab-pane",{attrs:{label:"统计图",name:"second"}},[n("ui-chart",{ref:"chart"})],1)],1)],1)},r=[],a=n("3835"),o=n("5530"),s=n("a02a"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("chartMonitor",{ref:"ivrcallStatistic",attrs:{options:t.chartOption,spinShowParent:t.spinShow,totalParent:t.totalBol,widthParent:"95%",resize:t.resize}})},l=[],h=n("fba1"),u={components:{chartMonitor:h["a"]},data:function(){return{chartOption:{},spinShow:!0,totalBol:!1,resize:{}}},mounted:function(){window.addEventListener("resize",this.rowResize)},beforeDestroy:function(){window.removeEventListener("resize",this.rowResize)},methods:{onSearch:function(t){var e=this;this.rowResize(),this.$http("/analysis/workopt/chart",{params:t}).then((function(t){var n=t.data;e.spinShow=!0,e.chartOption=n}))},rowResize:function(){var t=this;this.$nextTick((function(){t.resize={},t.resize.width=t.$refs.ivrcallStatistic.offsetWidth,t.resize.height=t.$refs.ivrcallStatistic.offsetHeight}))}}},m=u,f=n("2877"),d=Object(f["a"])(m,c,l,!1,null,null,null),p=d.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-table-view",t._g(t._b({attrs:{columns:t.columns}},"ui-table-view",t.viewProps,!1),t.viewListeners))},v=[],w=n("2909"),y=(n("99af"),{mixins:[window.mixTableView],data:function(){return{columnsNormal:[{title:"时间",key:"timeType",width:170,sortable:"custom"},{title:"工号",key:"workno",minWidth:80},{title:"姓名",key:"workname",minWidth:80},{title:"技能组",key:"name",minWidth:100},{title:"休息类型",key:"restType",minWidth:100},{title:"休息时长",render:function(t,e){var n=e.row;return t("span",Object(s["k"])(n.restTime))}},{title:"休息次数",key:"restCount",minWidth:100}]}},computed:{isSuper:function(){return this.$store.getters.isAdmin},columns:function(){return this.isSuper?[{title:"企业名称",key:"entname"}].concat(Object(w["a"])(this.columnsNormal)):this.columnsNormal}},methods:{show:function(t){this.searchForm=Object(o["a"])({},t),this.tableForm=Object(o["a"])({},t),this.onSearch()},fetchMethod:function(t){return this.$http("/analysis/work/rest/get/list",{params:t}).then((function(t){var e=t.data;return e}))},exportFile:function(){var t=this;this.$confirm("您当前导出数据为该筛选条件下的所有数据,请点击确定,继续导出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(t.tableData.total>5e4)return t.$confirm("当前导出数据量超过最大限制(50000条),请重新筛选数据后重试","注意",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});Object(s["i"])({fileName:"坐席休息分析统计表导出.xls",action:function(){return t.$http("/analysis/work/rest/export",{params:t.formCustom,responseType:"blob"})}})}))}}}),g=y,k=Object(f["a"])(g,b,v,!1,null,null,null),S=k.exports,x={name:"IvrCallStatistic",components:{uiChart:p,uiTable:S},data:function(){return{activeName:"first",skillGroups:[],searchForm:{},timerange:[]}},computed:{isSuper:function(){return this.$store.getters.isAdmin},entId:function(){return this.$store.state.userData.entid}},mounted:function(){var t=this;this.setInitForm();var e=function(){t.onSearch(),t.getSkillGroups(t.searchForm.entId)};e(),Object(s["g"])(this,e)},methods:{onSearch:function(){"first"===this.activeName?this.$refs.table.show(Object(o["a"])(Object(o["a"])({},this.searchForm),{},{dateUnitType:this.dateUnitType})):this.$refs.chart.onSearch(Object(o["a"])(Object(o["a"])({},this.searchForm),{},{dateUnitTypeChart:this.dateUnitType}))},setInitForm:function(){var t=Object(s["o"])(),e=Object(a["a"])(t,2),n=e[0],i=e[1];this.timerange=[n,i],this.dateUnitType="second",this.searchForm={entId:this.entId,beginDate:+n,endDate:+i}},onReset:function(){this.setInitForm(),this.onSearch()},onTimeChange:function(t){var e=t||[],n=Object(a["a"])(e,2),i=n[0],r=n[1];this.searchForm.beginDate=i&&new Date(i).getTime(),this.searchForm.endDate=r&&new Date(r).getTime(),this.onSearch()},exportFile:function(){this.$refs.table.exportFile()},changeEntId:function(t){this.onSearch(),this.getSkillGroups(t)},getSkillGroups:function(t){var e=this;this.$set(this.searchForm,"queueName",""),this.$http("/queue/getAllQueueNoPage",{params:{entId:t}}).then((function(t){var n=t.data;e.skillGroups=n}))}}},F=x,O=Object(f["a"])(F,i,r,!1,null,null,null);e["default"]=O.exports},fba1:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chartMonitor",style:{width:t.widthParent}},[n("div",{staticClass:"options"}),n("div",{ref:"echart",staticClass:"echart"})])},r=[];n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}var o=n("5530"),s=(n("b0c0"),n("565a")),c={name:"chartMonitor",data:function(){return{spinShow:!0,chart:null,theme:"echartsThemeGreenYellow",option:{xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{data:[],type:"bar"}]}}},props:["options","spinShowParent","totalParent","widthParent","resize"],watch:{options:function(t){this.eChartInit(t)},spinShowParent:function(t){this.spinShow=t},resize:{handler:function(t){this.chart.resize()},deep:!0},totalParent:function(t){this.$alert("当前数据量过大,可能引起统计图卡顿,建议重新筛选数据后重试","提示")}},methods:{eChartInit:function(t){var e=Object(o["a"])({},t);e.dataZoom=[{show:!0,start:0,end:100},{type:"inside",start:0,end:100}],e.grid={right:"10%"},e.tooltip={trigger:"axis",axisPointer:{type:"cross"}},e.toolbox={feature:{dataView:{show:!0,readOnly:!1,optionToContent:function(t){for(var e=t.xAxis[0].data,n=t.series,i='<table style="width:100%;text-align:center"><tbody><tr><td>时间</td>',r=0;r<n.length;r++)i+="<td>"+n[r].name+"</td>";i+="</tr>";for(var a=0,o=e.length;a<o;a++){i+="<tr><td>"+e[a]+"</td>";for(var s=0;s<n.length;s++)i+="<td>"+n[s].data[a]+"</td>";i+="</tr>"}return i+="</tbody></table>",i}},restore:{show:!0},saveAsImage:{show:!0,name:"分析"}},right:20,top:-6,height:100},e&&"object"===a(e)&&(this.chart=s["a"].init(this.$refs.echart,this.theme),this.chart.setOption(e,!0)),this.spinShow=!1}},mounted:function(){this.eChartInit(this.option)}},l=c,h=(n("8c37"),n("2877")),u=Object(h["a"])(l,i,r,!1,null,null,null);e["a"]=u.exports}}]);