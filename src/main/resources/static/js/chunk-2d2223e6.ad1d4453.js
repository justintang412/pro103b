(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2223e6"],{ce7e:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ui-table-view",e._g(e._b({on:{"sort-change":e.onSort},scopedSlots:e._u([{key:"search",fn:function(){return[r("ui-select",{attrs:{label:"节点",options:e.nodeList,props:{value:"modluenode"}},on:{change:e.onSearch},model:{value:e.searchForm.moduleNode,callback:function(t){e.$set(e.searchForm,"moduleNode",t)},expression:"searchForm.moduleNode"}}),e.isSuper?r("el-form-item",{attrs:{label:"所属企业"}},[r("ui-ent-select",{on:{change:e.onSearch},model:{value:e.searchForm.entId,callback:function(t){e.$set(e.searchForm,"entId",t)},expression:"searchForm.entId"}})],1):e._e(),r("ui-select",{attrs:{label:"服务渠道",options:e.serviceChannels,clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.modulename,callback:function(t){e.$set(e.searchForm,"modulename",t)},expression:"searchForm.modulename"}})]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},o=[],a=r("1da1"),i=r("5530"),s=(r("96cf"),r("a02a")),c={name:"HomeCallMonitor",mixins:[window.mixTableView],data:function(){return{serviceChannels:{acd:"坐席",dyflow:"IVR"},nodeList:[],columns:[{label:"服务渠道",prop:"modulename"},{label:"呼叫方向",render:function(e,t){var r=t.row;return e("div",r.dir?"呼入":"呼出")}},{label:"主叫号码",prop:"caller"},{label:"被叫号码",prop:"called"},{label:"用户呼叫开始时间",width:150,prop:"userstarttime",sortable:"custom"},{label:"用户呼叫应答时间",width:140,prop:"userconnecttime"},{label:"用户转队列时间",width:140,prop:"usertoflowtime"},{label:"队列",render:function(e,t){var r=t.row;return e("div",r.queueid||"")}},{label:"分配坐席时间",width:140,prop:"workstarttimetime"},{label:"坐席服务时间",width:140,prop:"workconnecttime"},{label:"服务坐席号",prop:"agent"},{label:"操作",width:120,fixed:"right",render:this.$hBtns([{label:"挂断",action:this.onDropOut},{label:"停止监控",action:this.onStopMonitor}])}]}},computed:{isSuper:function(){return this.$store.getters.isAdmin}},mounted:function(){this.setInitForm(),this.getInitData(),Object(s["g"])(this,this.getInitData,this.clearTimer),this.$once("hook:beforeDestroy",this.clearTimer)},methods:{setForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.tableForm=e,this.searchForm=Object(i["a"])({},e)},setInitForm:function(){this.setForm({orderKey:this.searchForm.orderKey,orderRule:this.searchForm.orderRule,moduleNode:(this.nodeList[0]||{}).modluenode,entId:this.$store.state.userData.entid})},clearTimer:function(){clearTimeout(this.tid),this.tid=null},getInitData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.searchForm.moduleNode){t.next=5;break}e.getData(),e.getNodeList(),t.next=9;break;case 5:return t.next=7,e.getNodeList();case 7:e.setForm(Object(i["a"])(Object(i["a"])({},e.searchForm),{},{moduleNode:(e.nodeList[0]||{}).modluenode})),e.getData();case 9:case"end":return t.stop()}}),t)})))()},fetchMethod:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http("/monitor/call/info/get/list",{params:e});case 2:return n=r.sent,o=n.data,t.clearTimer(),t.tid=setTimeout(t.getData.bind(t),5e3),r.abrupt("return",o);case 7:case"end":return r.stop()}}),r)})))()},getNodeList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/monitor/call/info/get/all/node");case 2:e.nodeList=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},onSort:function(e){var t=e.prop,r=e.order,n=r&&{ascending:"asc",descending:"desc"}[r];this.searchForm=Object(i["a"])(Object(i["a"])({},this.searchForm),n?{orderKey:t,orderRule:n}:{orderKey:"",orderRule:""}),this.onSearch()},onDropOut:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("您确定要继续挂断吗","注意");case 2:return r.next=4,t.$post("/monitor/call/info/dropout",e);case 4:n=r.sent,t.$message.success(n.info),t.getData();case 7:case"end":return r.stop()}}),r)})))()},onStopMonitor:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("您确定要停止监控么？","温馨提醒");case 2:return r.next=4,t.$http("/monitor/call/info/stopmonitor",{params:{ids:e.id}});case 4:t.$message.success("操作成功"),t.getData();case 6:case"end":return r.stop()}}),r)})))()}}},u=c,l=r("2877"),d=Object(l["a"])(u,n,o,!1,null,null,null);t["default"]=d.exports}}]);