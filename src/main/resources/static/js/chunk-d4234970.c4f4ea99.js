(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d4234970"],{"89d2":function(e,t,n){e.exports={pointer:"style-module_pointer_18vYX",flexCenter:"style-module_flexCenter_qMqRZ",flex1:"style-module_flex1_TeLzv"}},f3b6:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[n("ui-text-field",{attrs:{label:"批次名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.eventName,callback:function(t){e.$set(e.searchForm,"eventName",t)},expression:"searchForm.eventName"}}),n("ui-select",{attrs:{label:"批次状态",clearable:"",multiple:"","collapse-tags":""},on:{change:e.onStatusChange},model:{value:e.eventStatus,callback:function(t){e.eventStatus=t},expression:"eventStatus"}},e._l(e.batchStatus,(function(e,t){return n("el-option",{key:t,attrs:{value:t,label:e.text}})})),1),n("el-form-item",{attrs:{label:"批次时效"}},[n("el-date-picker",{attrs:{placeholder:"请选择",type:"datetime","value-format":"timestamp"},on:{change:e.onSearch},model:{value:e.searchForm.validEndTime,callback:function(t){e.$set(e.searchForm,"validEndTime",t)},expression:"searchForm.validEndTime"}})],1),n("ui-select",{attrs:{label:"优先级",options:e.priorities,clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.eventLevel,callback:function(t){e.$set(e.searchForm,"eventLevel",t)},expression:"searchForm.eventLevel"}}),n("ui-select",{attrs:{label:"场景",options:e.scenes,props:{value:"sceneId",label:"sceneName"},clearable:"",filterable:""},on:{change:e.onSearch},model:{value:e.searchForm.eventSceneId,callback:function(t){e.$set(e.searchForm,"eventSceneId",t)},expression:"searchForm.eventSceneId"}})]},proxy:!0},{key:"actions",fn:function(){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onEdit()}}},[e._v("添加批次")]),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:!e.selectedRow.length},on:{click:function(t){return e.onDelete(e.selectedRow)}}},[e._v("删除已选")])]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},r=[],s=n("5530"),o=n("1da1"),c=(n("96cf"),n("caad"),n("2532"),n("d81d"),n("99af"),n("d3b7"),n("3ca3"),n("ddb0"),n("a02a")),i=n("89d2"),l=n.n(i),u=n("5cdf"),d={name:"OcmPreviewBatch",mixins:[window.mixTableView],data:function(){var e=this;return{batchStatus:u["a"],priorities:u["j"],scenes:[],eventStatus:[],columns:[{type:"selection"},{label:"批次名称",prop:"eventName"},{label:"执行进度",minWidth:140,render:function(t,n){var a=n.row;return t("div",{class:l.a.flexCenter},[t("el-progress",{class:l.a.flex1,props:{showText:!1,strokeWidth:6,percentage:e.getPercent(a)}}),t("span",(a.calledCount||0)+"/"+(a.listCount||0))])}},{label:"外呼组",prop:"assignQueueName"},{label:"优先级",render:function(e,t){var n=t.row;return e("div",u["j"][n.eventLevel])}},{label:"当前状态",render:function(t,n){var a=n.row,r=u["a"][a.eventStatus];return r&&t("el-tag",{class:l.a.pointer,props:{type:r.type},on:{click:e.onToggleStatus.bind(e,a)}},r.text)}},{label:"场景",prop:"sceneName"},{label:"创建人",prop:"creatorName"},{label:"创建时间",prop:"createTime",minWidth:140},{label:"到期时间",minWidth:140,render:function(e,t){var n=t.row;return e("div",{1:"永久",2:n.validEndTime}[n.validTimeType])}},{label:"操作",width:200,fixed:"right",render:function(t,n){var a=n.row,r=[u["d"].NOTEXECUT,u["d"].PAUSED].includes(a.eventStatus);return e.$hBtns([{label:"详情",action:e.onView},{label:"编辑",action:e.onEdit,props:{disabled:!r}},{label:"导入",action:e.onImport,props:{disabled:!r}},{label:"分派",action:e.onDispatch,props:{disabled:!r}},{label:"回收",action:e.onRecover,props:{disabled:!(r||a.eventStatus===u["d"].EXPIRED)}}])(t,{row:a})}}]}},mounted:function(){this.getInitData(),Object(c["g"])(this,this.getInitData)},methods:{setInitForm:function(){this.eventStatus=[],this.tableForm={},this.searchForm={}},getInitData:function(){this.getData(),this.getScenes()},fetchMethod:function(e){return this.$http("/ccas/call/manual/event/list",{params:e}).then((function(e){return e.data}))},onDelete:function(e){var t=this;this.delData({rows:e,action:function(){return t.$http("/ccas/call/manual/event/del",{params:{eventIds:e.map((function(e){return e.eventId}))+""}})}})},getScenes:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/call/manual/event/scene/list");case 2:e.scenes=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},onView:function(e){this.$router.push("".concat(this.$route.path,"/").concat(e.eventId))},onEdit:function(e){var t={row:e,userData:this.$store.state.userData};this.$openModal((function(){return n.e("chunk-2d238027").then(n.bind(null,"fe0b"))}),t,{success:this.onEditSuccess})},onRecover:function(e){e.listCount>e.calledCount?this.$openModal((function(){return n.e("chunk-9393dc78").then(n.bind(null,"a043"))}),{row:e},{success:this.onEditSuccess}):this.$message.warning("没有可回收的名单")},onImport:function(e){this.$openModal((function(){return n.e("chunk-7c023c59").then(n.bind(null,"e00f"))}),{row:e},{success:this.onEditSuccess})},onDispatch:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http("/ccas/call/manual/event/assignable/list/count/".concat(e.eventId));case 2:r=a.sent,s=r.data,s?t.$openModal((function(){return n.e("chunk-30a44021").then(n.bind(null,"abe4"))}),{row:e,total:s}):t.$message.warning("没有可分派的名单");case 5:case"end":return a.stop()}}),a)})))()},getPercent:function(e){return e.listCount?e.calledCount/e.listCount*100:0},onStatusChange:function(e){this.searchForm=Object(s["a"])(Object(s["a"])({},this.searchForm),{},{eventStatus:e+""}),this.onSearch()},onToggleStatus:function(e){var t=this,n=function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(a){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$post("/ccas/call/manual/event/update/event/status",{eventStatus:a,eventId:e.eventId});case 2:t.getData();case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();[u["d"].NOTEXECUT,u["d"].PAUSED].includes(e.eventStatus)?this.$confirm("要执行该批次吗？","执行批次").then((function(){return n(u["d"].EXECUTING)})):e.eventStatus===u["d"].EXECUTING&&this.$confirm("要暂停该批次吗？","暂停批次").then((function(){return n(u["d"].PAUSED)}))}}},h=d,p=n("2877"),v=Object(p["a"])(h,a,r,!1,null,null,null);t["default"]=v.exports}}]);