(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30cc16da"],{"02ea":function(e,t,n){},"251c":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[e.isSuper?n("el-form-item",{attrs:{label:"所属企业"}},[n("ui-ent-select",{on:{change:e.onEntChange},model:{value:e.searchForm.entId,callback:function(t){e.$set(e.searchForm,"entId",t)},expression:"searchForm.entId"}})],1):e._e(),n("ui-select",{attrs:{label:"所属技能组",clearable:"",options:e.selectSkill,props:{value:"queueId",label:"queueName"}},on:{change:e.onSearch},model:{value:e.searchForm.queueId,callback:function(t){e.$set(e.searchForm,"queueId",t)},expression:"searchForm.queueId"}}),n("ui-text-field",{attrs:{placeholder:"请输入坐席号/坐席姓名查询"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners),[n("el-button",{attrs:{slot:"search-right",type:"primary",icon:"el-icon-download"},on:{click:e.onExport},slot:"search-right"},[e._v("导出")]),n("ul",{attrs:{slot:"actions"},slot:"actions"},e._l(e.callStatus,(function(t){return n("li",{key:t.code,class:["statusItem",{active:e.isStatusActive(t)}],on:{click:function(n){return e.onStatusChange(t)}}},[n("i",{class:["iconfont","icon-"+t.icon]}),n("div",[e._v(e._s(t.label))])])})),0)],1)},a=[],o=n("1da1"),c=n("5530"),i=(n("96cf"),n("7db0"),n("d3b7"),n("a434"),n("caad"),n("2532"),n("a02a")),s={name:"HomeSeatMonitor",mixins:[window.mixTableView],data:function(){var e=this;return{selectSkill:[],searchForm:{yccallstate:[]},callStatus:[{label:"签入",code:1,icon:"qianru"},{label:"上线",code:2,icon:"shangxian"},{label:"上线忙",code:11,icon:"mangluzhong-copy"},{label:"通话中",code:3,icon:"tonghuazhong1"},{label:"呼出",code:31,icon:"huchudianhua"},{label:"振铃",code:32,icon:"zhenlingzheng-copy"},{label:"忙碌",code:4,icon:"manglu1"},{label:"保持",code:5,icon:"tonghuabaochi"},{label:"监听通话",code:9,icon:"jianting"},{label:"插入通话",code:10,icon:"shenqingjieru"}],columns:[{title:"坐席工号",key:"workno"},{title:"坐席姓名",key:"workname"},{title:"当前队列",key:"queueName"},{title:"角色",minWidth:80,render:function(e,t){var n=t.row;return e("div",{0:"坐席",1:"组长",2:"质检",3:"管理员"}[n.role])}},{title:"当前状态",minWidth:80,align:"center",render:function(t,n){var r=n.row,a=e.callStatus.find((function(e){return e.code===r.yccallstate}));return a&&t("el-tooltip",{props:{content:a.label}},[t("i",{class:"iconfont icon-".concat(a.icon),style:"color:#00cdb1;font-size:20px;"})])}},{title:"签入类型",minWidth:80,render:function(e,t){var n=t.row;return e("div",{0:"前端签入",1:"后端签入"}[n.worktype])}},{title:"签入号码",key:"station"},{title:"用户呼叫方向",minWidth:105,render:function(e,t){var n=t.row;return e("div",{0:"呼出",1:"呼入"}[n.userdir])}},{title:"用户号码",key:"userno"},{title:"操作",width:125,fixed:"right",render:function(t,n){var r=n.row;return e.$hBtns([{label:"签出",action:e.onCheckOut},3===r.yccallstate&&{label:"挂断",action:e.onDropOut},0===r.setbusy?{label:"置忙",action:e.setbusy}:{label:"置闲",action:e.onSetIdle}])(t,{row:r})}}]}},computed:{isSuper:function(){return this.$store.getters.isAdmin}},mounted:function(){this.setInitForm(),this.getInitData(),Object(i["g"])(this,this.getInitData,this.clearTimer),this.$once("hook:beforeDestroy",this.clearTimer)},methods:{getInitData:function(){this.getData(),this.getSkillGroups()},setInitForm:function(){this.tableForm={yccallstate:[],entId:this.$store.state.userData.entid},this.searchForm=Object(c["a"])({},this.tableForm)},clearTimer:function(){clearTimeout(this.tid),this.tid=null},fetchMethod:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$post("/monitor/acdwork/search",e);case 2:return r=n.sent,a=r.data,t.clearTimer(),t.tid=setTimeout(t.getData.bind(t),5e3),n.abrupt("return",a);case 7:case"end":return n.stop()}}),n)})))()},getSkillGroups:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/queue/getAllQueueNoPage?entId=".concat(e.searchForm.entId));case 2:e.selectSkill=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},onStatusChange:function(e){var t=e.code,n=this.searchForm.yccallstate,r=n.indexOf(t);r<0?n.push(t):n.splice(r,1),this.onSearch()},onEntChange:function(){this.searchForm=Object(c["a"])(Object(c["a"])({},this.searchForm),{},{queueId:void 0}),this.onSearch(),this.getSkillGroups()},isStatusActive:function(e){var t=e.code;return this.searchForm.yccallstate.includes(t)},onExport:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.tableData.total>5e4)){t.next=2;break}return t.abrupt("return",e.$message.warning("当前导出数据量超过最大限制(50000条),请重新筛选数据后重试"));case 2:return t.next=4,e.$confirm("您当前导出数据为该筛选条件下的所有数据,请点击确定,继续导出","注意");case 4:n=Object(c["a"])(Object(c["a"])({},e.searchForm),{},{yccallstate:e.searchForm.yccallstate+""}),Object(i["i"])({fileName:"坐席监控数据导出.xls",action:function(){return e.$http("/monitor/acdwork/export",{params:n,responseType:"blob"})}});case 6:case"end":return t.stop()}}),t)})))()},onCheckOut:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("您确定要继续签出吗?","注意");case 2:return n.next=4,t.$post("/monitor/acdwork/checkout",e);case 4:r=n.sent,t.$message.success(r.info),t.getData();case 7:case"end":return n.stop()}}),n)})))()},onDropOut:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("您确定要继续挂断吗?","注意");case 2:return n.next=4,t.$post("/monitor/acdwork/dropout",e);case 4:r=n.sent,t.$message.success(r.info),t.getData();case 7:case"end":return n.stop()}}),n)})))()},onSetBusy:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("您确定要继续置忙吗?","注意");case 2:return n.next=4,t.$post("/monitor/acdwork/setbusy",e);case 4:r=n.sent,t.$message.success(r.info),t.getData();case 7:case"end":return n.stop()}}),n)})))()},onSetIdle:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("您确定要继续置闲吗?","注意");case 2:return n.next=4,t.$post("/monitor/acdwork/setidle",e);case 4:r=n.sent,t.$message.success(r.info),t.getData();case 7:case"end":return n.stop()}}),n)})))()}}},u=s,l=(n("a383"),n("2877")),h=Object(l["a"])(u,r,a,!1,null,"f427d3e0",null);t["default"]=h.exports},a383:function(e,t,n){"use strict";n("02ea")}}]);