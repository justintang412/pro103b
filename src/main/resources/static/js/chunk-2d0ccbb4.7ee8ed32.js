(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ccbb4"],{"4ed1":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[e.isAdmin?n("el-form-item",{attrs:{label:"所属企业"}},[n("ui-ent-select",{on:{change:e.onSearch},model:{value:e.searchForm.entid,callback:function(t){e.$set(e.searchForm,"entid",t)},expression:"searchForm.entid"}})],1):e._e(),n("ui-text-field",{attrs:{label:"账号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}}),n("ui-text-field",{attrs:{label:"用户姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}}),n("ui-text-field",{attrs:{label:"坐席工号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.workNo,callback:function(t){e.$set(e.searchForm,"workNo",t)},expression:"searchForm.workNo"}}),n("ui-text-field",{attrs:{label:"手机号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.phone,callback:function(t){e.$set(e.searchForm,"phone",t)},expression:"searchForm.phone"}}),n("ui-text-field",{attrs:{label:"邮箱"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.email,callback:function(t){e.$set(e.searchForm,"email",t)},expression:"searchForm.email"}}),n("ui-select",{attrs:{label:"角色",options:e.roles,props:{value:"roleId",label:"roleName"},clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.roleId,callback:function(t){e.$set(e.searchForm,"roleId",t)},expression:"searchForm.roleId"}}),n("ui-select",{attrs:{label:"状态",clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.state,callback:function(t){e.$set(e.searchForm,"state",t)},expression:"searchForm.state"}},[n("el-option",{attrs:{label:"启用",value:0}}),n("el-option",{attrs:{label:"禁用",value:1}})],1)]},proxy:!0},{key:"actions",fn:function(){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onEdit()}}},[e._v("添加用户")]),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:e.selectedRow.length<1},on:{click:function(t){return e.onDelete(e.selectedRow)}}},[e._v("删除已选")])]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},a=[],o=n("1da1"),s=n("5530"),i=(n("96cf"),n("d3b7"),n("d81d"),n("3ca3"),n("ddb0"),n("a02a")),l={name:"SystemUser",mixins:[window.mixTableView],data:function(){var e=this;return{columns:[{type:"selection",selectable:function(e){return e.state}},{label:"账号",prop:"username"},{label:"用户姓名",prop:"name"},{label:"坐席工号",prop:"workNo",minWidth:80},{label:"手机",prop:"phone"},{label:"邮箱",prop:"email",minWidth:140},{label:"状态",minWidth:80,render:function(e,t){var n=t.row;return n.state?e("el-tag",{props:{type:"info"}},"禁用"):e("el-tag","启用")}},{label:"操作",width:210,fixed:"right",render:function(t,n){var r=n.row;return e.$hBtns([{label:"设置角色",action:e.onSettingRoles},{label:"修改密码",action:e.onUpdatePwd},{label:"编辑",action:e.onEdit},{label:"删除",action:e.onDelete}])(t,{row:r})}}],roles:[]}},computed:{userData:function(){return this.$store.state.userData},isAdmin:function(){return this.$store.getters.isAdmin}},mounted:function(){this.setInitForm(),this.getInitData(),Object(i["g"])(this,this.getInitData)},methods:{getInitData:function(){this.getData(),this.getRoles()},setInitForm:function(){this.tableForm={entid:this.userData.entid},this.searchForm=Object(s["a"])({},this.tableForm)},fetchMethod:function(e){return this.$http("/ccas/auth/user/list?isShowCurrentUser=0",{params:e}).then((function(e){return e.data}))},onDelete:function(e){var t=this;if(e instanceof Array||(e=[e]),e.some((function(e){return!e.state})))return this.$message.warning("已启用的账号不能删除");this.delData({desc:"确定要删除所选用户？",action:function(){return t.$http("/ccas/auth/user/del",{params:{ids:e.map((function(e){return e.userId}))+""}})}})},onEdit:function(e){this.$openModal((function(){return n.e("chunk-2d0e9d6f").then(n.bind(null,"8ef2"))}),{row:e,entid:this.searchForm.entid},{success:this.onEditSuccess})},onUpdatePwd:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$prompt("请输入新密码","修改密码",{inputPlaceholder:"请输入新密码",inputPattern:i["e"].pattern,inputErrorMessage:i["e"].message});case 2:return r=n.sent,a=r.value,n.next=6,t.$post("/ccas/auth/user/update/password/for/manage",{password:a,userId:e.userId});case 6:t.$message.success("密码修改成功");case 7:case"end":return n.stop()}}),n)})))()},onSettingRoles:function(e){this.$openModal((function(){return n.e("chunk-78f8be6a").then(n.bind(null,"e611"))}),{row:e})},getRoles:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/auth/role/all/list").then((function(e){return e.data}));case 2:e.roles=t.sent;case 3:case"end":return t.stop()}}),t)})))()}}},c=l,u=n("2877"),d=Object(u["a"])(c,r,a,!1,null,null,null);t["default"]=d.exports}}]);