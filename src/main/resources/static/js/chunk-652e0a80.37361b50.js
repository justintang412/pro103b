(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-652e0a80"],{"1af7":function(e,t,n){"use strict";n("e354")},a5de:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[e.isAdmin?n("el-form-item",{attrs:{label:"所属企业"}},[n("ui-ent-select",{on:{change:e.onSearch},model:{value:e.searchForm.entid,callback:function(t){e.$set(e.searchForm,"entid",t)},expression:"searchForm.entid"}})],1):e._e(),n("ui-text-field",{attrs:{label:"留言电话"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.phone,callback:function(t){e.$set(e.searchForm,"phone",t)},expression:"searchForm.phone"}}),n("el-form-item",{attrs:{label:"时间范围"}},[n("ui-date-range-picker",{on:{change:e.onTimeChange},model:{value:e.timerange,callback:function(t){e.timerange=t},expression:"timerange"}})],1)]},proxy:!0},{key:"actions",fn:function(){return[n("el-button",{attrs:{icon:"el-icon-upload2",type:"primary"},on:{click:e.onExport}},[e._v("导出")])]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},i=[],r=n("3835"),o=n("5530"),s=n("2909"),c=(n("99af"),n("d81d"),n("d3b7"),n("a02a")),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"box"})},u=[],d={props:["src"],watch:{src:{immediate:!0,handler:function(e){var t=this,n=new Audio(e);n.controls=!0,n.play().catch((function(e){t.$message.error({duration:3,content:"<b>播放失败：</b>".concat(e.message)})})),this.$nextTick((function(){var e=t.$el.querySelector("audio");e&&t.$el.removeChild(e),t.$el.appendChild(n)}))}}}},m=d,p=(n("1af7"),n("2877")),h=Object(p["a"])(m,l,u,!1,null,"585b30da",null),f=h.exports,b={name:"BaseMessageLeaveMessage",mixins:[window.mixTableView],data:function(){var e=this;return{timerange:[],columns:[{label:"留言客户电话",prop:"phone",minWidth:120},{label:"留言时间",prop:"createTime",minWidth:140},{label:"听取状态",render:function(e,t){var n=t.row;return e.apply(void 0,["el-tag"].concat(Object(s["a"])(n.status?[{props:{type:"success"}},"已听取"]:[{props:{type:"primary"}},"未听取"])))}},{label:"备注",prop:"remark",minWidth:140},{label:"通知内容",prop:"content",minWidth:140},{label:"操作",width:120,fixed:"right",render:function(t,n){var a=n.row,i=n.$index;return t("div",{style:"display:flex;align-items:center"},[e.$hBtns({label:"听取",action:e.onPlay})(t,{row:a}),t("el-dropdown",{style:"margin-left:10px",props:{trigger:"click",size:"mini"},on:{command:function(t){e.handleCommand(t,i)}}},[t("el-button",{props:{type:"text"}},[t("span","备注"),t("i",{class:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{slot:"dropdown"},["无效录音","已提交工单","无人接听"].map((function(e){return t("el-dropdown-item",{key:e,props:{command:{id:a.id,remark:e}}},e)})))])])}}]}},computed:{isAdmin:function(){return this.$store.getters.isAdmin}},mounted:function(){this.setInitForm(),this.getData(),Object(c["g"])(this,this.getData)},methods:{setInitForm:function(){this.timerange=[],this.tableForm={entid:this.$store.state.userData.entid},this.searchForm=Object(o["a"])({},this.tableForm)},handleCommand:function(e,t){var n=this;this.$post("/base/leave/message/remark",e).then((function(){n.$set(n.tableData.data[t],"remark",e.remark)}))},fetchMethod:function(e){return this.$http("/base/leave/message/list",{params:e}).then((function(e){return e.data}))},onTimeChange:function(e){var t=e||[],n=Object(r["a"])(t,2),a=n[0],i=n[1];this.searchForm.beginTime=a&&new Date(a)-0,this.searchForm.endTime=i&&new Date(i)-0,this.onSearch()},onExport:function(){var e=this;Object(c["i"])({fileName:"留言管理数据导出.xls",action:function(){return e.$http("base/leave/message/export",{params:e.searchForm,responseType:"blob"})}})},onPlay:function(e){var t=this;this.audioLoading||(this.audioLoading=!0,this.$http("/base/leave/message/record/path/".concat(e.id)).then((function(n){var a=n.data;e.status=1;var i=t.$createElement;t.$alert(i(f,{props:{src:a}}))})).finally((function(){t.audioLoading=!1})))}}},g=b,v=Object(p["a"])(g,a,i,!1,null,null,null);t["default"]=v.exports},e354:function(e,t,n){}}]);