(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2531775d"],{"09ba":function(e,t,i){"use strict";i("c578")},"1dbdf":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ui-modal",e._g(e._b({},"ui-modal",e.modalProps,!1),e.$listeners),[i("com-custom-form",{attrs:{action:e.getFieldList,optionsAction:e.getOptionList}})],1)},r=[],a=i("1da1"),o=(i("96cf"),i("e6f4")),l=i("927c"),c={components:{ComCustomForm:l["a"]},props:["row"],data:function(){return{modalProps:{title:"预览",hideOK:!0,drawer:!0,width:"390px"}}},methods:{getFieldList:function(){return Object(o["f"])(this.row.templateUid)},getOptionList:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$http("/media/field/getOptionList?fieldUid=".concat(e));case 2:return i.abrupt("return",i.sent.data);case 3:case"end":return i.stop()}}),i)})))()}}},s=c,d=i("2877"),f=Object(d["a"])(s,n,r,!1,null,null,null);t["default"]=f.exports},"927c":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"Form",attrs:{"label-position":"top",model:e.form}},e._l(e.fieldList,(function(t){return i("el-form-item",{key:t.fieldUid,attrs:{label:t.fieldTitle,prop:t.fieldUid,rules:e.createRules(t)}},[+t.fieldType===e.T.INPUT?i("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}}):+t.fieldType===e.T.TEXTAREA?i("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入内容"},model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}}):+t.fieldType===e.T.SELECT?i("el-select",{attrs:{clearable:!+t.isNecessary},model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}},e._l(e.dataMap[t.fieldUid],(function(e){return i("el-option",{key:e.optionsUid,attrs:{value:e.optionsUid,label:e.optionsName}})})),1):+t.fieldType===e.T.CASCADER?i("el-cascader",{attrs:{clearable:!+t.isNecessary,options:e.dataMap["tree_"+t.fieldUid],props:{value:"optionsUid",label:"optionsName"}},model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}}):+t.fieldType===e.T.RADIO?i("el-radio-group",{model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}},e._l(e.dataMap[t.fieldUid],(function(t){return i("el-radio",{key:t.optionsUid,attrs:{label:t.optionsUid}},[e._v(e._s(t.optionsName))])})),1):+t.fieldType===e.T.CHECKBOX?i("el-checkbox-group",{model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}},e._l(e.dataMap[t.fieldUid],(function(t){return i("el-checkbox",{key:t.optionsUid,attrs:{label:t.optionsUid}},[e._v(e._s(t.optionsName))])})),1):+t.fieldType===e.T.DATE?i("el-date-picker",{model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}}):+t.fieldType===e.T.UPLOAD?i("com-upload",{attrs:{action:e.uploadAction,jsonParam:t.fieldInfo},model:{value:e.form[t.fieldUid],callback:function(i){e.$set(e.form,t.fieldUid,i)},expression:"form[_.fieldUid]"}}):e._e()],1)})),1)},r=[],a=i("ade3"),o=i("5530"),l=i("1da1"),c=(i("96cf"),i("4de4"),i("d3b7"),i("159b"),i("7db0"),i("d81d"),i("a02a")),s=i("e6f4"),d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("input",{directives:[{name:"show",rawName:"v-show",value:0,expression:"0"}],ref:"File",attrs:{type:"file",accept:e.accept},on:{change:e.onChange}}),i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.onSelect}},[e._v("选择文件")]),i("p",{staticClass:"tip"},[e._v("* 文件大小不能超过"+e._s(+e.options.limit)+"M")]),e.file?i("div",{staticClass:"file-wrap"},[e.isImg()?i("img",{attrs:{src:e.blobUrl}}):e.isVideo()?i("video",{attrs:{src:e.blobUrl,controls:""}}):i("p",{staticClass:"filename"},[e._v(e._s(e.file.name))])]):e._e()],1)},f=[],u=(i("caad"),i("2532"),i("ac1f"),i("1276"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("2ca0"),{props:{value:{},jsonParam:{},action:Function},data:function(){return{file:null,blobUrl:null,model:this.value}},computed:{options:function(){try{return JSON.parse(this.jsonParam)||{}}catch(e){return{}}},accept:function(){var e,t=this.options.accept||[],i=(e={},Object(a["a"])(e,s["c"].IMAGE,"image/*"),Object(a["a"])(e,s["c"].VIDEO,"video/*"),e);return t.includes(s["c"].ALL)?"":t.map((function(e){return i[e]}))+""}},watch:{value:function(e){this.model=e},model:function(e){this.$emit("input",e)}},methods:{onSelect:function(){this.action?this.$refs.File.click():Object(c["C"])("预览模式不允许上传")},onChange:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function i(){var n,r,a,o,l,s,d,f;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e.target,r=n.files[0],n.value="",!r){i.next=21;break}if(a=r.type.split("/")[0],o=+t.options.limit,l=1024*o*1024,!(r.size>l)){i.next=9;break}return i.abrupt("return",Object(c["C"])("文件大小不能超过".concat(o,"M")));case 9:if(s=t.accept,!s){i.next=13;break}if(!(s.indexOf(a)<0)){i.next=13;break}return i.abrupt("return",Object(c["C"])("该文件类型不支持"));case 13:return t.file=r,t.blobUrl=window.URL.createObjectURL(r),setTimeout((function(){window.URL.revokeObjectURL(t.blobUrl)}),500),i.next=18,t.action(r);case 18:d=i.sent,f=d.data,t.model={fileType:a,name:f.fileUrl};case 21:case"end":return i.stop()}}),i)})))()},isImg:function(){return this.file.type.startsWith("image/")},isVideo:function(){return this.file.type.startsWith("video/")}}}),p=u,m=(i("09ba"),i("2877")),b=Object(m["a"])(p,d,f,!1,null,"e29f960c",null),U=b.exports,h={components:{ComUpload:U},props:["action","optionsAction","uploadAction"],data:function(){return{T:s["b"],fieldList:[],form:{},dataMap:{}}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.action();case 2:i=t.sent.filter((function(e){return+e.fieldStatus})),i.forEach(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(i){var n,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!Object(s["i"])(i.fieldType)){t.next=6;break}return Object(s["j"])(i)&&(e.form=Object(o["a"])(Object(o["a"])({},e.form),{},Object(a["a"])({},i.fieldUid,[]))),t.next=4,e.optionsAction(i.fieldUid);case 4:n=t.sent,+i.fieldType===s["b"].CASCADER?(l="tree_".concat(i.fieldUid),e.dataMap=Object(o["a"])(Object(o["a"])({},e.dataMap),{},(r={},Object(a["a"])(r,i.fieldUid,n),Object(a["a"])(r,l,Object(c["F"])(n,{key:"optionsUid"})),r))):e.dataMap=Object(o["a"])(Object(o["a"])({},e.dataMap),{},Object(a["a"])({},i.fieldUid,n));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.fieldList=i;case 5:case"end":return t.stop()}}),t)})))()},getForm:function(){var e=this,t={},i=this.dataMap,n=function(n){var r=e.form[n],a=i[n],l=e.fieldList.find((function(e){return e.fieldUid===n}))||{};l={title:l.fieldTitle,type:l.fieldType};var c=function(e){return(a.find((function(t){return t.optionsUid===e}))||{}).optionsName};a?Array.isArray(r)?t[n]={field:l,id:r,name:r.map(c)}:t[n]={field:l,id:r,name:c(r)}:+l.type===s["b"].UPLOAD?t[n]=Object(o["a"])({field:l},r):t[n]={field:l,name:r}};for(var r in this.form)n(r);return t},validate:function(){return this.$refs.Form.validate()},createRules:function(e){return+e.isNecessary?{required:!0,message:"该字段不能为空",trigger:Object(s["k"])(e.fieldType)?null:"blur"}:null}}},v=h,O=Object(m["a"])(v,n,r,!1,null,null,null);t["a"]=O.exports},c578:function(e,t,i){}}]);