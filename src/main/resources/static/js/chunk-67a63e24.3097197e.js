(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67a63e24"],{"071d":function(t,e,n){"use strict";n("e092")},"498a":function(t,e,n){"use strict";var i=n("23e7"),r=n("58a8").trim,a=n("c8d2");i({target:"String",proto:!0,forced:a("trim")},{trim:function(){return r(this)}})},"8ac3":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("com-skill-group",t._b({on:{"current-change":t.onCurrentChange}},"com-skill-group",t.viewProps,!1),[t.curSkill?n("ui-table-view",{attrs:{loading:t.loading,columns:t.columns,data:t.tableData,hidePager:""}},[n("div",{staticClass:"actions",attrs:{slot:"actions"},slot:"actions"},[n("span",[t._v("组成员列表")]),n("span",[n("el-link",{staticStyle:{margin:"0 10px"},attrs:{underline:!1,type:"primary",icon:"el-icon-finished"},on:{click:function(e){return t.onSetLimit()}}},[t._v("设置技能组接待上限")]),n("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(e){return t.onAddMember()}}},[t._v("添加组成员")])],1)])]):t._e()],1)},r=[],a=n("5530"),s=n("2909"),c=(n("99af"),n("d3b7"),n("3ca3"),n("ddb0"),n("b0c0"),n("ac1f"),n("00b4"),n("4328")),o=n.n(c),u=n("c5ee"),l={name:"SettingsWorkorderSkillGroup",components:{ComSkillGroup:u["a"]},data:function(){var t=this;return{tableData:[],curSkill:null,loading:!1,columns:[{label:"客服姓名",prop:"name"},{label:"账号状态",minWidth:80,render:function(t,e){var n=e.row;return t.apply(void 0,["el-tag"].concat(Object(s["a"])(n.status?[{props:{type:"info"}},"禁用"]:["启用"])))}},{label:"邮箱",prop:"email",minWidth:140},{label:"接待上限",prop:"maxusers",minWidth:80},{label:"最近登录时间",minWidth:140,render:function(e,n){var i=n.row;return e("span",t.$adminCore.formatDate(i.loginTime))}},{label:"操作",width:140,fixed:"right",render:this.$hBtns([{label:"设置接待上限",action:this.onSetLimit},{label:"移除",action:this.onDelMember}])}]}},computed:{imUser:function(){return this.$store.getters.imUser},viewProps:function(){var t=this,e=this.imUser.orgi;return{onGetList:function(){return t.$imHttp("/skill/list",{params:{orgi:e}})},onAdd:function(n){return t.$imHttp.post("/skill/",Object(a["a"])(Object(a["a"])({},n),{},{orgi:e})).then((function(t){return t.data}))},onEdit:function(n){return t.$imHttp.post("/skill/".concat(n.id),Object(a["a"])(Object(a["a"])({},n),{},{orgi:e}))},onDelete:function(e){return t.$imHttp("/skill/".concat(e))}}}},methods:{onCurrentChange:function(t){this.curSkill=t,t&&this.getUsers()},getUsers:function(){var t=this;this.loading=!0,this.tableData=[],this.$imHttp("/skill/custList",{params:{skillId:this.curSkill.id,orgi:this.imUser.orgi}}).then((function(e){var n=e.data;t.tableData=n})).finally((function(){t.loading=!1}))},onAddMember:function(){this.$openModal((function(){return n.e("chunk-2d0c51c9").then(n.bind(null,"3e67"))}),{row:{orgi:this.imUser.orgi,skillId:this.curSkill.id,skillName:this.curSkill.name}},{success:this.getUsers})},onDelMember:function(t){var e=this;this.$confirm("是否要从技能组中移除客服 ".concat(t.name," ？"),"移除提示").then((function(){e.$imHttp("/skill/custRemove",{params:{customerIds:t.id}}).then((function(){e.getUsers()}))}))},onSetLimit:function(t){var e=this,n=t?"客服 <b>".concat(t.name,"</b> "):"技能组";this.$prompt("设置".concat(n,"上限接待人数(0-100)"),"设置接待上限",{dangerouslyUseHTMLString:!0,inputPlaceholder:"请输入0-100之间的数值",inputValue:"",inputValidator:function(t){return!!(/^\d+$/.test(t)&&t>=0&&t<=100)||"请输入0-100之间的数值"}}).then((function(n){var i=n.value,r=o.a.stringify(Object(a["a"])({orgi:e.imUser.orgi,maxusers:+i},t?{customerId:t.id,skillId:""}:{customerId:"",skillId:e.curSkill.id}));e.$imHttp.post("/customer/maxusers",r).then((function(){e.getUsers(),e.$message.success("操作成功")}))}))}}},d=l,p=(n("071d"),n("2877")),m=Object(p["a"])(d,i,r,!1,null,"46c3196e",null);e["default"]=m.exports},9377:function(t,e,n){"use strict";n("e0c3")},c5ee:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui-absolute-container",class:t.prefix},[n("aside",{class:t.prefix+"_aside"},[n("header",{class:t.prefix+"_header"},[n("el-link",{attrs:{icon:"el-icon-plus",underline:!1,type:"primary"},on:{click:function(e){return t.edit()}}},[t._v("添加技能组")])],1),n("main",{class:t.prefix+"_main"},[n("el-scrollbar",{staticClass:"ui-scrollbar"},[n("ul",t._l(t.groupList,(function(e){return n("li",{key:e.id,class:[t.prefix+"_item",{active:t.current&&t.current.id===e.id}],on:{click:function(n){return t.changeCurrent(e)}}},[n("span",{class:t.prefix+"_item-name"},[t._v(t._s(e.name))]),n("span",{class:t.prefix+"_item-actions"},[n("i",{staticClass:"el-icon-edit",attrs:{title:"编辑"},on:{click:function(n){return n.stopPropagation(),t.edit(e)}}}),n("i",{staticClass:"el-icon-delete",attrs:{title:"删除"},on:{click:function(n){return n.stopPropagation(),t.del(e)}}})])])})),0)])],1)]),n("div",{class:t.prefix+"_member"},[t.current?n("header",{class:t.prefix+"_header"},[n("span",[t._v(t._s(t.current.name))])]):t._e(),n("main",{class:t.prefix+"_main"},[t.current?t._e():n("p",{class:t.prefix+"_tip"},[t._v("请添加技能组")]),t._t("default")],2)])])},r=[],a=n("1da1"),s=(n("b0c0"),n("a434"),n("498a"),n("96cf"),{name:"ComSkillGroup",props:{onAdd:Function,onEdit:{type:Function,required:!0},onDelete:{type:Function,required:!0},onGetList:{type:Function,required:!0}},data:function(){return{groupList:[],current:null,prefix:"com-skill-group"}},mounted:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.onGetList();case 2:n=e.sent,i=n.data,t.groupList=i,t.changeCurrent(i[0]);case 6:case"end":return e.stop()}}),e)})))()},methods:{del:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$confirm("是否要删除技能组“".concat(t.name,"”?"),"删除");case 2:return n.next=4,e.onDelete(t.id);case 4:i=e.groupList.indexOf(t),e.groupList.splice(i,1),e.current&&e.current.id===t.id&&e.changeCurrent(e.groupList[0]);case 7:case"end":return n.stop()}}),n)})))()},edit:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,r,a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$prompt("技能组名称","".concat(t?"编辑":"添加","技能组"),{inputValue:t&&t.name,inputPlaceholder:"最大上限20个字",inputValidator:function(t){return t=t.trim(),t?!(t.length>20)||"技能组名称不能超过20个字符":"请输入技能组名称"}});case 2:if(i=n.sent,r=i.value,a=(r||"").trim(),!t){n.next=11;break}return n.next=8,e.onEdit({id:t.id,name:a});case 8:t.name=a,n.next=15;break;case 11:return n.next=13,(e.onAdd||e.onEdit)({name:a});case 13:s=n.sent,e.groupList.push({id:s,name:a});case 15:case"end":return n.stop()}}),n)})))()},changeCurrent:function(t){this.current=t,this.$emit("current-change",t)}}}),c=s,o=(n("9377"),n("2877")),u=Object(o["a"])(c,i,r,!1,null,null,null);e["a"]=u.exports},c8d2:function(t,e,n){var i=n("5e77").PROPER,r=n("d039"),a=n("5899"),s="​᠎";t.exports=function(t){return r((function(){return!!a[t]()||s[t]()!==s||i&&a[t].name!==t}))}},e092:function(t,e,n){},e0c3:function(t,e,n){}}]);