(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5934da30"],{"55b6":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-modal",e._g(e._b({},"ui-modal",e.modalProps,!1),e.$listeners),[n("el-form",{ref:"Form",attrs:{model:e.form,rules:e.rules,"label-width":"110px"}},[n("ui-text-field",{attrs:{type:"text",label:"通知标题",prop:"title"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}),n("ui-text-field",{attrs:{type:"textarea",label:"通知内容",prop:"content",rows:5,autosize:{maxRows:5,minRows:5}},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}),n("ui-select",{attrs:{label:"队列类型",placeholder:"请选择被通知人队列"},on:{change:e.changeType},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("el-option",{attrs:{value:0,label:"工单技能组"}}),n("el-option",{attrs:{value:1,label:"会话技能组"}}),n("el-option",{attrs:{value:2,label:"呼叫技能组"}})],1),n("ui-select",{attrs:{label:"通知队列",prop:"queueId",options:e.queueAllList,props:{value:"queueId",label:"queueName"},placeholder:"请选择被通知人队列"},on:{change:e.queueChange},model:{value:e.form.queueId,callback:function(t){e.$set(e.form,"queueId",t)},expression:"form.queueId"}}),n("ui-select",{attrs:{label:"被通知人",options:e.agents,props:{value:"receiverId",label:"receiverName"},placeholder:"被通知人(不选，默认当前通知队列下所有人)",multiple:""},on:{change:e.onReceiverChange},model:{value:e.form.receiver,callback:function(t){e.$set(e.form,"receiver",t)},expression:"form.receiver"}}),n("el-form-item",{attrs:{label:"通知时间",prop:"notify_end_date"}},[n("ui-date-range-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","picker-options":{disabledDate:!1,shortcuts:!1}},on:{change:e.onDateRangeChange},model:{value:e.daterange,callback:function(t){e.daterange=t},expression:"daterange"}})],1)],1)],1)},r=[],i=n("3835"),o=n("5530"),u=n("1da1"),s=(n("96cf"),n("e9c4"),n("d81d"),n("b0c0"),n("4de4"),n("d3b7"),n("a02a")),l={props:["entId"],data:function(){var e=this;return{form:{},type:"",queueAllList:[],agents:[],daterange:null,rules:{content:Object(s["y"])("请输入通知标题"),title:Object(s["y"])("请输入通知内容"),queueId:Object(s["z"])("请选择被通知人队列"),notify_end_date:Object(s["z"])("请选择通知时间")},modalProps:{width:"500px",title:"添加通知",okText:"发布",onSubmit:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:return n=e.form.receiverInfoJson,t.next=5,e.$post("/base/notice/send/notice",Object(o["a"])(Object(o["a"])({},e.form),{},{receiverInfoJson:n&&"[]"!==n?n:JSON.stringify(e.agents),entId:e.entId}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()}}},methods:{changeType:function(e){var t=this;this.$set(this.form,"queueId",null),0===e?this.$http("/orderGroup/listGroup").then((function(e){var n=e.data;t.queueAllList=n.map((function(e){return{queueId:e.id,queueName:e.name}}))})):1===e?this.$imHttp("/skill/list?orgi=".concat(this.entId)).then((function(e){var n=e.data;t.queueAllList=n.map((function(e){return{queueId:e.id,queueName:e.name}}))})):this.$http("/queue/getAllQueueNoPage?entId=".concat(this.entId)).then((function(e){var n=e.data;t.queueAllList=n}))},queueChange:function(e){var t=this;this.$set(this.form,"receiver",null),0===this.type?this.$post("/orderGroup/listByGroup",{groupId:e}).then((function(e){var n=e.data;t.agents=n.map((function(e){return{receiverId:e.userId,receiverName:e.name}}))})):1===this.type?this.$imHttp("/skill/custList",{params:{orgi:this.entId,skillId:e}}).then((function(e){var n=e.data;t.agents=n.map((function(e){return{receiverId:e.userid,receiverName:e.name}}))})):this.$http("/cti/work/getWorkByQueueid",{params:{entId:this.entId,queueId:e}}).then((function(e){var n=e.data;t.agents=n.map((function(e){return{receiverId:e.user_id,receiverName:e.name}}))}))},onReceiverChange:function(e){this.form.receiverInfoJson=JSON.stringify(this.agents.filter((function(t){return e.indexOf(t.receiverId)>-1})))},onDateRangeChange:function(e){var t=e||[],n=Object(i["a"])(t,2),a=n[0],r=n[1];this.form=Object(o["a"])(Object(o["a"])({},this.form),{},{notify_begin_date:a&&new Date(a).getTime(),notify_end_date:r&&new Date(r).getTime()})}}},c=l,d=(n("a0aa"),n("2877")),p=Object(d["a"])(c,a,r,!1,null,"089db8ca",null);t["default"]=p.exports},a0aa:function(e,t,n){"use strict";n("adcb")},adcb:function(e,t,n){}}]);