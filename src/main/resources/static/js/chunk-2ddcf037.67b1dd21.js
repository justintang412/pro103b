(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ddcf037"],{"89d2":function(e,t,n){e.exports={pointer:"style-module_pointer_18vYX",flexCenter:"style-module_flexCenter_qMqRZ",flex1:"style-module_flex1_TeLzv"}},fcb5:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[n("ui-text-field",{attrs:{label:"批次名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.eventName,callback:function(t){e.$set(e.searchForm,"eventName",t)},expression:"searchForm.eventName"}}),n("ui-select",{attrs:{label:"批次状态",clearable:"",multiple:"","collapse-tags":""},on:{change:e.onStatusChange},model:{value:e.eventStatus,callback:function(t){e.eventStatus=t},expression:"eventStatus"}},e._l(e.predictionBatchStatus,(function(e,t){return n("el-option",{key:t,attrs:{value:+t,label:e.text}})})),1),n("el-form-item",{attrs:{label:"创建时间"}},[n("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.onTimerangeChange},model:{value:e.timerange,callback:function(t){e.timerange=t},expression:"timerange"}})],1)]},proxy:!0},{key:"actions",fn:function(){return[n("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onEdit()}}},[e._v("添加批次")]),n("el-button-group",[n("el-button",{attrs:{disabled:!e.selectedRow.length,type:"primary",icon:"el-icon-video-play"},on:{click:function(t){return e.updateState(1)}}},[e._v("启用")]),n("el-button",{attrs:{disabled:!e.selectedRow.length,type:"primary",icon:"el-icon-video-pause"},on:{click:function(t){return e.updateState(0)}}},[e._v("暂停")]),n("el-button",{attrs:{disabled:!e.selectedRow.length,type:"primary",icon:"el-icon-circle-close"},on:{click:function(t){return e.updateState(4)}}},[e._v("停止")])],1)]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},r=[],i=n("2909"),o=n("1da1"),c=n("5530"),s=n("3835"),l=(n("96cf"),n("caad"),n("2532"),n("d3b7"),n("3ca3"),n("ddb0"),n("99af"),n("d81d"),n("a02a")),u=n("89d2"),d=n.n(u),p=n("5cdf"),h=function(e){return[-1,p["e"].PAUSED].includes(e.eventState)},m={name:"OcmPredictionBatch",mixins:[window.mixTableView],data:function(){var e=this;return{predictionBatchStatus:p["i"],scenes:[],eventStatus:[],columns:[{type:"selection"},{label:"批次ID",prop:"eventId",minWidth:70},{label:"批次名称",prop:"eventName"},{label:"执行进度",minWidth:140,render:function(t,n){var a=n.row;return t("div",{class:d.a.flexCenter},[t("el-progress",{class:d.a.flex1,props:{showText:!1,strokeWidth:6,percentage:e.getPercent(a)}}),t("span",(a.calledNumber||0)+"/"+(a.listNumber||0))])}},{label:"当前状态",render:function(e,t){var n=t.row,a=n.eventState;-1===a?a=p["e"].PAUSED:2===a&&(a=p["e"].EXECUTING);var r=p["i"][a];return r?e("el-tag",{props:{type:r.type}},r.text):e("div")}},{label:"最大并发",prop:"maxLine",minWidth:80},{label:"开始时间",prop:"sendTime",minWidth:140},{label:"结束时间",prop:"overTime",minWidth:140},{label:"创建时间",prop:"createTime",minWidth:140},{label:"批次策略",width:100,fixed:"right",render:function(t,n){var a=n.row;return e.$hBtns([{label:"工作日",action:e.onWorkdayStrategy,props:{disabled:!h(a)}},{label:"重呼",action:e.onReCall}])(t,{row:a})}},{label:"操作",width:120,fixed:"right",render:function(t,n){var a=n.row,r=h(a);return e.$hBtns([{label:"详情",action:e.onView},{label:"编辑",action:e.onEdit,props:{disabled:!r}},{label:"导入",action:e.onImport,props:{disabled:!r}}])(t,{row:a})}}],timerange:[]}},mounted:function(){this.getInitData(),Object(l["g"])(this,this.getInitData)},methods:{setInitForm:function(){this.timerange=[],this.eventStatus=[],this.tableForm={},this.searchForm={}},getInitData:function(){this.getData(),this.getScenes()},onReCall:function(e){this.$openModal((function(){return n.e("chunk-2d0df0bf").then(n.bind(null,"87f0"))}),{row:e},{success:this.onEditSuccess})},onWorkdayStrategy:function(e){this.$openModal((function(){return n.e("chunk-58e4c8c9").then(n.bind(null,"dfb4"))}),{row:e})},onTimerangeChange:function(e){var t=e||[],n=Object(s["a"])(t,2),a=n[0],r=n[1];this.searchForm=Object(c["a"])(Object(c["a"])({},this.searchForm),{},{sendTime:a,overTime:r}),this.onSearch()},fetchMethod:function(e){return this.$http("/ocm/event/list",{params:e}).then((function(e){var t=e.data;return t}))},getScenes:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/call/manual/event/scene/list");case 2:e.scenes=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},onView:function(e){this.$router.push("".concat(this.$route.path,"/").concat(e.eventId))},onEdit:function(e){var t={row:e,userData:this.$store.state.userData};this.$openModal((function(){return n.e("chunk-2d0c7b01").then(n.bind(null,"524b"))}),t,{success:this.onEditSuccess})},onImport:function(e){this.$openModal((function(){return n.e("chunk-2d0b5f36").then(n.bind(null,"1aa1"))}),{row:e},{success:this.onEditSuccess})},getPercent:function(e){return e.listNumber?e.calledNumber/e.listNumber*100:0},onStatusChange:function(e){var t=Object(i["a"])(e);t.includes(p["e"].PAUSED)&&t.push(-1),t.includes(p["e"].EXECUTING)&&t.push(2),this.searchForm=Object(c["a"])(Object(c["a"])({},this.searchForm),{},{eventState:t+""}),this.onSearch()},updateState:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=p["i"][e],n.next=3,t.$confirm("确定要".concat(a.text,"所选批次？"),"提示");case 3:return n.next=5,t.$post("/ocm/event/updateEventState",{eventState:e,eventIds:t.selectedRow.map((function(e){return e.eventId}))+""});case 5:r=n.sent,i=r.data,t.$message(i),t.getData();case 9:case"end":return n.stop()}}),n)})))()}}},f=m,b=n("2877"),v=Object(b["a"])(f,a,r,!1,null,null,null);t["default"]=v.exports}}]);