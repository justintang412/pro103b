(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21a9a1"],{bbe0:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[n("el-form-item",{attrs:{label:"创建时间"}},[n("el-date-picker",e._b({on:{change:e.onCreateTimeChange},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}},"el-date-picker",e.datePickerProps,!1))],1),n("el-form-item",{attrs:{label:"更新时间"}},[n("el-date-picker",e._b({on:{change:e.onModifyTimeChange},model:{value:e.modifyTime,callback:function(t){e.modifyTime=t},expression:"modifyTime"}},"el-date-picker",e.datePickerProps,!1))],1),n("ui-select",{attrs:{label:"客户等级",options:e.levels,clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.customerLevel,callback:function(t){e.$set(e.searchForm,"customerLevel",t)},expression:"searchForm.customerLevel"}}),n("ui-select",{attrs:{label:"VIP级别",options:e.vipLevels,props:{label:"value",value:"optionId"},clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.vipLevelId,callback:function(t){e.$set(e.searchForm,"vipLevelId",t)},expression:"searchForm.vipLevelId"}}),n("ui-select",{attrs:{label:"客户标签",options:e.tags,props:{label:"value",value:"optionId"},"collapse-tags":"",clearable:"",multiple:""},on:{change:e.onTagChange},model:{value:e.customerTag,callback:function(t){e.customerTag=t},expression:"customerTag"}}),n("ui-text-field",{attrs:{placeholder:"请输入搜索内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm[e.searchForm.key],callback:function(t){e.$set(e.searchForm,e.searchForm.key,t)},expression:"searchForm[searchForm.key]"}},[n("el-select",{staticStyle:{width:"9em"},attrs:{slot:"prepend"},on:{change:e.onKeyChange},slot:"prepend",model:{value:e.searchForm.key,callback:function(t){e.$set(e.searchForm,"key",t)},expression:"searchForm.key"}},e._l(e.options,(function(e){return n("el-option",{key:e[0],attrs:{value:e[0],label:e[1]}})})),1)],1)]},proxy:!0},{key:"actions",fn:function(){return[n("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.onEdit()}}},[e._v("新增客户")]),n("el-button",{attrs:{icon:"el-icon-delete",type:"danger",disabled:!e.selectedRow.length},on:{click:function(t){return e.onDelete(e.selectedRow)}}},[e._v("删除已选")]),n("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:e.onBatchExport}},[e._v("批量导入")]),n("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.onExport}},[e._v("导出")])]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners))},o=[],r=n("3835"),c=n("1da1"),i=n("5530"),s=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("d81d"),n("a02a")),l=n("de0b"),u={name:"CustomerCenterCustomerList",mixins:[window.mixTableView],data:function(){var e=this;return{tags:[],levels:{1:"普通客户",2:"VIP客户"},vipLevels:[],customerTag:[],createTime:[],modifyTime:[],options:[["customerNickname","客户昵称"],["customerName","真实姓名"],["companyName","公司"],["phone","电话"],["email","邮箱"]],datePickerProps:{style:"width:215px;",type:"daterange",pickerOptions:{disabledDate:function(e){return e>Date.now()}}},columns:[{type:"selection"},{label:"客户昵称",prop:"customerNickname"},{label:"真实姓名",prop:"customerName"},{label:"客户标签",prop:"customerTagValue",minWidth:120},{label:"公司",prop:"companyName",minWidth:120},{label:"客户等级",render:function(t,n){var a=n.row;return t("span",e.levels[a.customerLevel])}},{label:"VIP等级",prop:"vipLevelValue",minWidth:80},{label:"邮箱",prop:"email",minWidth:140},{label:"创建时间",prop:"createTime",minWidth:140},{label:"更新时间",prop:"modifyTime",minWidth:140},{label:"操作",width:100,fixed:"right",render:this.$hBtns([{label:"详情",action:this.onView},{label:"删除",action:this.onDelete}])}]}},mounted:function(){var e=this;this.setInitForm();var t=function(){e.getData(),e.getTags(),e.getVipLevels()};t(),Object(s["g"])(this,t)},methods:{setInitForm:function(){this.createTime=[],this.modifyTime=[],this.tableForm={key:"customerNickname"},this.searchForm=Object(i["a"])({},this.tableForm)},onBatchExport:function(){this.$openModal((function(){return n.e("chunk-2d0e20f3").then(n.bind(null,"7ca2"))}),{},{success:this.onEditSuccess})},onExport:function(){var e=this;Object(s["i"])({fileName:"客户信息表.xls",action:function(){return e.$http("/ccas/cc/customer/export",{params:e.searchForm,responseType:"blob"})}})},fetchMethod:function(e){return this.$http("/ccas/cc/customer/list?isBlackList=0",{params:e}).then((function(e){return e.data}))},getVipLevels:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/cc/customer/vip/level/list");case 2:e.vipLevels=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},getTags:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/cc/customer/customer/tag/list");case 2:e.tags=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},onEdit:function(){this.$openModal((function(){return Promise.all([n.e("chunk-4e8d5934"),n.e("chunk-6390fd29")]).then(n.bind(null,"922a"))}),{},{success:this.onEditSuccess})},onCreateTimeChange:function(e){var t=e||[],n=Object(r["a"])(t,2),a=n[0],o=n[1];o&&o.setHours(23,59,59),this.searchForm=Object(i["a"])(Object(i["a"])({},this.searchForm),{},{createBeginTime:a&&+a,createEndTime:o&&+o}),this.onSearch()},onModifyTimeChange:function(e){var t=e||[],n=Object(r["a"])(t,2),a=n[0],o=n[1];o&&o.setHours(23,59,59),this.searchForm=Object(i["a"])(Object(i["a"])({},this.searchForm),{},{modifyBeginTime:a&&+a,modifyEndTime:o&&+o}),this.onSearch()},onKeyChange:function(){var e=this;this.options.forEach((function(t){e.$set(e.searchForm,t[0],void 0)}))},onTagChange:function(e){this.$set(this.searchForm,"customerTag",e+""),this.onSearch()},onView:function(e){this.$router.push({name:"".concat(l["d"],"-detail"),params:{id:e.customerId}})},onDelete:function(e){var t=this;this.delData({rows:e,desc:"确定要删除所选客户？",action:function(e){return t.$http("/ccas/cc/customer/del",{params:{customerIds:e.map((function(e){return e.customerId}))+""}})}})}}},m=u,h=n("2877"),p=Object(h["a"])(m,a,o,!1,null,null,null);t["default"]=p.exports}}]);