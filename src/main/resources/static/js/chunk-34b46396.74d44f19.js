(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34b46396"],{"3a23":function(t,e,n){"use strict";n("f7b7")},9980:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-table-view",t._b({on:{change:t.getData,reset:t.onReset,search:t.serchBefore,"row-click":t.onclick},scopedSlots:t._u([{key:"search",fn:function(){return[n("el-form-item",{attrs:{label:"会话开始时间"}},[n("ui-date-range-picker",{attrs:{clearable:!1},on:{change:t.serchBefore},model:{value:t.timerange,callback:function(e){t.timerange=e},expression:"timerange"}})],1)]},proxy:!0},{key:"search-right",fn:function(){return[n("el-select",{staticStyle:{width:"160px","margin-right":"10px"},attrs:{clearable:"",filterable:"",placeholder:"常用质检方案选择"},model:{value:t.searchForm.programId,callback:function(e){t.$set(t.searchForm,"programId",e)},expression:"searchForm.programId"}},t._l(t.options,(function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.companyId}})})),1),n("com-filter",{ref:"ComFilter",attrs:{"online-skills":t.onlineSkills},on:{show:t.onFilterShow,reset:t.onReset,search:t.onPopSearchBefore}})]},proxy:!0},{key:"actions",fn:function(){return[n("el-alert",{attrs:{type:"info",closable:!1,title:"共 "+t.sessionStatistics.ttlCon+"条会话记录有效会话数 "+t.sessionStatistics.valid+" 条已质检 "+t.sessionStatistics.alreadyQC+" 条质检率 "+t.sessionStatistics.QCRate+"本次抽样 "+t.sessionStatistics.sampling+" 条"}})]},proxy:!0}])},"ui-table-view",t.viewProps,!1))},i=[],a=n("5530"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-popover",{on:{show:function(e){return t.$emit("show")}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("el-button",{staticClass:"btn-filter",attrs:{slot:"reference",type:"text",icon:"el-icon-s-operation"},slot:"reference"},[t._v("筛选条件")]),n("div",{staticClass:"wrapper"},[n("el-form",{attrs:{"label-width":"7em"}},[n("ui-select",{attrs:{label:"技能组",options:t.onlineSkills,props:{value:"id",label:"name"},multiple:"",clearable:"",filterable:""},model:{value:t.form.agentSkill,callback:function(e){t.$set(t.form,"agentSkill",e)},expression:"form.agentSkill"}}),n("ui-select",{attrs:{label:"满意度评分",multiple:"",clearable:""},model:{value:t.form.satisfaction,callback:function(e){t.$set(t.form,"satisfaction",e)},expression:"form.satisfaction"}},[n("el-option",{attrs:{label:"5星",value:"5"}}),n("el-option",{attrs:{label:"4星",value:"4"}}),n("el-option",{attrs:{label:"3星",value:"3"}}),n("el-option",{attrs:{label:"2星",value:"2"}}),n("el-option",{attrs:{label:"1星",value:"1"}})],1),n("ui-text-field",{attrs:{label:"咨询人工消息",placeholder:"请输入"},model:{value:t.form.customerCount,callback:function(e){t.$set(t.form,"customerCount",e)},expression:"form.customerCount"}},[n("div",{staticClass:"units",attrs:{slot:"suffix"},slot:"suffix"},[t._v("条")]),n("el-select",{attrs:{slot:"prepend"},slot:"prepend",model:{value:t.form.customerFlag,callback:function(e){t.$set(t.form,"customerFlag",e)},expression:"form.customerFlag"}},[n("el-option",{attrs:{label:"大于",value:"3"}}),n("el-option",{attrs:{label:"小于",value:"1"}}),n("el-option",{attrs:{label:"等于",value:"2"}})],1)],1),n("ui-text-field",{attrs:{label:"人工客服消息",placeholder:"请输入"},model:{value:t.form.agentCount,callback:function(e){t.$set(t.form,"agentCount",e)},expression:"form.agentCount"}},[n("div",{staticClass:"units",attrs:{slot:"suffix"},slot:"suffix"},[t._v("条")]),n("el-select",{attrs:{slot:"prepend"},slot:"prepend",model:{value:t.form.agentFlag,callback:function(e){t.$set(t.form,"agentFlag",e)},expression:"form.agentFlag"}},[n("el-option",{attrs:{label:"大于",value:"3"}}),n("el-option",{attrs:{label:"小于",value:"1"}}),n("el-option",{attrs:{label:"等于",value:"2"}})],1)],1)],1),n("div",{staticClass:"btn-group"},[n("el-button",{attrs:{type:"primary"},on:{click:t.onSearch}},[t._v("查询")]),n("el-button",{attrs:{type:"primary"},on:{click:t.onReset}},[t._v("重置")]),n("el-button",{on:{click:t.hide}},[t._v("取消")])],1)],1)],1)},r=[],l={props:["onlineSkills"],data:function(){return{form:{},visible:!1}},methods:{show:function(t){this.form=Object(a["a"])({},t)},hide:function(){this.visible=!1},onSearch:function(){this.hide(),this.$emit("search",this.form)},onReset:function(){this.hide(),this.$emit("reset")}}},c=l,u=(n("3a23"),n("2877")),h=Object(u["a"])(c,o,r,!1,null,"02d1ccaa",null),m=h.exports,p=n("c035"),f=n("a02a"),d={name:"QualitySessionScore",mixins:[window.mixTableView,p["a"]],components:{ComFilter:m},data:function(){var t=this;return{searchForm:{},timerange:[],viewsType:1,columns:[{label:"客户昵称",prop:"customerName",minWidth:120},{label:"会话开始时间",prop:"speakTime",minWidth:140},{label:"咨询渠道",render:function(e,n){var s=n.row;return e("span",t.channels[s.channelType])}},{label:"处理状态",minWidth:80,render:function(e,n){var s=n.row;return e("span",t.handleTypes[s.handleType])}},{label:"满意度评分",render:function(t,e){var n=e.row;return t("span","null"===n.satisfaction?"未评价":{1:"一星",2:"二星",3:"三星",4:"四星",5:"五星"}[n.satisfaction])}},{label:"警报状态",prop:"warnType"},{label:"咨询人工消息",prop:"customerCount"},{label:"人工客服消息",prop:"agentCount"},{label:"人工会话时长",render:function(e,n){var s=n.row;return e("span",t.$adminCore.formatDate(+new Date(2e3,1,1)+ +s.conDuration,"HH:mm:ss"))}},{label:"所属业务",prop:"belongBusiness",minWidth:120},{label:"接待客服",prop:"seatName",minWidth:120},{label:"质检状态",render:function(e,n){var s=n.row;return e("span",t.getQualityStatusText(s.qualityStatus))}}]}},computed:{permit:function(){return this.$store.state.permissions.indexOf("quality_session_appeal_review")>-1||this.$store.getters.isAdmin?"1":"2"},userData:function(){return this.$store.state.userData}},mounted:function(){var t=this;this.setInitForm();var e=function(){t.getData(),t.getOptionsData(),t.getOnlineSkills()};e(),Object(f["g"])(this,e)},methods:{setInitForm:function(){var t=this.$adminCore.formatDate(new Date,"yyyy-MM-dd");this.timerange=[t,t],this.searchForm={},this.tableForm={}},fetchMethod:function(t){return t=Object(a["a"])(Object(a["a"])({},t),{},{startDay:this.timerange[0],endDay:this.timerange[1],permit:this.permit,entId:this.entId,agentSkill:(t.agentSkill||"")+"",satisfaction:(t.satisfaction||"")+"",seatId:this.$store.state.userData.workNo}),this.getSessionStatistics({conversationEndDay:t.startDay,conversationStartDay:t.endDay,entId:this.entId}),this.$http.post("/quality/conversation/getConversation",t).then((function(t){return t.data}))},onReset:function(){this.setInitForm(),this.serchBefore()},onPopSearchBefore:function(t){this.searchForm=Object(a["a"])({},t),this.tableForm=Object(a["a"])({},t),this.serchBefore()},serchBefore:function(){var t=this;this.$http.post("/record/conversation/save?entId=".concat(this.entId)).then((function(){t.onSearch()}))},onclick:function(t){1===t.qualityStatus&&1===this.permit&&this.userData.workNo===t.seatId?this.$message.info("无法为自己接待的会话做质检"):this.onRowClick(t)}}},b=d,v=Object(u["a"])(b,s,i,!1,null,null,null);e["default"]=v.exports},c035:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var s=n("5530"),i=n("3835"),a=(n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("b64b"),{data:function(){return{show:!1,options:[],users:[],channels:{weixin:"微信",weibo:"微博",webim:"网页",app:"app"},handleTypes:{inservice:"服务中",end:"结束",inqueue:"队列中"},onlineUsers:[],onlineSkills:[],sessionStatistics:{}}},computed:{entId:function(){return this.$store.state.userData.entid}},methods:{getOptionsData:function(){var t=this;this.$http("/quality/programme/getAllProgramme",{params:{entId:this.entId}}).then((function(e){e=e.data,t.options=e.params}))},getSessionStatistics:function(t){var e=this;this.$http("/quality/statistics/summary",{params:t}).then((function(t){var n=t.data;e.sessionStatistics=n}))},getUsers:function(){var t=this;this.$http("/ccas/auth/user/list?entId=".concat(this.entId)).then((function(e){t.users=e.data}))},onRowClick:function(t){this.$openModal((function(){return Promise.all([n.e("chunk-45682ea3"),n.e("chunk-422b85c9"),n.e("chunk-4642dcbf"),n.e("chunk-74d195c1")]).then(n.bind(null,"218b"))}),{row:t,viewsType:this.viewsType,options:this.options,programId:this.searchForm.programId,store:this.$store,router:this.$router},{close:this.getData.bind(this)})},onTimeChange:function(t){var e=this.$adminCore.formatDate(new Date,"yyyy-MM-dd"),n=t||[e,e],s=Object(i["a"])(n,2),a=s[0],o=s[1];this.searchForm.beginTime=a,this.searchForm.endTime=o,this.onSearch()},onFilterShow:function(){this.$refs.ComFilter.show(this.searchForm)},getQualityStatusText:function(t){return{1:"未质检",2:"已质检",3:"未申诉",4:"申诉中",5:"驳回",6:"已重检"}[t]||""},onPopSearch:function(t){this.searchForm=Object(s["a"])({},t),this.tableForm=Object(s["a"])({},t),this.onSearch()},getOnlineSkills:function(){var t=this;this.$imHttp("/skill/list",{params:{orgi:this.entId}}).then((function(e){var n=e.data;t.onlineSkills=n}))},onChangeSkill:function(t){this.$set(this.searchForm,"seatId",[]),this.onSearch(),this.getOnlineUsers(t)},getOnlineUsers:function(t){var e=this;this.$imHttp.post("/skill/multiSkillCustList",{skillIds:t,orgi:this.entId}).then((function(t){var n=t.data;e.onlineUsers=n}))},checkValue:function(t){return Object.keys(t).forEach((function(e){"undefined"!==t[e]&&""!==t[e]||delete t[e]})),t}}})},f7b7:function(t,e,n){}}]);