(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da7ad"],{"6c7a":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-modal",e._g(e._b({},"ui-modal",e.modalProps,!1),e.$listeners),[n("p",[e._v("1、请选择需要导入的工单分类")]),n("div",{staticStyle:{margin:"10px 20px"}},[n("el-cascader",{attrs:{options:e.typeList,filterable:""},model:{value:e.typeId,callback:function(t){e.typeId=t},expression:"typeId"}})],1),n("p",[e._v("2、请按照模板格式填写需要导入的数据 "),n("el-link",{attrs:{type:"primary",underline:!1},on:{click:e.onDownloadTemplate}},[e._v("下载模板")])],1),n("div",{staticStyle:{margin:"10px 0"}},[e._v("3、请选择导入文件 "),n("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:e.onSelectFile}},[e._v("选择文件")]),n("span",{staticStyle:{"padding-left":"5px",color:"#999"}},[e._v(e._s(e.file&&e.file.name))]),n("input",{directives:[{name:"show",rawName:"v-show",value:0,expression:"0"}],ref:"File",attrs:{type:"file",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},on:{change:e.onChange}})],1),n("div",[n("h4",[e._v("请避免出现以下问题：")]),n("p",{staticStyle:{"padding-left":"2em"}},[e._v(" excel文件格式错误(仅支持xls,xlsx文件)"),n("br"),e._v(" 数据总数超过1000条"),n("br"),e._v(" 必填项数据为空"),n("br"),e._v(" 数据类型不匹配"),n("br")])])])},a=[],o=n("1da1"),i=(n("96cf"),n("d3b7"),n("99af"),n("ac1f"),n("1276"),n("b0c0"),n("a02a")),s={props:["typeList"],data:function(){var e=this;return{typeId:[],file:null,modalProps:{title:"批量导入",width:"520px",okText:"导入",hideMessage:!0,onSubmit:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,a,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=function(t){return e.$message.error(t),Promise.reject(new Error(t))},e.summarySortId){t.next=3;break}return t.abrupt("return",n("请先选择分类"));case 3:if(e.file){t.next=5;break}return t.abrupt("return",n("请选择文件"));case 5:return r=new FormData,r.append("file",e.file),r.append("typeId",e.summarySortId),t.next=10,e.$http.post("/workOrder/importExcel",r);case 10:a=t.sent,o=a.data,i=e.$createElement,e.$msgbox({title:"导入结果",message:i("div",null,[i("p",null,"导入成功".concat(o.success,"条，导入失败数").concat(o.failed.total,"条；")),i("el-button",{props:{type:"text",disabled:0===o.failed.total},on:{click:function(){e.onDownloadErossInfo(o.failed.data,e.summarySortId)}}},"（点击导出失败数据）")]),confirmButtonText:"确定"});case 14:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()}}},computed:{summarySortId:function(){return this.typeId[this.typeId.length-1]}},methods:{onDownloadTemplate:function(){var e=this;this.summarySortId?Object(i["i"])({fileName:"工单模板下载.xls",action:function(){return e.$post("/workOrder/downLoadTemplate",{summarySortId:e.summarySortId},{responseType:"blob"})}}):this.$message("请先选择分类")},onDownloadErossInfo:function(e,t){var n=this;Object(i["i"])({fileName:"工单导入错误信息下载.xls",action:function(){return n.$http.post("/workOrder/exportFailedList?typeId=".concat(t),e,{responseType:"blob"})}})},onChange:function(e){var t=e.target,n=["xls","xlsx"],r=t.files[0],a=r.name.split(".").pop();n.indexOf(a)>-1?this.file=r:this.$message.error("请选择Excel文件")},onSelectFile:function(){this.$refs.File.click()}}},l=s,c=n("2877"),p=Object(c["a"])(l,r,a,!1,null,null,null);t["default"]=p.exports}}]);