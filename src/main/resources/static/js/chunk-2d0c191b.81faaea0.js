(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c191b"],{4735:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[e.isAdmin?n("el-form-item",{attrs:{label:"所属企业"}},[n("ui-ent-select",{on:{change:e.onSearch},model:{value:e.searchForm.entid,callback:function(t){e.$set(e.searchForm,"entid",t)},expression:"searchForm.entid"}})],1):e._e(),n("ui-text-field",{attrs:{label:"资源名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.resourceName,callback:function(t){e.$set(e.searchForm,"resourceName",t)},expression:"searchForm.resourceName"}})]},proxy:!0},{key:"actions",fn:function(){return[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.onEdit()}}},[e._v("添加资源")])]},proxy:!0}])},"ui-table-view",Object.assign({},e.viewProps,{hidePager:!0}),!1),e.viewListeners))},a=[],i=n("1da1"),c=n("15fd"),o=n("5530"),s=(n("96cf"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("7db0"),n("a434"),n("99af"),n("60e2")),u=n("a02a"),l=["pageNum","pageSize"],d={mixins:[window.mixTableView],data:function(){return{columns:[{label:"资源",width:120,align:"center",render:function(e,t){var n=t.row;return e("el-image",{style:"width:100%;height:70px;",props:{fit:"contain",src:n.src,previewSrcList:[n.src]},domProps:{title:"单击预览大图"}})}},{label:"资源名称",prop:"resourceName"},{label:"资源描述",prop:"remark",minWidth:140},{label:"操作",width:100,fixed:"right",render:this.$hBtns([{label:"编辑",action:this.onEdit},{label:"删除",action:this.onDelete}])}]}},computed:{isAdmin:function(){return this.$store.getters.isAdmin}},mounted:function(){this.setInitForm(),this.getData(),Object(u["g"])(this,this.getData)},methods:{setInitForm:function(){this.tableForm={entid:this.$store.state.userData.entid},this.searchForm=Object(o["a"])({},this.tableForm)},fetchMethod:function(e){var t=this,n=(e.pageNum,e.pageSize,Object(c["a"])(e,l));return this.$http("/ccas/call/ivr/video/resource/list",{params:n}).then((function(e){var n=e.data;return{data:n.map((function(e){return Object(o["a"])(Object(o["a"])({},e),{},{src:t.getSrc(e)})}))}}))},getSrc:function(e){return Object(s["c"])("/ccas/call/ivr/video/resource/download/".concat(e.resourceId))},onDelete:function(e){var t=this;this.delData({action:function(){return t.$http("/ccas/call/ivr/video/resource/del/".concat(e.resourceId))}})},onEdit:function(e){var t=this;this.$openModal((function(){return n.e("chunk-2a8cd3d8").then(n.bind(null,"a97a"))}),{row:e,entid:this.searchForm.entid},{success:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n,r){var a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getData();case 2:n&&(a=t.tableData.data,i=a.find((function(e){return e.resourceId===r.resourceId})),c=a.indexOf(i),a.splice(c,1,Object(o["a"])(Object(o["a"])({},i),{},{src:"".concat(t.getSrc(i),"?v=").concat(Date.now())})));case 3:case"end":return e.stop()}}),e)})));function n(t,n){return e.apply(this,arguments)}return n}()})}}},h=d,p=n("2877"),m=Object(p["a"])(h,r,a,!1,null,null,null);t["default"]=m.exports}}]);