(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2545004e"],{"0345":function(e,t,n){"use strict";n("87b6")},"45ec":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({scopedSlots:e._u([{key:"search",fn:function(){return[n("ui-select",{attrs:{label:"技能组",options:e.skillGroups,props:{value:"id",label:"name"},clearable:"",filterable:""},on:{change:e.onGroupChange},model:{value:e.searchForm.skillId,callback:function(t){e.$set(e.searchForm,"skillId",t)},expression:"searchForm.skillId"}}),n("ui-select",{attrs:{label:"客服",options:e.agents,props:{value:"agentno",label:"name"},clearable:"",filterable:""},on:{change:e.onSearch},model:{value:e.searchForm.agentId,callback:function(t){e.$set(e.searchForm,"agentId",t)},expression:"searchForm.agentId"}}),n("ui-select",{attrs:{label:"咨询渠道",options:e.channels,clearable:""},on:{change:e.onSearch},model:{value:e.searchForm.channel,callback:function(t){e.$set(e.searchForm,"channel",t)},expression:"searchForm.channel"}}),n("ui-text-field",{attrs:{label:"客户昵称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.searchForm.nickname,callback:function(t){e.$set(e.searchForm,"nickname",t)},expression:"searchForm.nickname"}})]},proxy:!0}])},"ui-table-view",e.viewProps,!1),e.viewListeners),[n("div",{staticClass:"box",attrs:{slot:"actions"},slot:"actions"},[n("el-checkbox",{on:{change:function(t){return e.getData()}},model:{value:e.autoRefresh,callback:function(t){e.autoRefresh=t},expression:"autoRefresh"}},[e._v("自动刷新(10s)")]),n("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-refresh"},on:{click:function(t){return e.getData()}}},[e._v("刷新")])],1)])},a=[],i=n("5530"),s=n("1da1"),o=(n("96cf"),n("b0c0"),n("7db0"),n("d3b7"),n("3ca3"),n("ddb0"),n("a02a")),c=n("934a"),l={mixins:[window.mixTableView],data:function(){var e=this;return{channels:c["a"],skillGroups:[],agents:[],autoRefresh:!1,columns:[{label:"人工客服",prop:"agentname"},{label:"技能组",render:function(t,n){var r=n.row;return t("span",r.agentskillname||(e.skillGroups.find((function(e){return e.id===r.agentskill}))||{}).name)}},{label:"会话时长",minWidth:80,render:function(t,n){var r=n.row;return t("span",e.$adminCore.formatDate(+new Date(2e3,1,1)+r.sessiontimes,"HH:mm:ss"))}},{label:"客户昵称",prop:"nickname"},{label:"会话建立时间",minWidth:140,render:function(t,n){var r=n.row;return t("span",e.$adminCore.formatDate(r.servicetime))}},{label:"咨询渠道",minWidth:80,render:function(e,t){var n=t.row;return e("span",c["a"][n.channel])}},{label:"操作",width:100,fixed:"right",render:this.$hBtns({label:"查看会话",action:this.onViewSession})}]}},computed:{imUser:function(){return this.$store.getters.imUser}},mounted:function(){this.getInitData(),Object(o["g"])(this,this.getInitData,this.clearTimer),this.$once("hook:beforeDestroy",this.clearTimer)},methods:{fetchMethod:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$imHttp("/monitor/agentUserList?orgi=".concat(t.imUser.orgi),{params:e});case 2:return r=n.sent,a=r.data,t.clearTimer(),t.autoRefresh&&(t.tid=setTimeout(t.getData.bind(t),1e4)),n.abrupt("return",{data:a.records,total:a.total});case 7:case"end":return n.stop()}}),n)})))()},getInitData:function(){this.getData(),this.getSkillGroups()},getSkillGroups:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$imHttp("/skill/list?orgi=".concat(e.imUser.orgi));case 2:e.skillGroups=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},onGroupChange:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.searchForm=Object(i["a"])(Object(i["a"])({},t.searchForm),{},{agentId:void 0}),r={orgi:t.imUser.orgi,skillId:e},!e){n.next=8;break}return n.next=5,t.$imHttp("/skill/custList",{params:r});case 5:n.t0=n.sent.data,n.next=9;break;case 8:n.t0=[];case 9:t.agents=n.t0,t.onSearch();case 11:case"end":return n.stop()}}),n)})))()},clearTimer:function(){clearTimeout(this.tid),this.tid=null},onViewSession:function(e){this.$openModal((function(){return Promise.all([n.e("chunk-6fc10807"),n.e("chunk-0e839fa8")]).then(n.bind(null,"16c6"))}),{row:e,imUser:this.imUser})}}},u=l,h=(n("0345"),n("2877")),m=Object(h["a"])(u,r,a,!1,null,"3c2b7578",null);t["default"]=m.exports},"87b6":function(e,t,n){}}]);