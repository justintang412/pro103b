(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e601fbc"],{"1ffe":function(e,t,n){},"46a4":function(e,t,n){"use strict";n("1ffe")},"498a":function(e,t,n){"use strict";var r=n("23e7"),i=n("58a8").trim,a=n("c8d2");r({target:"String",proto:!0,forced:a("trim")},{trim:function(){return i(this)}})},"65bd":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._b({},"ui-table-view",e.viewProps,!1))},i=[],a={mixins:[window.mixTableView],props:["customerId"],data:function(){return{columns:[{label:"联系人",prop:"contactName"},{label:"联系电话",prop:"contactPhone"},{label:"性别",render:function(e,t){var n=t.row;return e("div",{1:"男",2:"女"}[n.contactSex])}},{label:"预约时间",prop:"reserveTime",minWidth:140},{label:"联系状态",render:function(e,t){var n=t.row;return e("div",{1:"已预约",2:"已联系"}[n.planStatus])}}]}},watch:{customerId:{immediate:!0,handler:function(e){e&&this.getData()}}},methods:{fetchMethod:function(e){return this.$http("/ccas/call/manual/contact/list/by/customerId?customerId=".concat(this.customerId),{params:e}).then((function(e){return e.data}))}}},o=a,c=n("2877"),s=Object(c["a"])(o,r,i,!1,null,null,null);t["a"]=s.exports},"977e":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({},"ui-table-view",e.viewProps,!1),e.viewListeners))},i=[],a=n("5530"),o=n("a02a"),c={mixins:[window.mixTableView],props:{action:Function,customerId:String},data:function(){return{columns:[{label:"通话类型",minWidth:80,render:function(e,t){var n=t.row;return e("div",1===n.dir?"呼入":"呼出")}},{label:"主叫号码",prop:"caller",minWidth:120},{label:"被叫号码",prop:"called",minWidth:120},{label:"开始时间",prop:"beginTime",minWidth:140},{label:"通话总时长",render:function(e,t){var n=t.row;return e("div",Object(o["k"])(n.callTimeLen))}},{label:"处理状态",minWidth:80,render:function(e,t){var n=t.row;return e("div",{1:"未接听",2:"已接听"}[n.callResult])}},{label:"客服",prop:"userName"}]}},watch:{customerId:{immediate:!0,handler:function(e){e&&this.getData()}}},methods:{fetchMethod:function(e){return this.action?this.action():this.$http("/ccas/call/info/list",{params:Object(a["a"])(Object(a["a"])({},e),{},{customerId:this.customerId})}).then((function(e){return e.data}))}}},s=c,u=n("2877"),l=Object(u["a"])(s,r,i,!1,null,null,null);t["a"]=l.exports},b2a1:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({},"ui-table-view",e.viewProps,!1),e.viewListeners))},i=[],a=n("5530"),o=(n("d3b7"),n("3ca3"),n("ddb0"),n("fffc")),c={mixins:[window.mixTableView],props:["customerId"],data:function(){var e=this;return{columns:[{label:"工单编号",prop:"number",minWidth:140},Object(o["g"])(),{label:"优先级",minWidth:80,render:function(e,t){var n=t.row;return e("span",Object(o["i"])(n.priority))}},{label:"状态",minWidth:80,render:function(e,t){var n=t.row;return e("span",Object(o["j"])(n.status))}},{label:"分类",prop:"serviceName",minWidth:140},{label:"创建人",prop:"creator",minWidth:120},{label:"受理客服组",prop:"sgroupName",minWidth:120},{label:"受理客服",prop:"acceptor",minWidth:120},{label:"创建时间",prop:"createTime",minWidth:140},{label:"更新时间",prop:"modifyTime",minWidth:140},{label:"操作",width:100,fixed:"right",render:function(t,n){var r=n.row;return e.$hBtns([{label:"详情",action:e.onDetail},4===r.status&&{label:"激活",action:e.onActive},r.status<3&&{label:"催单",action:e.onUrgent}])(t,{row:r})}}]}},watch:{customerId:{immediate:!0,handler:function(e){e&&this.getData()}}},methods:{fetchMethod:function(e){return this.$post("/customerWorkOrder/getWorkOrder",Object(a["a"])(Object(a["a"])({},e),{},{customerId:this.customerId})).then((function(e){return e.data}))},onActive:function(e){this.$openModal((function(){return n.e("chunk-2d2133b8").then(n.bind(null,"ac99"))}),{row:{orderId:e.orderId,creatorId:this.$store.state.userData.userId},sgList:this.sgList},{success:this.onSearch})},onDetail:function(e){this.$router.push({name:"workorder-detail",params:{id:e.id}})},onUrgent:function(e){this.$openModal((function(){return n.e("chunk-2d208a99").then(n.bind(null,"a66d"))}),{row:{orderId:e.id,creatorId:e.creatorId}},{success:this.onSearch})}}},s=c,u=n("2877"),l=Object(u["a"])(s,r,i,!1,null,null,null);t["a"]=l.exports},c71f:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-table-view",e._g(e._b({},"ui-table-view",e.viewProps,!1),e.viewListeners))},i=[],a=n("5530"),o=(n("d3b7"),n("3ca3"),n("ddb0"),n("a02a")),c={mixins:[window.mixTableView],props:["customerId"],data:function(){return{columns:[{label:"会话开始时间",prop:"servicetime",minWidth:140},{label:"会话时长",render:function(e,t){var n=t.row;return e("span",Object(o["k"])(n.sessiontimes))}},{label:"最后接待客服",prop:"agentno"},{label:"所属业务",prop:"datadept"},{label:"处理状态",render:function(e,t){var n=t.row;return e("span",{inservice:"服务中",end:"结束",inqueue:"队列中"}[n.status])}},{label:"满意度",minWidth:140,render:function(e,t){var n=t.row;return e("el-rate",{props:{disabled:!0,value:n.satisfaction}})}},{label:"操作",width:80,fixed:"right",render:this.$hBtns({label:"详情",action:this.onDetail})}]}},watch:{customerId:{immediate:!0,handler:function(e){e&&this.getData()}}},methods:{fetchMethod:function(e){return this.$http("/ccas/cc/other/api/im/session/record",{params:Object(a["a"])(Object(a["a"])({},e),{},{customerId:this.customerId})}).then((function(e){var t=e.data;return{data:t.records,total:t.total}}))},onDetail:function(e){this.$openModal((function(){return Promise.all([n.e("chunk-45682ea3"),n.e("chunk-422b85c9"),n.e("chunk-4642dcbf"),n.e("chunk-d218a22e")]).then(n.bind(null,"36b6"))}),{row:Object(a["a"])(Object(a["a"])({},e),{},{customerId:this.customerId})})}}},s=c,u=n("2877"),l=Object(u["a"])(s,r,i,!1,null,null,null);t["a"]=l.exports},c8d2:function(e,t,n){var r=n("5e77").PROPER,i=n("d039"),a=n("5899"),o="​᠎";e.exports=function(e){return i((function(){return!!a[e]()||o[e]()!==o||r&&a[e].name!==e}))}},fd3b:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"container"},[n("header",{staticClass:"header"},[n("span",{staticClass:"header-title"},[e._v("客户信息")]),e.readonly?n("el-link",{attrs:{type:"primary",icon:"el-icon-edit",underline:!1},on:{click:e.onEdit}},[e._v("编辑")]):e._e()],1),n("main",{staticClass:"main"},[n("el-scrollbar",{staticClass:"ui-scrollbar"},[n("com-customer-form",e._g({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ComCustomerForm",attrs:{onSendSms:e.onSendSms,onCall:e.onCall,readonly:e.readonly,operationSource:e.operationSource,mergeAction:e.mergeAction,"inline-message":""}},e.$listeners),[e.readonly?e._e():n("el-form-item",[n("el-button",{on:{click:e.onCancel}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)],1)],1)])},i=[],a=n("1da1"),o=(n("96cf"),n("5425")),c={components:{ComCustomerForm:o["a"]},props:{params:{type:Object,default:function(){return{}}},onSendSms:Function,operationSource:{},mergeAction:Function},data:function(){return{readonly:!0,loading:!1}},mounted:function(){this.getInitData()},methods:{onCancel:function(){this.readonly=!0},onEdit:function(){this.readonly=!1},getInitData:function(){return this.onCancel(),this.$refs.ComCustomerForm.getInitData(this.params)},onSubmit:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.ComCustomerForm.validate();case 2:return e.loading=!0,t.prev=3,t.next=6,e.$refs.ComCustomerForm.submit();case 6:e.readonly=!0,t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](3);case 11:e.loading=!1;case 12:case"end":return t.stop()}}),t,null,[[3,9]])})))()},onCall:function(e,t){t.customerId?this.$eventBus.$emit("phonebar",{type:"makecall",payload:{args:[e,""],params:{phone:e,customerId:t.customerId}}}):this.$message.warning("请先编辑并保存客户信息后再呼叫！")}}},s=c,u=(n("46a4"),n("2877")),l=Object(u["a"])(s,r,i,!1,null,"8a8222fc",null);t["a"]=l.exports},fffc:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return w})),n.d(t,"j",(function(){return g})),n.d(t,"c",(function(){return I})),n.d(t,"o",(function(){return T})),n.d(t,"i",(function(){return O})),n.d(t,"h",(function(){return y})),n.d(t,"l",(function(){return E})),n.d(t,"k",(function(){return j})),n.d(t,"g",(function(){return k})),n.d(t,"m",(function(){return x}));var r=n("1da1"),i=n("2909"),a=n("5530"),o=n("ade3"),c=(n("96cf"),n("7db0"),n("d3b7"),n("b0c0"),n("a15b"),n("99af"),n("d81d"),n("4de4"),n("b64b"),n("caad"),n("2532"),n("3ca3"),n("ddb0"),n("159b"),n("a02a")),s="workorder",u={label:"尚未受理",value:0},l={label:"受理中",value:1},d={label:"等待回复",value:2},p={label:"已解决",value:3},m={label:"已关闭",value:4},h=[5,"已删除"],f=[u,l,d],b=[p,m],v=[u,l,d,p,m],w=[l,p,m],g=function(e){return(v.find((function(t){return t.value===e}))||{}).label},I=[[0,"我来受理工单","您好，我是 {COMPANY_NAME} 的客服代表 {SERVICE_NICK} ，很高兴为您服务！\n  我们已将您的请求生成工单 {TICKET_CODE} - {TICKET_TITLE}。该工单正在进行处理，一旦有任何更新我们会及时给您回复，请您耐心等待。"],[1,"尝试联系用户","您好，我是 {COMPANY_NAME} 的客服代表 {SERVICE_NICK} ，很抱歉在您百忙之中打扰您。\n  关于您的工单 {TICKET_CODE} - {TICKET_TITLE} ，我们希望确认您是否还存在其他疑问。鉴于还没有收到您的回复，我们会继续尝试联系您。如果您有任何进展或者其他疑问，可随时在系统中进行回复，感谢您的理解与支持。"],[2,"客服处理完毕，请用户确认","您好，您的工单 {TICKET_CODE} - {TICKET_TITLE} 已完成处理，请在回复中进行确认。\n  希望我们的工作能使您满意，如您有任何建议或意见，欢迎回复告知我们，我们会努力改进。"],[3,"用户没有回复工单","您好，您的工单 {TICKET_CODE} - {TICKET_TITLE} 用户超时未回复，置为已解决。"]],T=[{label:"低",value:0},{label:"中",value:1},{label:"高",value:2},{label:"紧急",value:3}],O=function(e){return(T.find((function(t){return t.value===e}))||{}).label},C={INPUT:0,TEXTAREA:1,RADIO:2,CHECKBOX:3,SELECT:4},y=function(e){var t;return t={},Object(o["a"])(t,e.INPUT,"单行文本框"),Object(o["a"])(t,e.TEXTAREA,"多行文本框"),Object(o["a"])(t,e.RADIO,"单选框"),Object(o["a"])(t,e.CHECKBOX,"复选框"),Object(o["a"])(t,e.SELECT,"下拉框"),t}(C),E=function(e){return!Object(c["v"])(e)&&e>1},j=function(e,t){var n=[],r=e.find((function(e){return e.id===t}));while(r)n.unshift(r.name),r=e.find((function(e){return e.id===r.parentId}));return n.join(" / ")},k=function(){return{label:"工单标题",prop:"name",minWidth:120,render:function(e,t){var n=t.row;return 1===n.flag&&new Date-new Date(n.lastUrgeTime)<864e5?e("span",[e("span",{style:"color:#E59208;border:1px solid #E59208;padding:2px;margin-right:5px"},"催"),e("span",n.name)]):e("span",n.name)}}},x={data:function(){var e=this,t=["number","name","channelId","status","sgroupName","acceptor","typeId","createTime"];return{priorities:T,types:[],skillGroups:[],states:v,allColumns:{base:{title:"基础字段",data:[{label:"工单编号",prop:"number",minWidth:140},k(),{label:"创建渠道",prop:"channelId",minWidth:80,render:function(e,t){var n=t.row;return e("span",1===n.channelId?"工单中心":"在线客服")}},{label:"工单描述",prop:"description",minWidth:120},{label:"工单状态",prop:"status",minWidth:80,render:function(e,t){var n=t.row;return e("span",g(n.status)||"已删除")}},{label:"优先级",prop:"priority",minWidth:80,render:function(e,t){var n=t.row;return e("span",O(n.priority))}},{label:"创建人",prop:"cuserName"},{label:"创建客服组",prop:"cgroupName",minWidth:120},{label:"受理客服组",prop:"sgroupName",minWidth:120},{label:"受理客服",prop:"acceptor"},{label:"分类",prop:"typeId",minWidth:140,render:function(t,n){var r=n.row;return t("span",e.getTypeText(r.typeId))}},{label:"创建时间",prop:"createTime",minWidth:140},{label:"首次响应时间",prop:"firstUpdateTime",minWidth:140},{label:"首次受理时间",prop:"firstAcceptTime",minWidth:140},{label:"更新时间",prop:"modifyTime",minWidth:140},{label:"首次解决时间",prop:"firstSolveTime",minWidth:140},{label:"最后回复人",prop:"lastReplingPersonName"}]},customer:{title:"客户字段",data:[{label:"客户昵称",prop:"customerNickName"},{label:"客户姓名",prop:"customerName"}]}},defaultProps:t,selectedProps:[].concat(t)}},computed:{typeList:function(){return Object(c["F"])(this.types.map((function(e){return Object(a["a"])(Object(a["a"])({},e),{},{value:e.id,label:e.name})})))},showedColumns:function(){var e=this;return[{type:"selection"}].concat(Object(i["a"])(Object.keys(this.allColumns).reduce((function(t,n){return[].concat(Object(i["a"])(t),Object(i["a"])(e.allColumns[n].data))}),[]).filter((function(t){return e.selectedProps.includes(t.prop)}))))},typeId:function(){var e=this.searchForm.typeId;return e&&e.length?e[e.length-1]:""}},mounted:function(){this.setInitForm&&this.setInitForm(),this.getInitData(),Object(c["g"])(this,this.getInitData)},methods:{getStateText:g,getInitData:function(){this.isActive?this.getData():(this.onReset(),this.isActive=!0),this.getTypes(),this.getSkillGroups()},onDelete:function(e){var t=this;this.delData({rows:e,action:function(e){return t.$post("/workOrder/delete",{orderId:e.map((function(e){return e.id}))+""})}})},getSkillGroups:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/orderGroup/listGroup");case 2:e.skillGroups=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},getGroupText:function(e){return(this.skillGroups.find((function(t){return t.id===e}))||{}).name},onCreate:function(){this.$openModal((function(){return n.e("chunk-497ef431").then(n.bind(null,"4bd2"))}),{},{success:this.onEditSuccess})},onBatchImport:function(){this.$openModal((function(){return n.e("chunk-2d0da7ad").then(n.bind(null,"6c7a"))}),{typeList:this.typeList},{success:this.onEditSuccess})},onBatchExport:function(e,t){var n=this,r=t.typeId||[],i=r[r.length-1];i?Object(c["i"])({fileName:"工单批量导出数据.xls",action:function(){return n.$post(e,Object(a["a"])(Object(a["a"])({},t),{},{typeId:i}),{responseType:"blob"})}}):this.$message("请先选择分类再导出")},onDetail:function(e){this.$router.push({name:"".concat(s,"-detail"),params:{id:e.id}})},onAccept:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e instanceof Array?e.map((function(e){return e.id}))+"":e.id,n.next=3,t.$post("/workOrder/accept",{orderId:r});case 3:t.$message.success("接单成功"),t.getData();case 5:case"end":return n.stop()}}),n)})))()},getTypes:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/orderType/listByPage");case 2:e.types=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},getTypeText:function(e){return j(this.types,e)},onKeyChange:function(){var e=this;this.options.forEach((function(t){e.$set(e.searchForm,t[0],void 0)}))},onCustomField:function(){var e=this;this.$openModal("UiFieldCustom",{columns:this.allColumns,defaultProps:this.defaultProps,selectedProps:this.selectedProps},{success:function(t){e.selectedProps=t}})}}}}}]);