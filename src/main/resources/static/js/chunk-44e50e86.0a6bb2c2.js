(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44e50e86"],{"0f9d":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("header",{staticClass:"header"},[i("span",[t._v("设置方式：")]),i("el-radio-group",{on:{change:t.onTypeChange},model:{value:t.settingType,callback:function(e){t.settingType=e},expression:"settingType"}},[i("el-radio",{attrs:{label:"0"}},[t._v("整体设置")]),t.groups.length?i("el-radio",{attrs:{label:"1"}},[t._v("区分技能组设置")]):i("el-radio",{attrs:{disabled:"",title:"技能组列表为空，请先添加在线技能组",label:"1"}},[t._v("区分技能组设置")])],1)],1),i("main",{staticClass:"main"},[t.isSkill?i("aside",{staticClass:"aside"},[i("ul",t._l(t.groups,(function(e){return i("li",{key:e.id,class:{active:t.curGroup&&t.curGroup.id===e.id},on:{click:function(i){return t.onGroupClick(e)}}},[t._v(t._s(e.name))])})),0)]):t._e(),i("div",{staticClass:"settings"},[t.curGroup?i("header",{staticClass:"settings-header"},[i("span",[t._v(t._s(t.curGroup.name))])]):t._e(),i("main",{staticClass:"settings-main"},[i("el-form",{ref:"Form",attrs:{"label-width":"11em",model:t.form,rules:t.rules},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"人工客服是否解决问题"}},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0},on:{change:t.onQuestionFlagChange},model:{value:t.form.isQuestionFlag,callback:function(e){t.$set(t.form,"isQuestionFlag",e)},expression:"form.isQuestionFlag"}},[t._v("开启")]),i("p",{staticClass:"tip"},[t._v("＊开启此功能后，在人工客服满意度评价页显示是否解决问题选项，帮助统计客服解决问题的能力。")])],1),i("el-form-item",{attrs:{label:"添加评价标签库"}},[i("el-input",{staticStyle:{"max-width":"250px"},attrs:{maxlength:"8",placeholder:"最多输入8个字（含字符）",disabled:t.labelList.length>29},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onAddLabel.apply(null,arguments)}},model:{value:t.evalLabel,callback:function(e){t.evalLabel=e},expression:"evalLabel"}},[i("el-button",{attrs:{slot:"append"},on:{click:t.onAddLabel},slot:"append"},[t._v("添加")])],1),i("div",{staticStyle:{"margin-top":"10px"}},[i("span",[t._v("已添加标签 "),i("b",{staticClass:"labelCount"},[t._v(t._s(t.labelList.length))]),t._v("/30")]),t.labelList.length>0?i("el-link",{staticStyle:{"margin-left":"10px"},attrs:{underline:!1,type:"primary"},on:{click:t.onDeleteAllLabel}},[t._v("全部删除")]):t._e()],1),t._l(t.labelList,(function(e){return i("el-tag",{key:e.tagId,staticStyle:{"margin-right":"10px"},attrs:{type:"info",closable:""},on:{close:function(i){return t.onDeleteLabel(e)}}},[t._v(t._s(e.tagName))])}))],2),i("el-form-item",{attrs:{label:"星级评价显示"}},[i("el-radio-group",{on:{change:t.onDefaultStarTypeChange},model:{value:t.form.defaultType,callback:function(e){t.$set(t.form,"defaultType",e)},expression:"form.defaultType"}},[i("el-radio",{attrs:{label:5}},[t._v("默认5星")]),i("el-radio",{attrs:{label:0}},[t._v("默认0星")])],1)],1),i("el-form-item",{attrs:{label:"星级评价设置明细"}},[i("div",{staticClass:"starDetailBox"},[i("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.onStarTabClick},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}},t._l(5,(function(t){return i("el-tab-pane",{key:t,attrs:{name:""+(6-t),label:6-t+"星"}})})),1),i("ui-text-field",{attrs:{label:t.form.score+"星说明","label-width":"7em",prop:"scoreExplain","input-style":"max-width:250px;",maxlength:"12",placeholder:"最多输入12个字（含字符）"},model:{value:t.form.scoreExplain,callback:function(e){t.$set(t.form,"scoreExplain",e)},expression:"form.scoreExplain"}}),i("el-form-item",{attrs:{label:t.form.score+"星标签","label-width":"7em",prop:"tagIds",rules:t.tagsRules}},[i("p",{staticClass:"tip"},[t._v("最多添加6个标签")]),i("el-checkbox-group",{model:{value:t.form.tagIds,callback:function(e){t.$set(t.form,"tagIds",e)},expression:"form.tagIds"}},t._l(t.labelList,(function(e){return i("el-checkbox",{key:e.tagId,attrs:{label:e.tagId,disabled:t.disTag(e)}},[t._v(t._s(e.tagName))])})),1)],1),i("el-form-item",{attrs:{label:"标签是否必选","label-width":"7em"}},[i("el-radio-group",{model:{value:t.form.isTagMust,callback:function(e){t.$set(t.form,"isTagMust",e)},expression:"form.isTagMust"}},[i("el-radio",{attrs:{label:1}},[t._v("必选")]),i("el-radio",{attrs:{label:0}},[t._v("非必选")])],1)],1),+t.form.score<5?[i("ui-text-field",{attrs:{label:"评价框引导语","label-width":"7em","input-style":"max-width:250px;",maxlength:"100"},model:{value:t.form.guide,callback:function(e){t.$set(t.form,"guide",e)},expression:"form.guide"}}),i("el-form-item",{attrs:{label:"评价框是否必填","label-width":"8em"}},[i("el-radio-group",{model:{value:t.form.isGuideMust,callback:function(e){t.$set(t.form,"isGuideMust",e)},expression:"form.isGuideMust"}},[i("el-radio",{attrs:{label:1}},[t._v("必填")]),i("el-radio",{attrs:{label:0}},[t._v("选填")])],1)],1)]:t._e()],2)]),i("el-form-item",[i("div",{staticStyle:{"text-align":"center"}},[i("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v(t._s(t.loading?"提交中...":"保存"))])],1)])],1)],1)])])])},s=[],r=i("15fd"),l=i("5530"),o=(i("498a"),i("a434"),i("ac1f"),i("1276"),i("4de4"),i("d3b7"),i("7db0"),i("b0c0"),i("d81d"),["tagIds"]),n={data:function(){var t=this;return{form:{score:"5",defaultType:5,tagIds:[]},groups:[],curGroup:null,evalLabel:"",bakData:{},list:[],labelList:[],settingType:"0",currentStar:"5",rules:{scoreExplain:{trigger:"blur",required:!0,validator:function(e,i,a){i&&i.trim()?a():a(new Error("请输入".concat(t.form.score,"星说明")))}}},loading:!1}},computed:{imUser:function(){return this.$store.getters.imUser},isSkill:function(){return"0"!==this.settingType},tagsRules:function(){var t=this;return{required:this.form.isTagMust,validator:function(e,i,a){!e.required||i.length?a():a(new Error("请选择".concat(t.form.score,"星标签")))}}}},mounted:function(){this.getGroups(),this.getSettings()},methods:{disTag:function(t){var e=this.form.tagIds;return e.length>5&&e.indexOf(t.tagId)<0},onQuestionFlagChange:function(t){var e=this;this.$imPost("/satisfact/isQuestionFlag",{isQuestionFlag:t,orgi:this.imUser.orgi,skillId:"0"===this.settingType?"":this.curGroup&&this.curGroup.id}).then((function(){e.$message.success("操作成功"),e.getSettings(e.curGroup&&e.curGroup.id,e.form.score)}))},onDefaultStarTypeChange:function(t){var e=this;this.$imPost("/satisfact/defaultType",{defaultType:t,orgi:this.imUser.orgi,skillId:"0"===this.settingType?"":this.curGroup&&this.curGroup.id}).then((function(){e.$message.success("操作成功"),e.getSettings(e.curGroup&&e.curGroup.id,e.form.score)}))},onTypeChange:function(t){if(this.$refs.Form.clearValidate(),this.form.score="5","1"===t)return this.curGroup||(this.curGroup=this.groups[0]),this.curGroup&&this.getSettings(this.curGroup.id);this.getSettings()},onAddLabel:function(){var t=this,e=this.evalLabel.trim();e&&this.$imPost("/satisfact/saveTag",{tagName:e,orgi:this.imUser.orgi,skillId:this.isSkill?this.curGroup&&this.curGroup.id:""}).then((function(i){var a=i.data;t.evalLabel="",t.labelList.push({tagId:a,tagName:e})}))},onDeleteLabel:function(t){var e=this;this.$confirm("删除标签后，星级评价设置里的对应标签也会删除，是否继续删除？","删除标签").then((function(){e.$imHttp("/satisfact/delTag",{params:{tagId:t.tagId,orgi:e.imUser.orgi,skillId:e.isSkill?e.curGroup&&e.curGroup.id:""}}).then((function(){e.labelList.splice(e.labelList.indexOf(t),1),e.form.tagIds=e.getTagIds(e.form.tagIds)}))}))},onDeleteAllLabel:function(){var t=this;this.$confirm("删除标签后，星级评价设置里的对应标签也会删除，是否继续删除？","删除标签").then((function(){t.$imHttp("/satisfact/delAllTag",{params:{orgi:t.imUser.orgi,skillId:t.isSkill?t.curGroup&&t.curGroup.id:""}}).then((function(){t.labelList=[],t.form.tagIds=[]}))}))},getGroups:function(){var t=this;this.$imHttp("/skill/list",{params:{orgi:this.imUser.orgi}}).then((function(e){var i=e.data;t.groups=i}))},onGroupClick:function(t){this.curGroup=t,this.getSettings(t.id)},getSettings:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"5";this.$imHttp("/satisfact/listSatisfact",{params:{orgi:this.imUser.orgi,skillId:t||""}}).then((function(t){var a=t.data;e.list=a.list,e.labelList=a.tagList,e.setDetail(i)}))},getTagIds:function(t){var e=this;return t=t instanceof Array?t:t?t.split(","):[],t.filter((function(t){return e.labelList.some((function(e){return e.tagId===t}))}))},setDetail:function(t){var e=this.list.find((function(e){return e.score===+t}));this.form=e?Object(l["a"])(Object(l["a"])({},e),{},{score:t,tagIds:this.getTagIds(e.tagId)}):{score:t,tagIds:[],defaultType:0}},onStarTabClick:function(t){this.setDetail(t.name),this.$refs.Form.clearValidate()},onSubmit:function(){var t=this;this.$refs.Form.validate((function(e){if(e){t.loading=!0;var i=t.imUser.orgi,a=t.form,s=a.tagIds,n=Object(r["a"])(a,o);s=s.filter((function(e){return t.labelList.some((function(t){return t.tagId===e}))}));var u=Object(l["a"])(Object(l["a"])({},n),{},{orgi:i,score:+n.score,guide:n.guide||"",isGuideMust:n.isGuideMust||0,skillId:t.isSkill?t.curGroup&&t.curGroup.id:"",skillName:t.isSkill?t.curGroup&&t.curGroup.name:"",tagId:s+"",tagName:s.map((function(e){return t.labelList.find((function(t){return t.tagId===e})).tagName}))+""});(t.form.configId?t.$imHttp.post("/satisfact/updateSatisfact?orgi=".concat(i),u):t.$imHttp.post("/satisfact/saveSatisfact?orgi=".concat(i),u)).then((function(){t.$message.success("操作成功"),t.getSettings(t.curGroup&&t.curGroup.id,n.score)})).finally((function(){t.loading=!1}))}}))}}},u=n,c=(i("f833"),i("2877")),d=Object(c["a"])(u,a,s,!1,null,"07723d21",null);e["default"]=d.exports},"498a":function(t,e,i){"use strict";var a=i("23e7"),s=i("58a8").trim,r=i("c8d2");a({target:"String",proto:!0,forced:r("trim")},{trim:function(){return s(this)}})},"530d":function(t,e,i){},c8d2:function(t,e,i){var a=i("5e77").PROPER,s=i("d039"),r=i("5899"),l="​᠎";t.exports=function(t){return s((function(){return!!r[t]()||l[t]()!==l||a&&r[t].name!==t}))}},f833:function(t,e,i){"use strict";i("530d")}}]);