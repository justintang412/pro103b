(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1bb6cfa"],{"09cd":function(t,e,a){"use strict";a("2478")},1004:function(t,e,a){"use strict";a("6151")},1054:function(t,e,a){},2478:function(t,e,a){},"2b13":function(t,e,a){"use strict";a("1054")},"3fcf":function(t,e,a){"use strict";a("f645")},"49e6":function(t,e,a){},"59f0":function(t,e,a){"use strict";a("49e6")},6151:function(t,e,a){},ae54:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sq-plan"},[a("div",{staticClass:"sq-plan-left"},[a("com-plan-menu",{on:{"select-item":t.onSelectData}})],1),a("div",{staticClass:"sq-plan-right"},[a("div",{staticClass:"plan-right-top"},[t._v(t._s(t.selectData.name))]),t.selectData.name?a("el-scrollbar",[a("div",{staticClass:"right-content"},[a("com-inspection",{attrs:{"programme-id":t.selectData.companyId},on:{delete:t.onDelet}}),a("com-additional",{attrs:{"programme-id":t.selectData.companyId},on:{delete:t.onDelet}}),a("com-fraction",{ref:"fraction",attrs:{"programme-id":t.selectData.companyId}}),a("com-labe",{attrs:{"programme-id":t.selectData.companyId}})],1)]):a("div",{staticClass:"empty"},[t._v("请添加质检方案")])],1)])},i=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inspection-item"},[a("div",{staticClass:"inspection-title"},[t._v("质检项")]),a("ui-table-view",{attrs:{hidePager:"",loading:t.loading,columns:t.columns,data:t.tableData,"empty-text":"暂无标准分项数据"}}),a("div",{staticClass:"inspection-bottom"},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.onEdit()}}},[t._v("添加标准分项")]),a("div",{staticClass:"total"},[t._v("当前满分值："+t._s(t.scoreTTL))])],1)],1)},s=[],l=a("5530"),r=(a("d3b7"),a("4e82"),a("3ca3"),a("ddb0"),a("a434"),a("bc3a")),c=a.n(r),d={data:function(){var t=this;return{tableData:[],scoreTTL:0,loading:!1,disabled:!1,columns:[{label:"序号",type:"index"},{label:"标准分项",prop:"standardName"},{label:"标准分值",render:function(t,e){var a=e.row;return t("span","0 〜 ".concat(a.standardScore))}},{label:"操作",width:220,fixed:"right",render:function(e,a){var n=a.row,i=a.$index;return t.$hBtns([{label:"编辑",props:{icon:"el-icon-edit"},action:t.onEdit},{label:"删除",props:{icon:"el-icon-delete"},action:t.onDelet},{label:"上移",props:{icon:"el-icon-top",disabled:t.disabled||0===i},action:t.onMove.bind(t,n,i-1,!0)},{label:"下移",props:{icon:"el-icon-bottom",disabled:t.disabled||i===t.tableData.length-1},action:t.onMove.bind(t,n,i+1,!1)}])(e,{row:n})}}]}},props:["programmeId"],created:function(){this.getData()},watch:{programmeId:function(){this.getData()}},methods:{onRefresh:function(){this.$emit("delete"),this.getData()},getData:function(){var t=this;this.loading=!0,this.$post("/quality/inspection/plan/iteam",{programmeId:this.programmeId}).then((function(e){e=e.data,t.scoreTTL=e.scoreTTL;var a=e.params instanceof Array?e.params:[];t.tableData=a.sort((function(t,e){return t.sorting-e.sorting}))})).finally((function(){t.loading=!1}))},onEdit:function(t){var e;if(t)e=t.sorting;else{var n=this.tableData.length;e=0===n?0:+this.tableData[n-1].sorting+1}this.$openModal((function(){return a.e("chunk-2d21ee8c").then(a.bind(null,"d824"))}),{row:t,sorting:e,programmeId:this.programmeId},{success:this.onRefresh})},onMove:function(t,e,a){var n=this;this.disabled=!0;var i=this.tableData[e],o=i.sorting;i.sorting=t.sorting,t.sorting=o,c.a.all([this.$http.post("/quality/inspection/plan/update",Object(l["a"])(Object(l["a"])({},i),{},{programmeId:this.programmeId})),this.$http.post("/quality/inspection/plan/update",Object(l["a"])(Object(l["a"])({},t),{},{programmeId:this.programmeId}))]).then(c.a.spread((function(i,o){a?n.tableData.splice(e+1,1):n.tableData.splice(e-1,1),n.tableData.splice(e,0,t),n.disabled=!1})))},onDelet:function(t){var e=this;this.$confirm("确定要删除".concat(t.standardName,"标准分项？"),"删除").then((function(){e.$http.post("/quality/inspection/plan/delete",{configId:t.configId,programmeId:e.programmeId}).then((function(){e.$message.success("标准分项删除成功"),e.onRefresh()}))}))}}},u=d,m=(a("2b13"),a("2877")),p=Object(m["a"])(u,o,s,!1,null,null,null),h=p.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plan-menu"},[a("div",{staticClass:"action"},[a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.onAddBtn()}}},[t._v("新建方案")])],1),a("el-scrollbar",[t.menu.length?a("ul",{staticClass:"plan-list"},t._l(t.menu,(function(e,n){return a("li",{key:n,staticClass:"plan-list-item",class:{bgc:e.isSelect},on:{click:function(e){return t.onSelect(n)}}},[e.isEdit?a("el-input",{ref:"edit",refInFor:!0,attrs:{placeholder:"请填写方案名称"},on:{blur:function(a){return t.onEdit(e,n)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.target.blur()}},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"item.name"}}):a("div",{staticClass:"plan-name"},[a("div",{staticClass:"name-value"},[t._v(t._s(e.name))]),a("div",{staticClass:"name-action"},[a("i",{staticClass:"el-icon-edit",staticStyle:{"margin-right":"5px"},on:{click:function(e){return t.onEditBtn(n)}}}),a("i",{staticClass:"el-icon-delete",on:{click:function(a){return t.onDelet(e)}}})])])],1)})),0):t._e(),t.planEdit?a("el-input",{ref:"add",attrs:{placeholder:"请填写方案名称"},on:{blur:function(e){return t.onAdd(t.planName)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.target.blur()}},model:{value:t.planName,callback:function(e){t.planName=e},expression:"planName"}}):t._e(),t.menu.length||t.planEdit?t._e():a("div",{staticClass:"empty"},[t._v("请添加质检方案")])],1)],1)},g=[],b=(a("d81d"),a("b0c0"),{data:function(){return{selectData:{},planEdit:!1,planName:"",oldName:"",menu:[],entId:this.$store.state.userData.entid}},created:function(){this.getData()},watch:{selectData:function(t){this.$emit("select-item",t)}},methods:{getData:function(t){var e=this;t=t||0,this.$http("/quality/programme/getAllProgramme",{params:{entId:this.entId}}).then((function(a){a=a.data;var n=a.params instanceof Array?a.params:[];e.menu=n.map((function(a,n){return a.isEdit=!1,a.isSelect=!1,n===t&&(a.isSelect=!0,e.selectData=a),a}))}))},onSelect:function(t){var e=this;this.menu=this.menu.map((function(a,n){return n===t?(a.isSelect=!0,e.selectData=a):a.isSelect=!1,a}))},onEditBtn:function(t){var e=this;this.menu[t].isEdit=!0,this.oldName=this.menu[t].name,this.$nextTick((function(){e.$refs.edit[0].focus()}))},onEdit:function(t,e){var a=this;t.name?(t.name!==this.oldName&&this.$http.post("quality/programme/updateProgramme",{name:t.name,id:t.id,companyId:t.companyId,entId:this.entId}).then((function(){a.$message.success("编辑方案名称成功"),a.getData(e)})).catch((function(){a.$set(a.menu[e],"name",a.oldName)})),this.menu[e].isEdit=!1):(this.$message.error("质检方案名称不能为空"),this.$refs.edit[e].focus())},onAddBtn:function(){var t=this;this.planName="",this.planEdit=!0,this.$nextTick((function(){t.$refs.add.focus()}))},onAdd:function(t){var e=this;t&&this.$http.post("/quality/programme/createProgramme",{name:t,entId:this.entId}).then((function(){e.$message.success("新增方案名称成功"),e.getData(e.menu.length)})).catch((function(t){e.planName=""})),this.planEdit=!1},onDelet:function(t){var e=this;this.$confirm("删除质检方案后，对应的标准分项、附加分项、质检标签都会被删除！确定要删除".concat(t.name,"么?"),"删除").then((function(){e.$http.post("/quality/programme/deleteProgramme",{companyId:t.companyId,id:t.id,entId:e.entId}).then((function(){e.$message.success("方案删除成功"),e.getData()}))}))}}}),v=b,y=(a("1004"),Object(m["a"])(v,f,g,!1,null,"33dd6732",null)),D=y.exports,I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"additional-item"},[a("div",{staticClass:"additional-title"},[t._v("附加质检项")]),a("ui-table-view",{attrs:{hidePager:"",columns:t.columns,data:t.tableData,loading:t.loading,"empty-text":"暂无附加质检项数据"}}),a("div",{staticClass:"additional-bottom"},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.onEdit(null,"1")}}},[t._v("添加加分项")]),a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",icon:"el-icon-minus"},on:{click:function(e){return t.onEdit(null,"2")}}},[t._v("添加减分项")])],1)],1)},$=[],_=(a("99af"),{data:function(){var t=this;return{tableData:[],loading:!1,disabled:!1,columns:[{label:"序号",type:"index"},{label:"附加分项",prop:"name"},{label:"附加分值",render:function(t,e){var a=e.row;return t("span","".concat(1===+a.scoreType?"+":"-","(0 〜 ").concat(a.score,")"))}},{label:"操作",width:220,fixed:"right",render:function(e,a){var n=a.row,i=a.$index;return t.$hBtns([{label:"编辑",props:{icon:"el-icon-edit"},action:t.onEdit},{label:"删除",props:{icon:"el-icon-delete"},action:t.onDelet},{label:"上移",props:{icon:"el-icon-top",disabled:t.disabled||0===i},action:t.onMove.bind(t,n,i-1,!0)},{label:"下移",props:{icon:"el-icon-bottom",disabled:t.disabled||i===t.tableData.length-1},action:t.onMove.bind(t,n,i+1,!1)}])(e,{row:n})}}]}},props:["programmeId"],created:function(){this.getData()},watch:{programmeId:function(){this.getData()}},methods:{onRefresh:function(){this.$emit("delete"),this.getData()},onFormat:function(t){var e=1===+t.scoreType?"+":"-";return e+"(0 〜 "+t.score+")"},getData:function(){var t=this;this.loading=!0,this.$post("/quality/addition/plan/getAdditions",{programmeId:this.programmeId}).then((function(e){e=e.data;var a=e.params instanceof Array?e.params:[];t.tableData=a.sort((function(t,e){return t.sorting-e.sorting}))})).finally((function(){t.loading=!1}))},onEdit:function(t,e){var n;if(t)this.scoreType=t.scoreType,n=t.sorting;else{var i=this.tableData.length;n=0===i?0:+this.tableData[i-1].sorting+1}var o={row:t,programmeId:this.programmeId,sorting:n,scoreType:t?t.sorting:e};this.$openModal((function(){return a.e("chunk-2d0aa776").then(a.bind(null,"10ab"))}),o,{success:this.onRefresh})},onMove:function(t,e,a){var n=this;this.disabled=!0;var i=this.tableData[e],o=i.sorting;i.sorting=t.sorting,t.sorting=o,c.a.all([this.$http.post("/quality/addition/plan/update",Object(l["a"])(Object(l["a"])({},i),{},{programmeId:this.programmeId})),this.$http.post("/quality/addition/plan/update",Object(l["a"])(Object(l["a"])({},t),{},{programmeId:this.programmeId}))]).then(c.a.spread((function(i,o){a?n.tableData.splice(e+1,1):n.tableData.splice(e-1,1),n.tableData.splice(e,0,t),n.disabled=!1})))},onDelet:function(t){var e=this;this.$confirm("确定要删除".concat(t.name,"附加分项？"),"删除").then((function(){e.$http.post("/quality/addition/plan/delete",{configId:t.configId,programmeId:e.programmeId}).then((function(){e.$message.success("附加分项删除成功"),e.onRefresh()}))}))}}}),C=_,x=(a("fee8"),Object(m["a"])(C,I,$,!1,null,null,null)),k=x.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fraction-label"},[a("div",{staticClass:"fraction-title"},[t._v(" 分数段标签 "),a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:" 您可以将质检分数分成几个分数段，并为每一个分数段设置一个标签。例如，您可以将0-60分设置为不及格，将60-100分设置为及格。分设置为及格。"}},[a("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),a("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"标准分值或附加分值发生变化时，原来的分数段标签将被删除!",type:"warning",closable:!1}}),a("ui-table-view",{attrs:{columns:t.columns,data:t.tableData,loading:t.loading,"empty-text":"暂无分数段标签数据"}}),t.tableData.length?t._e():a("div",{staticClass:"fraction-bottom"},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.onEdit()}}},[t._v("新建")])],1)],1)},E=[],S=(a("159b"),{props:["programmeId"],data:function(){return{tableData:[],FractionTTL:"",list:[],loading:!1,columns:[{label:"分数段标签内容",minWidth:240,showOverflowTooltip:!1,render:function(t,e){var a=e.row;return t("div",{domProps:{innerHTML:a.des}})}},{label:"操作",width:120,fixed:"right",render:this.$hBtns([{label:"编辑",props:{icon:"el-icon-edit"},action:this.onEdit},{label:"删除",props:{icon:"el-icon-delete"},action:this.onDelet}])}]}},created:function(){this.getData()},watch:{programmeId:function(){this.getData()}},methods:{getData:function(){var t=this;this.tableData=[],this.$post("/quality/fraction/label/getFraction",{programmeId:this.programmeId}).then((function(e){if(e=e.data,t.FractionTTL=e.FractionTTL,t.FractionTTL>0){t.list=e.params.sort((function(t,e){return t.sortFlag-e.sortFlag}));var a="";t.list.forEach((function(t){a+=" 当 ".concat(t.minScore," ≤ 分数 ＜ ").concat(t.maxScore,"时，为 ").concat(t.tagName,"<br/>")})),t.tableData=[{des:a}]}})).finally((function(){t.loading=!1}))},onEdit:function(t){var e=this;this.$post("/quality/fraction/label/getScore",{programmeId:this.programmeId}).then((function(n){n=n.data;var i=n.minScore,o=n.maxScore;if(i===o)e.$message.warning("请先添加至少一项标准分或附加分，再设置分数段标签");else{var s={row:t,minScore:i,maxScore:o,programmeId:e.programmeId};e.$openModal((function(){return a.e("chunk-a7b5c020").then(a.bind(null,"9602"))}),s,{success:e.getData})}}))},onDelet:function(){var t=this;this.$confirm("确定要删除分数段标签？","删除").then((function(){t.$post("/quality/fraction/label/deleteFraction",{programmeId:t.programmeId}).then((function(){t.$message.success("分数段标签删除成功"),t.tableData=[]}))}))},onClear:function(){var t=this;this.tableData.length&&this.$post("/quality/fraction/label/deleteFraction",{programmeId:this.programmeId}).then((function(){t.tableData=[]}))}}}),T=S,q=(a("3fcf"),Object(m["a"])(T,w,E,!1,null,null,null)),N=q.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"labe"},[a("div",{staticClass:"labe-title -title"},[t._v("质检标签")]),a("div",{staticClass:"tip"},[t._v("*质检标签用于对质检会话进行标记")]),a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标签名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onAdd.apply(null,arguments)}},model:{value:t.labeName,callback:function(e){t.labeName=e},expression:"labeName"}},[a("span",{attrs:{slot:"append"},on:{click:t.onAdd},slot:"append"},[t._v("添加")])]),a("div",{staticClass:"laberList"},[t._l(t.labeList,(function(e,n){return a("el-tag",{key:n,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.onDelet(e)}}},[t._v(t._s(e.name))])})),t.labeList.length?t._e():a("div",{staticClass:"empty"},[t._v("暂无标签")])],2)],1)},L=[],A={data:function(){return{labeList:[],entId:this.$store.state.userData.entid,labeName:""}},props:["programmeId"],created:function(){this.getData()},watch:{programmeId:function(){this.getData()}},methods:{getData:function(){var t=this;this.$post("/quality/scheme/label/getLabel",{programmeId:this.programmeId}).then((function(e){e=e.data,t.labeList=e.params instanceof Array?e.params:[]}))},onDelet:function(t){var e=this;this.$confirm("确定要删除".concat(t.name,"质检标签?"),"删除").then((function(){e.$http.post("/quality/scheme/label/delete",{labelId:t.labelId,programmeId:e.programmeId}).then((function(){e.$message.success("删除成功"),e.getData()}))}))},onAdd:function(){var t=this,e=this.labeName;e&&this.$http.post("/quality/scheme/label/saveSchemeLabel",{name:this.labeName,programmeId:this.programmeId,entId:this.entId}).then((function(){t.$message.success("保存成功"),t.labeName="",t.getData()}))}}},j=A,F=(a("09cd"),Object(m["a"])(j,O,L,!1,null,"1ec02d86",null)),M=F.exports,P={name:"QualityArtificialSqPlan",components:{ComInspection:h,ComPlanMenu:D,ComAdditional:k,ComFraction:N,ComLabe:M},data:function(){return{selectData:{}}},methods:{onSelectData:function(t){this.selectData=t},onDelet:function(){this.$refs.fraction.onClear()}}},B=P,R=(a("59f0"),Object(m["a"])(B,n,i,!1,null,"c4545e3a",null));e["default"]=R.exports},e2e8:function(t,e,a){},f645:function(t,e,a){},fee8:function(t,e,a){"use strict";a("e2e8")}}]);