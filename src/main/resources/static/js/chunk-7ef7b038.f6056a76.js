(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ef7b038"],{1857:function(e,t,u){"use strict";u("c91e")},bb1b:function(e,t,u){"use strict";u.r(t);var i=function(){var e=this,t=e.$createElement,u=e._self._c||t;return u("ui-modal",e._g(e._b({},"ui-modal",e.modalProps,!1),e.$listeners),[u("el-form",{ref:"Form",attrs:{"label-width":"8em",model:e.form,rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[u("el-form-item",{attrs:{label:"默认归属队列",prop:"defaultQueueId"}},[u("el-radio-group",{on:{change:e.radioChange},model:{value:e.form.defaultQueueId,callback:function(t){e.$set(e.form,"defaultQueueId",t)},expression:"form.defaultQueueId"}},e._l(e.queueRadioData,(function(t){return u("el-radio",{key:t.queueId,attrs:{label:t.queueId}},[e._v(e._s(t.queueName))])})),1)],1),e.form.defaultQueueId?u("ui-select",{attrs:{label:"优先级","select-style":"width:80px"},on:{change:e.leveNumChange},model:{value:e.workLeveNum,callback:function(t){e.workLeveNum=t},expression:"workLeveNum"}},e._l(e.levelList,(function(e){return u("el-option",{key:e,attrs:{value:e,label:e}})})),1):e._e(),u("div",{staticStyle:{padding:"20px 10px"}},[u("div",{staticClass:"flex-fr-hb-vs"},[u("el-input",{staticStyle:{width:"200px"},attrs:{type:"text",size:"small",placeholder:"请输入查询关键词"},model:{value:e.permissionDescr,callback:function(t){e.permissionDescr=t},expression:"permissionDescr"}},[u("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1),u("div",{staticClass:"actions"},[u("el-button",{attrs:{size:"small"},on:{click:e.selectQueueAll}},[e._v("全选")]),u("el-button",{attrs:{size:"small"},on:{click:e.resetQueueAll}},[e._v("重置")])],1)],1),u("el-divider"),u("div",{staticStyle:{"margin-top":"10px"}},e._l(e.seachQueueList,(function(t,i){return u("el-tag",{key:t.queueId,class:["tag",{bg:t.selected}],on:{click:function(u){return e.selectQueue(t.queueId,i)}}},[e._v(e._s(t.queueName))])})),1)],1)],1)],1)},a=[],s=u("5530"),r=u("2909"),o=u("1da1"),n=(u("96cf"),u("d3b7"),u("159b"),u("4de4"),u("e9c4"),u("d81d"),u("c740"),u("a434"),u("7db0"),u("a02a")),l={props:["row","queueAllData"],data:function(){var e=this;return{form:{},rules:{defaultQueueId:Object(n["z"])("默认技能队列不能为空")},permissionDescr:"",levelList:[0,1,2,3,4,5],queueRadioData:[],queueListData:[],workLeveNum:0,modalProps:{title:"归属队列修改",width:"520px",onSubmit:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:return e.queueRadioData.forEach((function(t){e.form.queueIds.push(t.queueId),e.form.workLevel[t.queueId]=t.workLevel})),t.next=5,e.$http.post("/cti/work/queue",e.form);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));function u(){return t.apply(this,arguments)}return u}()}}},computed:{seachQueueList:function(){var e=this;return this.permissionDescr?this.queueListData.filter((function(t){return t.queueName.indexOf(e.permissionDescr)>-1})):Object(r["a"])(this.queueListData)}},mounted:function(){this.form={ctiWorkId:this.row.ctiWorkId,workNo:this.row.workNo,entId:this.row.entId,defaultQueueId:this.row.queueId,defaultQueueName:this.row.defaultQueueName,queueIds:[],workLevel:{}},this.defaultRowId=this.row.queueId,this.getServiceQueue({workNo:this.form.workNo,entId:this.form.entId},JSON.parse(JSON.stringify(this.queueAllData)))},methods:{leveNumChange:function(e){var t=this;this.queueRadioData=this.queueRadioData.map((function(u){return u.queueId===t.form.defaultQueueId&&(u.workLevel=e),u}))},selectQueueAll:function(){var e=this;this.seachQueueList.forEach((function(t){if(!t.selected){t.selected=!0,e.queueRadioData.push(t);var u=e.queueRadioData.findIndex((function(e){return e.queueId===t.queueId}));e.$set(e.queueRadioData[u],"selected",!0)}}))},resetQueueAll:function(){this.form.defaultQueueId=this.defaultRowId;var e=JSON.parse(JSON.stringify(this.queueAllData));this.getServiceQueue({workNo:this.form.workNo,entId:this.form.entId},Object(r["a"])(e))},selectQueue:function(e,t){if(this.queueListData[t].selected){this.$set(this.queueListData[t],"selected",!1);var u=this.queueRadioData.findIndex((function(t){return t.queueId===e}));this.$set(this.queueListData[t],"workLevel",this.queueRadioData[u].workLevel),this.queueRadioData.splice(u,1),this.form.defaultQueueId===e&&(this.form.defaultQueueId="")}else this.$set(this.queueListData[t],"selected",!0),this.queueRadioData.push(Object(s["a"])({workLevel:0},this.queueListData[t]))},getServiceQueue:function(e,t){var u=this;this.$post("/cti/work/workqueue",e).then((function(e){var i=e.data;u.setQueueListData(t,i)}))},setQueueListData:function(e,t){for(var u=0;u<t.length;u++){t[u].queueId===this.defaultRowId&&(this.workLeveNum=+t[u].workLevel);for(var i=0;i<e.length;i++)t[u].queueId===e[i].queueId&&(this.$set(e[i],"selected",!0),this.$set(e[i],"workLevel",+t[u].workLevel||0),this.$set(t[u],"queueName",e[i].queueName))}this.queueRadioData=Object(r["a"])(t),this.queueListData=Object(r["a"])(e),console.log(666,this.queueRadioData,this.queueListData)},radioChange:function(e){this.workLeveNum=+this.queueRadioData.find((function(t){return t.queueId===e})).workLevel}}},d=l,c=(u("1857"),u("2877")),f=Object(c["a"])(d,i,a,!1,null,"38e724e5",null);t["default"]=f.exports},c740:function(e,t,u){"use strict";var i=u("23e7"),a=u("b727").findIndex,s=u("44d2"),r="findIndex",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),s(r)},c91e:function(e,t,u){}}]);