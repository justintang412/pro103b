(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-719dc621"],{1870:function(e,t,a){"use strict";a("62b5")},3280:function(e,t,a){},3793:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("com-info",{ref:"ComInfo"}),a("main",{staticClass:"main"},[e._m(0),a("ui-table-view",e._g(e._b({},"ui-table-view",e.viewProps,!1),e.viewListeners))],1)],1)},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"header"},[a("span",{staticClass:"title"},[e._v("公司客户")])])}],r=a("5530"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"container"},[a("header",{staticClass:"header"},[a("span",{staticClass:"header-title"},[e._v("公司信息")]),e.readonly?a("el-link",{attrs:{type:"primary",icon:"el-icon-edit",underline:!1},on:{click:e.onEdit}},[e._v("编辑")]):e._e()],1),a("main",{staticClass:"main"},[a("el-scrollbar",{staticClass:"ui-scrollbar"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"Form",attrs:{"label-width":"6em",size:"mini","inline-message":"",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"公司名称",prop:"companyName"}},[e.readonly?a("span",[e._v(e._s(e.detail.companyName))]):a("el-input",{attrs:{maxlength:"50"},model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName",t)},expression:"form.companyName"}})],1),a("el-form-item",{attrs:{label:"所在地区"}},[e.readonly?a("span",[e._v(" "+e._s([e.detail.companyProvince,e.detail.companyCity,e.detail.companyArea].filter((function(e){return e})).join("/"))+" ")]):a("div",{staticClass:"flexbox"},[a("el-select",{attrs:{placeholder:"选择省",clearable:""},on:{change:e.onProvinceChange},model:{value:e.form.companyProvinceCode,callback:function(t){e.$set(e.form,"companyProvinceCode",t)},expression:"form.companyProvinceCode"}},e._l(e.provinces,(function(e){return a("el-option",{key:e.provinceCode,attrs:{value:e.provinceCode,label:e.name}})})),1),a("el-select",{attrs:{placeholder:"选择市",clearable:""},on:{change:e.onCityChange},model:{value:e.form.companyCityCode,callback:function(t){e.$set(e.form,"companyCityCode",t)},expression:"form.companyCityCode"}},e._l(e.cities,(function(e){return a("el-option",{key:e.cityCode,attrs:{value:e.cityCode,label:e.name}})})),1),a("el-select",{attrs:{placeholder:"选择区",clearable:""},on:{change:e.onAreaChange},model:{value:e.form.companyAreaCode,callback:function(t){e.$set(e.form,"companyAreaCode",t)},expression:"form.companyAreaCode"}},e._l(e.areas,(function(e){return a("el-option",{key:e.areaCode,attrs:{value:e.areaCode,label:e.name}})})),1)],1)]),e.readonly?e._l(e.detail.dataJson,(function(t){return a("el-form-item",{key:t.fieldId,attrs:{label:t.fieldName}},[a("com-field",{attrs:{data:t,readonly:e.readonly,value:t.val}})],1)})):e._l(e.form.dataJson,(function(t,n){return a("el-form-item",{key:t.fieldId,attrs:{label:t.fieldName,prop:"dataJson."+n+".val",rules:{trigger:e.hasOptions(t.fieldType)?null:"blur",required:1===t.requireWrite,message:"该项不能为空"}}},[a("com-field",{attrs:{data:t},model:{value:t.val,callback:function(a){e.$set(t,"val",a)},expression:"_.val"}})],1)})),e.readonly?e._e():a("el-form-item",[a("el-button",{on:{click:e.onCancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],2)],1)],1)])},c=[],l=a("ade3"),s=a("1da1"),d=(a("96cf"),a("e9c4"),a("d3b7"),a("b0c0"),a("7db0"),a("d81d"),a("4de4"),a("ac1f"),a("1276"),a("e139")),u=a("8c45"),m=a("a02a"),p=function(e){return JSON.parse(JSON.stringify(e))},f={components:{ComField:u["a"]},data:function(){return{hasOptions:d["c"],readonly:!0,form:{dataJson:[]},detail:{},rules:{companyName:Object(m["y"])("请输入公司名称")},provinces:[],cities:[],areas:[],loading:!1}},methods:{onCancel:function(){var e=this;this.readonly=!0,this.$nextTick((function(){e.$refs.Form.clearValidate()}))},getInitData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http("/ccas/cc/company/details/by/".concat(e));case 2:n=a.sent,o=n.data,t.form=Object(r["a"])(Object(r["a"])({},o),{},{dataJson:[]}),t.detail=p(t.form),t.onCancel(),o.companyProvinceCode&&t.getCities(o.companyProvinceCode),o.companyCityCode&&t.getAreas(o.companyCityCode),t.getFields().then((function(e){t.form=Object(r["a"])(Object(r["a"])({},t.form),{},{dataJson:e}),t.detail=p(t.form)})),t.getProvinces();case 11:case"end":return a.stop()}}),a)})))()},onEdit:function(){this.readonly=!1,this.form=p(this.detail)},onSubmit:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:return a=function(e){return e.val instanceof Array?e.val+"":e.val||""},e.loading=!0,t.prev=4,t.next=7,e.$post("/ccas/cc/company/save",Object(r["a"])(Object(r["a"])({},e.form),{},{dataJson:JSON.stringify(e.form.dataJson.reduce((function(e,t){return Object(r["a"])(Object(r["a"])({},e),{},Object(l["a"])({},t.dataColName,a(t)))}),{}))}));case 7:e.detail=p(e.form),e.$message.success("提交成功"),e.readonly=!0,t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](4);case 14:e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[4,12]])})))()},getProvinces:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/cc/region/province/list");case 2:e.provinces=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},getCities:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=6;break}return a.next=3,t.$http("/ccas/cc/region/city/list/by/".concat(e));case 3:a.t0=a.sent.data,a.next=7;break;case 6:a.t0=[];case 7:t.cities=a.t0;case 8:case"end":return a.stop()}}),a)})))()},getAreas:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=6;break}return a.next=3,t.$http("/ccas/cc/region/area/list/by/".concat(e));case 3:a.t0=a.sent.data,a.next=7;break;case 6:a.t0=[];case 7:t.areas=a.t0;case 8:case"end":return a.stop()}}),a)})))()},onProvinceChange:function(e){this.form=Object(r["a"])(Object(r["a"])({},this.form),{},{companyCityCode:void 0,companyAreaCode:void 0,companyArea:void 0,companyCity:void 0,companyProvince:e&&this.provinces.find((function(t){return t.provinceCode===e})).name}),this.areas=[],this.getCities(e)},onCityChange:function(e){this.form=Object(r["a"])(Object(r["a"])({},this.form),{},{companyAreaCode:void 0,companyArea:void 0,companyCity:e&&this.cities.find((function(t){return t.cityCode===e})).name}),this.getAreas(e)},onAreaChange:function(e){this.form=Object(r["a"])(Object(r["a"])({},this.form),{},{companyArea:e&&this.areas.find((function(t){return t.areaCode===e})).name})},getFields:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/cc/field/list",{params:{businessType:2}});case 2:return a=t.sent,n=a.data,t.abrupt("return",n.filter((function(e){return!e.predefinedType})).map((function(t){var a=e.form[t.dataColName];return[7,9].indexOf(t.fieldType)>-1&&(a=a?a.split(",").filter((function(e){return e})):[]),Object(r["a"])(Object(r["a"])({},t),{},{val:a})})));case 5:case"end":return t.stop()}}),t)})))()}}},v=f,b=(a("1870"),a("2877")),y=Object(b["a"])(v,i,c,!1,null,"372640d6",null),h=y.exports,C=a("de0b"),g={name:"CustomerCenterCompanyDetail",mixins:[window.mixTableView],components:{ComInfo:h},data:function(){return{columns:[{label:"客户昵称",prop:"customerNickname"},{label:"真实姓名",prop:"customerName"},{label:"电话",prop:"phone",minWidth:120},{label:"邮箱",prop:"email",minWidth:120},{label:"创建日期",prop:"createTime",minWidth:140},{label:"操作",width:100,fixed:"right",render:this.$hBtns([{label:"详情",action:this.onView},{label:"删除",action:this.onDelete}])}]}},computed:{id:function(){return this.$route.params.id}},mounted:function(){var e=this,t=function(){e._id&&e._id!==e.id?e.onReset():e.getData(),e.$nextTick((function(){e.$refs.ComInfo.getInitData(e.id)}))};t(),Object(m["g"])(this,t)},methods:{fetchMethod:function(e){return this.$http("/ccas/cc/customer/list",{params:Object(r["a"])(Object(r["a"])({},e),{},{companyId:this.id})}).then((function(e){var t=e.data;return t}))},onView:function(e){this.$router.push({name:"".concat(C["d"],"-detail"),params:{id:e.customerId}})},onDelete:function(e){var t=this;this.delData({desc:"确认删除 ".concat(e.customerNickname," 客户的资料？该客户资料删除后无法恢复"),action:function(){return t.$http.delete("/ccas/cc/customer/del",{params:{customerIds:e.customerId}})}})}}},O=g,_=(a("c9cb"),Object(b["a"])(O,n,o,!1,null,"409b8d67",null));t["default"]=_.exports},"62b5":function(e,t,a){},"8c45":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{label:e.data.fieldName}},[e.data.fieldType===e.T.INPUT?[e.readonly?a("span",[e._v(e._s(e.model))]):a("el-input",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e.data.fieldType===e.T.TEXTAREA?[e.readonly?a("span",[e._v(e._s(e.model))]):a("el-input",{attrs:{type:"textarea"},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e.data.fieldType===e.T.DATE?[e.readonly?a("span",[e._v(e._s(e.$adminCore.formatDate(+e.model,"yyyy-MM-dd")))]):a("el-date-picker",{attrs:{"value-format":"timestamp"},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e.data.fieldType===e.T.TIME?[e.readonly?a("span",[e._v(e._s(e.model))]):a("el-time-picker",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e.data.fieldType===e.T.NUM_INPUT?[e.readonly?a("span",[e._v(e._s(e.model))]):a("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e.data.fieldType===e.T.SELECT?[e.readonly?a("span",[e._v(e._s(e.getText(e.model)))]):a("el-select",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},e._l(e.options,(function(e){return a("el-option",{key:e.optionId,attrs:{value:e.optionId,label:e.value}})})),1)]:e.data.fieldType===e.T.CASCADER?[a("el-cascader",{class:{readonly:e.readonly},attrs:{disabled:e.readonly,options:e.options},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]:e.data.fieldType===e.T.RADIO?[e.readonly?a("span",[e._v(e._s(e.getText(e.model)))]):a("el-radio-group",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},e._l(e.options,(function(t){return a("el-radio",{key:t.optionId,attrs:{label:t.optionId}},[e._v(e._s(t.value))])})),1)]:e.data.fieldType===e.T.CHECKBOX?[e.readonly?a("span",[e._v(e._s(e.getText(e.model)))]):a("el-checkbox-group",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},e._l(e.options,(function(t){return a("el-checkbox",{key:t.optionId,attrs:{label:t.optionId}},[e._v(e._s(t.value))])})),1)]:e._e()],2)},o=[],r=a("ade3"),i=a("5530"),c=(a("d81d"),a("d3b7"),a("a02a")),l=a("e139"),s={data:function(){return{T:l["a"],options:[],model:this.value}},props:{data:{type:Object,default:function(){return{}}},value:{},readonly:Boolean},watch:{value:function(e){this.model=e},model:function(e){this.$emit("input",e)}},mounted:function(){var e=this;Object(l["c"])(this.data.fieldType)&&this.$http("/ccas/cc/field/option/details/".concat(this.data.fieldId)).then((function(t){var a=t.data;e.options=e.data.fieldType===l["a"].CASCADER?Object(c["F"])(a.map((function(e){var t=e.optionId,a=e.value;return Object(i["a"])(Object(i["a"])({},e),{},{value:t,label:a})})),{key:"optionId"}):a}))},methods:{getText:function(e){var t=this.options.reduce((function(e,t){return Object(i["a"])(Object(i["a"])({},e),{},Object(r["a"])({},t.optionId,t.value))}),{});return e instanceof Array?e.map((function(e){return t[e]}))+"":t[e]}}},d=s,u=(a("afc7"),a("2877")),m=Object(u["a"])(d,n,o,!1,null,"338d9c7e",null);t["a"]=m.exports},afc7:function(e,t,a){"use strict";a("3280")},c9cb:function(e,t,a){"use strict";a("e186")},e139:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return d}));var n,o=a("ade3"),r=(a("caad"),a("2532"),{INPUT:1,TEXTAREA:2,DATE:3,TIME:4,NUM_INPUT:5,SELECT:6,CASCADER:7,RADIO:8,CHECKBOX:9}),i=r,c=(n={},Object(o["a"])(n,i.INPUT,"单行文本框"),Object(o["a"])(n,i.TEXTAREA,"多行文本框"),Object(o["a"])(n,i.DATE,"日期"),Object(o["a"])(n,i.TIME,"时间"),Object(o["a"])(n,i.NUM_INPUT,"数值输入框"),Object(o["a"])(n,i.SELECT,"下拉框"),Object(o["a"])(n,i.CASCADER,"级联下拉框"),Object(o["a"])(n,i.RADIO,"单选框"),Object(o["a"])(n,i.CHECKBOX,"复选框"),n),l=function(e){return[i.SELECT,i.CASCADER,i.RADIO,i.CHECKBOX].includes(+e)},s=function(e){return c[e]},d=function(e){return 1===+e.requireWrite}},e186:function(e,t,a){}}]);