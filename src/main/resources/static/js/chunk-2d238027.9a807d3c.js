(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d238027"],{fe0b:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ui-modal",e._g(e._b({},"ui-modal",e.modalProps,!1),e.$listeners),[a("el-form",{ref:"Form",attrs:{"label-width":"6em",model:e.form,rules:e.rules}},[a("ui-text-field",{attrs:{label:"批次名称",prop:"eventName"},model:{value:e.form.eventName,callback:function(t){e.$set(e.form,"eventName",t)},expression:"form.eventName"}}),a("ui-select",{attrs:{label:"优先级",prop:"eventLevel"},model:{value:e.form.eventLevel,callback:function(t){e.$set(e.form,"eventLevel",t)},expression:"form.eventLevel"}},e._l(e.priorities,(function(e,t){return a("el-option",{key:t,attrs:{value:+t,label:e}})})),1),a("ui-select",{attrs:{label:"场景",prop:"eventSceneId",options:e.scenes,props:{value:"sceneId",label:"sceneName"},filterable:""},on:{change:e.onSceneChange},model:{value:e.form.eventSceneId,callback:function(t){e.$set(e.form,"eventSceneId",t)},expression:"form.eventSceneId"}}),a("ui-select",{attrs:{label:"短信模板",options:e.smsTemplates,props:{value:"templateId",label:"templateName"},disabled:"",clearable:"",filterable:""},model:{value:e.form.messageTemplateId,callback:function(t){e.$set(e.form,"messageTemplateId",t)},expression:"form.messageTemplateId"}}),a("el-form-item",{attrs:{label:"任务时效",prop:"validEndTime"}},[a("el-radio-group",{on:{change:e.onExpiredChange},model:{value:e.form.validTimeType,callback:function(t){e.$set(e.form,"validTimeType",t)},expression:"form.validTimeType"}},[a("el-radio",{attrs:{label:1}},[e._v("永久")]),a("el-radio",{attrs:{label:2}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择有效期截至时间","value-format":"timestamp","picker-options":{disabledDate:function(e){return e<Date.now()}}},nativeOn:{click:function(t){return e.onDatePickerClick.apply(null,arguments)}},model:{value:e.form.validEndTime,callback:function(t){e.$set(e.form,"validEndTime",t)},expression:"form.validEndTime"}})],1)],1)],1),a("ui-text-field",{attrs:{label:"备注",type:"textarea",maxlength:"200"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)},r=[],s=a("1da1"),l=a("5530"),i=(a("4de4"),a("d3b7"),a("7db0"),a("96cf"),a("a02a")),o=a("5cdf"),c={props:["row","userData"],data:function(){var e=this,t=this.row;return{rules:{eventName:Object(i["y"])("请输入批次名称"),eventLevel:Object(i["z"])("请选择优先级"),eventSceneId:Object(i["z"])("请选择场景"),validEndTime:{trigger:"blur",validator:function(t,a,n){1===e.form.validTimeType||a?n():n(new Error("请选择有效期截至时间"))}}},form:t?Object(l["a"])(Object(l["a"])({},t),{},{validEndTime:t.validEndTime&&+new Date(t.validEndTime)}):{phoneHideStatus:0,assessStatus:0,validTimeType:1},modalProps:{drawer:!0,isEdit:!!this.row,onSubmit:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:return a=e.form,t.next=5,e.$post("/ccas/call/manual/event/save",a);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));function a(){return t.apply(this,arguments)}return a}()},priorities:o["j"],smsTemplates:[],scenes:[],qnTemplateList:[]}},mounted:function(){this.getScenes(),this.getSmsTemplates()},methods:{getScenes:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http("/ccas/call/manual/event/scene/list?sceneStatus=0");case 2:a=t.sent,n=a.data,e.scenes=n;case 5:case"end":return t.stop()}}),t)})))()},getSmsTemplates:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$post("/message/template/getMessageTemplate",{entId:e.userData.entid});case 2:a=t.sent,n=a.data,e.smsTemplates=n.list.filter((function(e){return"1"===e.templateStatus}));case 5:case"end":return t.stop()}}),t)})))()},onExpiredChange:function(){this.$refs.Form.clearValidate("validEndTime")},onDatePickerClick:function(){this.form.validTimeType=2},onSceneChange:function(e){var t=this,a=this.scenes.find((function(t){return t.sceneId===e}));["sceneName","phoneHideStatus","messageTemplateId"].forEach((function(e){t.$set(t.form,e,a[e])}))}}},m=c,u=a("2877"),d=Object(u["a"])(m,n,r,!1,null,null,null);t["default"]=d.exports}}]);