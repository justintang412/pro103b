(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74d195c1"],{"03e5":function(t,e,a){"use strict";a("25d9")},"218b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ui-modal",t._g(t._b({ref:"Modal"},"ui-modal",t.modalProps,!1),t.$listeners),[a("div",{staticClass:"wrap"},[3!=t.viewsType?a("com-menu",{attrs:{"detail-data":t.detailData,store:t.store},on:{chageDetail:t.onChageDetail}}):t._e(),a("div",{staticClass:"content-center"},[a("com-session-info",{attrs:{"detail-data":t.sessionInfo,store:t.store}}),a("div",{staticClass:"content-tab"},[a("el-tabs",[a("el-tab-pane",{attrs:{label:"全部会话"}},[a("com-session-record",{attrs:{"detail-data":t.detailData,store:t.store}})],1),a("el-tab-pane",{attrs:{label:"关联工单"}},[a("el-scrollbar",[a("com-related-workOrder",{attrs:{"detail-data":t.detailData},on:{"on-view-workorder-detail":t.onViewWorkorderDetail}})],1)],1)],1)],1)],1),a("div",{staticClass:"content-right"},[a("el-tabs",[a("el-tab-pane",{attrs:{label:"质检"}},[1==t.viewsType?a("com-quality",{attrs:{"detail-data":t.detailData,store:t.store}}):t._e(),2==t.viewsType||3==t.viewsType?a("com-quality-result",{attrs:{"detail-data":t.detailData,store:t.store}}):t._e()],1),a("el-tab-pane",{attrs:{label:"满意度"}},[a("el-scrollbar",[a("com-satisfaction",{attrs:{store:t.store,"detail-data":t.detailData}})],1)],1),t.$hasPerm("service_summary_view")?a("el-tab-pane",{attrs:{label:"服务总结"}},[a("el-scrollbar",[a("com-service-summary",{attrs:{"detail-data":t.detailData}})],1)],1):t._e(),a("el-tab-pane",{attrs:{label:"客户信息"}},[a("el-scrollbar",[a("com-customer-data",{attrs:{"customer-data":t.detailData}})],1)],1)],1)],1)],1)])},s=[],n=a("5530"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"menu"},[a("el-scrollbar",[a("ul",{staticClass:"list"},t._l(t.list,(function(e,i){return a("li",{key:i,class:[{bgc:e.conId==t.selectDetailData.conId},"list-item"],on:{click:function(a){return t.onSlecte(e)}}},[a("div",{staticClass:"date"},[a("i",{staticClass:"el-icon-time"}),a("span",{staticStyle:{"margin-left":"5px","margin-right":"50px"}},[t._v(t._s(e.speakTime.split(" ")[0]))]),a("span",[t._v(t._s(e.speakTime.split(" ")[1]))])]),a("div",{staticClass:"time"},[t._v(t._s(t.$adminCore.formatDate(+new Date(2e3,1,1)+ +e.conDuration,"HH:mm:ss")))]),a("div",{staticClass:"bottom"},[a("i",{staticClass:"el-icon-user"}),t._v(t._s(e.customerCount)+" "),a("el-divider",{attrs:{direction:"vertical"}}),a("i",{staticClass:"el-icon-service"}),t._v(t._s(e.agentCount)+" "),a("el-divider",{attrs:{direction:"vertical"}})],1)])})),0)])],1)},o=[],l=(a("4de4"),a("d3b7"),{props:["detailData","store"],data:function(){return{selectDetailData:this.detailData,list:[],userData:this.store.state.userData}},computed:{permit:function(){return this.store.state.permissions.indexOf("quality_session_appeal_review")>-1||this.store.getters.isAdmin?"1":"2"}},created:function(){this.getSession()},methods:{getSession:function(){var t=this;this.$http.post("/quality/conversation/getConversationByCustomerId",{customerId:this.detailData.customerId,entId:this.detailData.entId,seatId:this.detailData.seatId,permit:this.permit}).then((function(e){var a=e.data;t.list=1===+t.permit?a.filter((function(e){return!(t.userData.workNo===e.seatId&&1===+e.qualityStatus)})):a}))},onSlecte:function(t){this.selectDetailData=Object(n["a"])({},t),this.$emit("chageDetail",Object(n["a"])(Object(n["a"])({},this.selectDetailData),{},{id:this.selectDetailData.conId}))}}}),c=l,d=(a("03e5"),a("2877")),u=Object(d["a"])(c,r,o,!1,null,"5351fb8d",null),m=u.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quality-list"},[a("el-scrollbar",[a("el-form",{ref:"form",staticStyle:{"margin-right":"10px"},attrs:{model:t.form,"label-width":"10em","label-position":"left"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("ui-text-field",{attrs:{label:"被质检客服",disabled:""},model:{value:t.detailData.seatName,callback:function(e){t.$set(t.detailData,"seatName",e)},expression:"detailData.seatName"}}),a("ui-select",{attrs:{label:"质检方案",filterable:"",disabled:!t.isEdit&&t.permit},model:{value:t.programmeId,callback:function(e){t.programmeId=e},expression:"programmeId"}},t._l(t.options,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.companyId}})})),1),t.programmeId?a("div",[t.isEdit&&t.permit?a("div",[a("div",{staticClass:"sub-title"},[t._v("标准分")]),t._l(t.templateData.InspectionList,(function(e){return a("el-form-item",{key:e.id,attrs:{label:e.standard_name}},[a("el-input-number",{attrs:{disabled:!t.isEdit,placeholder:"0~"+e.standard_score,controls:!1,min:0,max:+e.standard_score},model:{value:e.score,callback:function(a){t.$set(e,"score",a)},expression:"item.score"}}),a("span",{staticClass:"units"},[t._v("分")])],1)})),a("div",{staticClass:"sub-title"},[t._v("附加分")]),t._l(t.templateData.AdditionList,(function(e,i){return a("el-form-item",{key:i,attrs:{label:e.additional_name}},[a("i",{class:1==e.score_type?"el-icon-plus":"el-icon-minus"}),a("el-input-number",{attrs:{controls:!1,min:0,max:+e.additional_score,placeholder:"0~"+e.additional_score},model:{value:e.score,callback:function(a){t.$set(e,"score",a)},expression:"item.score"}}),a("span",{staticClass:"units"},[t._v("分")])],1)})),a("div",{staticClass:"flex-box"},[a("div",{staticClass:"sub-title"},[t._v("总分")]),a("div",{staticClass:"sub-title"},[t._v(t._s(t.total)+"分")])]),a("div",{staticClass:"flex-box"},[a("div",{staticClass:"sub-title"},[t._v("质检标签")]),t.isLaberEdit?t._e():a("el-button",{attrs:{type:"text"},on:{click:function(e){t.isLaberEdit=!t.isLaberEdit}}},[t._v("完成")]),t.isLaberEdit?a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){t.isLaberEdit=!t.isLaberEdit}}},[t._v("添加")]):t._e()],1),t.isLaberEdit?t._e():a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标签名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onAdd.apply(null,arguments)}},model:{value:t.labeName,callback:function(e){t.labeName=e},expression:"labeName"}},[a("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"append"},on:{click:t.onAdd},slot:"append"},[t._v("添加")])]),a("div",{staticClass:"laberList"},t._l(t.labeList,(function(e,i){return a("el-tag",{key:i,class:["tag",{bg:t.slecteTagsName.indexOf(e.name)>-1&&t.isLaberEdit}],attrs:{closable:!t.isLaberEdit},on:{click:function(a){return t.slecteTag(e.name)},close:function(a){return t.onDelet(e)}}},[t._v(t._s(e.name))])})),1),a("div",{staticClass:"sub-title"},[t._v("质检评语")]),a("el-input",{attrs:{type:"textarea",placeholder:"请填入文字评价，包括意见，建议等，最多500字符",maxlength:"500","show-word-limit":""},model:{value:t.form.message,callback:function(e){t.$set(t.form,"message",e)},expression:"form.message"}})],2):a("div",[a("div",{staticClass:"row weight"},[a("span",[t._v("总分：")]),t._v(" "),a("span",[t._v(t._s(t.qualityResults.totalScore)+"分")])]),a("div",{staticClass:"sub-title"},[t._v("标准分")]),t._l(t.qualityResults.InspectionList,(function(e,i){return a("div",{key:i,staticClass:"row"},[a("span",[t._v(t._s(e.names)+"：")]),a("span",[t._v(t._s(e.nums)+"分")])])})),a("div",{staticClass:"sub-title"},[t._v("附加分")]),t._l(t.qualityResults.AdditionList,(function(e){return a("div",{key:e.names,staticClass:"row"},[a("span",[t._v(t._s(e.names)+"：")]),a("span",[t._v(t._s(e.nums)+"分")])])})),a("div",{staticClass:"laberList"},[a("h4",[t._v("质检标签")]),t._l(t.slecteTagsName,(function(e,i){return a("el-tag",{key:i,staticClass:"tag bg"},[t._v(" "+t._s(e)+" ")])}))],2),a("div",{staticClass:"sub-title"},[t._v("质检评语")]),a("div",{staticClass:"row"},[t._v(t._s(t.qualityResults.message))]),a("div",{staticClass:"row"},[a("span",[t._v("最后质检人：")]),t._v(" "),a("span",[t._v(t._s(t.qualityResults.qualityPersionName))])]),a("div",{staticClass:"row"},[a("span",[t._v("质检时间：")]),a("span",[t._v(t._s(t.qualityResults.updateTime))])]),t.appealMessage||!t.appeal?a("div",{staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"sub-title"},[t._v("申诉理由")]),a("el-input",{attrs:{type:"textarea",placeholder:"请填入申诉理由等",disabled:t.appeal},model:{value:t.appealMessage,callback:function(e){t.appealMessage=e},expression:"appealMessage"}})],1):t._e(),t.detailData.rejectReason?a("div",[a("div",{staticClass:"sub-title"},[t._v("驳回理由")]),a("div",{staticClass:"row"},[t._v(t._s(t.detailData.rejectReason))])]):t._e()],2)]):t._e()],1)],1),t.programmeId?a("div",{staticClass:"footer"},[t.permit?a("div",[t.isEdit?a("div",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.onSubmit(t.form)}}},[t._v("保存")]),a("el-button",{on:{click:t.onCance}},[t._v("取消")])],1):a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onEdit()}}},[t._v("重检")])],1):a("div",[t.appeal&&1!=t.detailData.appealType&&4!=t.detailData.appealType?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.toBottom()}}},[t._v("申诉")]):t._e(),t.appeal?t._e():a("div",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.onAppeal()}}},[t._v("保存")]),a("el-button",{on:{click:function(e){t.appeal=!0}}},[t._v("取消")])],1)],1)]):t._e()],1)},f=[],h=(a("159b"),a("a434"),a("d81d"),a("25f0"),a("a15b"),a("4e82"),a("ac1f"),a("1276"),a("b0c0"),{props:["detailData","store"],data:function(){return{loading:!1,templateData:{InspectionList:[],AdditionList:[]},options:this.detailData.options,programmeId:"",labeList:[],userData:this.store.state.userData,labeName:"",isLaberEdit:!0,appeal:!0,isEdit:!1,qualityStatus:this.detailData.qualityStatus,qualityResults:{},appealMessage:"",slecteTagsName:[],form:{list:[],list2:[]}}},computed:{total:function(){var t=0;return this.templateData.InspectionList.forEach((function(e){t=+e.score+t})),this.templateData.AdditionList.forEach((function(e){var a=e.score||0;t=1===+e.score_type?+a+t:+t-a})),t},permit:function(){return(this.store.state.permissions.indexOf("quality_session_appeal_review")>-1||this.store.getters.isAdmin)&&this.userData.workNo!==this.detailData.seatId}},watch:{programmeId:{handler:function(t){t&&this.isEdit&&(this.getData(),this.getTemplateData())}},isEdit:{handler:function(t){t||(this.onGetScore(),this.getData())}},detailData:{deep:!0,immediate:!0,handler:function(t){this.appealMessage=t.appealReason,this.programmeId=t.seachProgrammeId,this.qualityStatus=t.qualityStatus,this.isEdit=2!==+t.qualityStatus,this.isEdit||(this.programmeId=t.programmeId,this.onGetScore(),this.getData())}}},methods:{onCance:function(){1===+this.qualityStatus?this.programmeId="":this.isEdit=!1},toBottom:function(){this.appeal=!1;var t=this.$el.querySelector(".el-scrollbar__wrap");this.$nextTick((function(){t.scrollTop=t.scrollHeight}))},slecteTag:function(t){if(this.isLaberEdit){var e=this.slecteTagsName.indexOf(t);e>-1?this.slecteTagsName.splice(e,1):this.slecteTagsName.push(t)}},onAppeal:function(){var t=this;if(this.appealMessage){var e={programmeId:this.detailData.programmeId,message:this.appealMessage,entId:this.userData.entid,conversationId:this.detailData.conId,seatId:this.detailData.seatId,seatName:this.detailData.seatName,totalScore:this.qualityResults.totalScore,customerId:this.detailData.customerId,customerName:this.detailData.customerName};delete e.options,this.loading=!0,this.$http.post("/quality/apply/launchReexamination",e).then((function(){t.$message.success("申诉成功"),t.appeal=!0,t.$router.back()})).finally((function(){t.loading=!1}))}else this.$message.error("申述理由不能为空")},onEdit:function(){this.isEdit=!0,this.slecteTagsName=[],this.getTemplateData(),this.getData()},onSubmit:function(t){var e=this;t.list=this.templateData.InspectionList.map((function(t){var e={};return e.names=t.standard_name,e.nums=t.score.toString()||"0",e})),t.list2=this.templateData.AdditionList.map((function(t){var e={},a=1===+t.score_type?"":"-";return e.names=t.additional_name.toString(),e.nums=(t.score?a+t.score:"0").toString(),e})),t=Object(n["a"])(Object(n["a"])(Object(n["a"])({},this.detailData),this.form),{},{conversationId:this.detailData.conId,entId:this.userData.entid,qualityPersionId:this.userData.userId,qualityPersionName:this.userData.username,programmeId:this.programmeId,standTotal:this.total.toString(),tagName:this.slecteTagsName.join(",")}),delete this.form.options,this.loading=!0,this.$http.post("/quality/conversation/saveScore",t).then((function(){e.isEdit=!1,e.qualityStatus=2,e.$message.success("保存成功")})).finally((function(){e.loading=!1}))},onGetScore:function(){var t=this;this.$http.post("/quality/conversation/getScore",{conversationId:this.detailData.conId,entId:this.userData.entid,programmeId:this.programmeId}).then((function(e){var a=e.data;a=a.sort((function(t,e){return e.version-t.version})),t.qualityResults=a[0],t.slecteTagsName=t.qualityResults.tagName?t.qualityResults.tagName.split(","):[]}))},getTemplateData:function(){var t=this;this.$post("/quality/conversation/getProgramme",{programId:this.programmeId,entId:this.userData.entid}).then((function(e){var a=e.data;a.InspectionList.length&&a.AdditionList.length?(t.form.list=a.InspectionList.map((function(t){return t.score=t.standard_score,t})),t.templateData=a):(t.programmeId="",t.$message.warning("质检方案内容为空，请重新选择质检方案"))})).catch((function(e){t.programmeId=""}))},getData:function(){var t=this;this.$post("/quality/scheme/label/getLabel",{programmeId:this.programmeId}).then((function(e){e=e.data,t.labeList=e.params}))},onDelet:function(t){var e=this;this.$confirm("确定要删除".concat(t.name,"质检标签?"),"删除").then((function(){e.$http.post("/quality/scheme/label/delete",{labelId:t.labelId,programmeId:e.programmeId}).then((function(){e.$message.success("删除成功"),e.getData()}))}))},onAdd:function(){var t=this,e=this.labeName;e&&this.$http.post("/quality/scheme/label/saveSchemeLabel",{name:this.labeName,programmeId:this.programmeId,entId:this.userData.entid}).then((function(){t.$message.success("保存成功"),t.labeName="",t.getData()}))}}}),v=h,b=(a("94b6"),Object(d["a"])(v,p,f,!1,null,"08d7b8fe",null)),g=b.exports,_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"customer-data-list"},[i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("客户头像：")]),i("div",{staticClass:"list-item-right"},[i("el-avatar",{attrs:{icon:"el-icon-user-solid",size:30,src:a("6276")}})],1)]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("客户昵称：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.customerData.customerName||"--"))])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("真实姓名：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.detail.customerName||"--"))])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("来源：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.customerSources[t.detail.customerSource]||"--"))])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("客户等级：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.customerLevels[t.detail.customerLevel]||"--"))])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("邮箱：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.detail.email?t.detail.email+"":"--"))])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("电话：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.detail.phone?t.detail.phone+"":"--"))])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("公司：")]),i("div",{staticClass:"list-item-right"},[t._v(" "+t._s(t.companyList.reduce((function(t,e){var a;return Object.assign({},t,(a={},a[e.companyId]=e.companyName,a))}),{})[t.detail.companyId]||"--")+" ")])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("城市：")]),i("div",{staticClass:"list-item-right"},[t._v(" "+t._s([t.detail.customerProvince,t.detail.customerCity,t.detail.customerArea].filter((function(t){return t})).join("/")||"--")+" ")])]),i("li",{staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v("备注：")]),i("div",{staticClass:"list-item-right"},[t._v(t._s(t.detail.remark||"--"))])]),t._l(t.detail.dataJson,(function(e){return i("li",{key:e.fieldId,staticClass:"list-item"},[i("div",{staticClass:"list-item-left"},[t._v(t._s(e.fieldName)+"：")]),i("com-field",{attrs:{data:e,readonly:!0,value:e.val}})],1)}))],2)},y=[],I=a("8c45"),C=a("de0b"),D={name:"customerInfo",components:{ComField:I["a"]},props:["customerData"],data:function(){return{detail:{},dataJson:[],companyList:[],customerSources:C["b"],customerLevels:C["a"]}},created:function(){this.getInitData()},methods:{getInitData:function(){var t=this,e=function(t){return t?t.split(","):[""]};this.$http("/ccas/cc/customer/details/by/partner/".concat(this.customerData.customerId)).then((function(a){var i=a.data;i&&(t.detail=Object(n["a"])(Object(n["a"])({},i),{},{email:e(i.email),phone:e(i.phone),dataJson:[]}),t.getFields().then((function(e){t.detail=Object(n["a"])(Object(n["a"])({},t.detail),{},{dataJson:e})})))})),this.getCompanyList()},getFields:function(){var t=this;return this.$http("/ccas/cc/field/list",{params:{businessType:1}}).then((function(e){var a=e.data;return a.filter((function(t){return!t.predefinedType})).map((function(e){var a=t.detail[e.dataColName];return[7,9].indexOf(e.fieldType)>-1&&(a=a?a.split(",").filter((function(t){return t})):[]),Object(n["a"])(Object(n["a"])({},e),{},{val:a})}))}))},getCompanyList:function(){var t=this;this.$http("/ccas/cc/company/list").then((function(e){var a=e.data;t.companyList=a}))}}},E=D,T=(a("7399"),Object(d["a"])(E,_,y,!1,null,"7abeffee",null)),A=T.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quality-list"},[a("el-scrollbar",[a("el-form",{ref:"form",staticStyle:{"margin-right":"10px"},attrs:{model:t.form,"label-width":"10em","label-position":"left"},nativeOn:{submit:function(t){t.preventDefault()}}},[t.programmeId?a("div",[t.isEdit?a("div",[a("ui-text-field",{attrs:{label:"被质检客服",value:t.detailData.seatName,disabled:""}}),a("ui-select",{attrs:{label:"质检方案",filterable:"",disabled:!t.isEdit},model:{value:t.programmeId,callback:function(e){t.programmeId=e},expression:"programmeId"}},t._l(t.options,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.companyId}})})),1),a("div",{staticClass:"sub-title"},[t._v("标准分")]),t._l(t.templateData.InspectionList,(function(e){return a("el-form-item",{key:e.id,attrs:{label:e.standard_name}},[a("el-input-number",{attrs:{disabled:!t.isEdit,placeholder:"0~"+e.standard_score,controls:!1,min:0,max:+e.standard_score},model:{value:e.score,callback:function(a){t.$set(e,"score",a)},expression:"item.score"}}),a("span",{staticClass:"units"},[t._v("分")])],1)})),a("div",{staticClass:"sub-title"},[t._v("附加分")]),t._l(t.templateData.AdditionList,(function(e,i){return a("el-form-item",{key:i,attrs:{label:e.additional_name}},[a("i",{class:1==e.score_type?"el-icon-plus":"el-icon-minus"}),a("el-input-number",{attrs:{controls:!1,min:0,max:+e.additional_score,placeholder:"0~"+e.additional_score},model:{value:e.score,callback:function(a){t.$set(e,"score",a)},expression:"item.score"}}),a("span",{staticClass:"units"},[t._v("分")])],1)})),a("div",{staticClass:"flex-box"},[a("div",{staticClass:"sub-title"},[t._v("总分")]),a("div",{staticClass:"sub-title"},[t._v(t._s(t.total)+"分")])]),a("div",{staticClass:"flex-box"},[a("div",{staticClass:"sub-title"},[t._v("质检标签")]),t.isLaberEdit?t._e():a("el-button",{attrs:{type:"text"},on:{click:function(e){t.isLaberEdit=!t.isLaberEdit}}},[t._v("完成")]),t.isLaberEdit?a("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){t.isLaberEdit=!t.isLaberEdit}}},[t._v("添加")]):t._e()],1),t.isLaberEdit?t._e():a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标签名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onAdd.apply(null,arguments)}},model:{value:t.labeName,callback:function(e){t.labeName=e},expression:"labeName"}},[a("span",{attrs:{slot:"append"},on:{click:t.onAdd},slot:"append"},[t._v("添加")])]),a("div",{staticClass:"laberList"},t._l(t.labeList,(function(e,i){return a("el-tag",{key:i,class:["tag",{bg:t.slecteTagsName.indexOf(e.name)>-1&&t.isLaberEdit}],attrs:{"disable-transitions":!1,closable:!t.isLaberEdit},on:{close:function(a){return t.onDelet(e)},click:function(a){return t.slecteTag(e.name)}}},[t._v(t._s(e.name))])})),1),a("div",{staticClass:"sub-title"},[t._v("质检评语")]),a("el-input",{attrs:{type:"textarea",placeholder:"请填入文字评价，包括意见，建议等，最多500字符",maxlength:"500","show-word-limit":""},model:{value:t.form.message,callback:function(e){t.$set(t.form,"message",e)},expression:"form.message"}})],2):a("div",[t.programmeId&&!t.isEdit?a("div",{staticClass:"quality-info"},[a("div",{staticClass:"row"},[a("span",[t._v("被质检客服：")]),t._v(" "),a("span",[t._v(t._s(t.detailData.seatName))])]),a("div",{staticClass:"row"},[a("span",[t._v("质检来源：")]),t._v(" "),a("span",[t._v("自主抽检")])]),a("div",{staticClass:"row"},[a("span",[t._v("质检状态：")]),t._v(" "),a("span",[t._v(t._s(t.appealName))])]),a("div",{staticClass:"row"},[a("span",[t._v("质检申诉次数：")]),a("span",[t._v(t._s(t.appealNums||0))])])]):t._e(),t._l(t.qualityResults,(function(e,i){return a("div",{key:i,staticClass:"quality-list"},[a("div",{staticClass:"row"},[a("span",[t._v("质检人：")]),t._v(" "),a("span",[t._v(t._s(e.qualityPersionName))])]),a("div",{staticClass:"row"},[a("span",[t._v("质检方案：")]),a("span",[t._v(t._s(t.panName(e.programmeId)))])]),a("div",{staticClass:"row"},[a("span",[t._v("质检时间：")]),a("span",[t._v(t._s(e.updateTime))])]),a("div",{staticClass:"row weight"},[a("span",[t._v("总分：")]),t._v(" "),a("span",[t._v(t._s(e.totalScore)+"分")])]),a("div",{staticClass:"sub-title"},[t._v("标准分")]),t._l(e.AdditionList,(function(e,i){return a("div",{key:i,staticClass:"row"},[a("span",[t._v(t._s(e.names)+"：")]),a("span",[t._v(t._s(e.nums)+"分")])])})),a("div",{staticClass:"sub-title"},[t._v("附加分")]),t._l(e.InspectionList,(function(e){return a("div",{key:e.names,staticClass:"row"},[a("span",[t._v(t._s(e.names)+"：")]),a("span",[t._v(t._s(e.nums)+"分")])])})),a("div",{staticClass:"laberList"},[a("h4",[t._v("质检标签")]),t._l(e.tagName,(function(e,i){return a("el-tag",{key:i,staticClass:"tag bg"},[t._v(" "+t._s(e)+" ")])}))],2),a("div",{staticClass:"sub-title"},[t._v("质检评语")]),a("div",{staticClass:"row"},[t._v(t._s(e.message))]),3==t.detailData.viewsType&&e.appealMessage?a("div",[a("div",{staticClass:"sub-title"},[t._v("申诉历史")]),a("div",{staticClass:"row"},[t._v(t._s(e.appealMessage))])]):t._e(),t.rejectShow?a("div",[a("div",{staticClass:"sub-title"},[t._v("驳回理由")]),a("el-input",{attrs:{type:"textarea",placeholder:"请填入驳回理由"},model:{value:t.rejectMessage,callback:function(e){t.rejectMessage=e},expression:"rejectMessage"}})],1):t._e()],2)})),t.resultsList.length>1?a("div",[t.moreShow?a("el-button",{attrs:{type:"text",icon:"el-icon-arrow-down"},on:{click:function(e){return t.onSeeMore(!1)}}},[t._v("查看更多历史质检")]):a("el-button",{attrs:{type:"text",icon:"el-icon-arrow-down"},on:{click:function(e){return t.onSeeMore(!0)}}},[t._v("收起历史质检")])],1):t._e()],2)]):t._e()])],1),t.programmeId?a("div",{staticClass:"footer"},[t.isEdit?a("div",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.onSubmit(t.form)}}},[t._v("保存")]),a("el-button",{on:{click:function(e){t.isEdit=!1}}},[t._v("取消")])],1):a("div",[t.rejectShow&&3==t.detailData.viewsType?a("div",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.onReject()}}},[t._v("保存")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.rejectShow=!1}}},[t._v("取消")])],1):t._e(),!t.rejectShow&&t.permit?a("div",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onEdit()}}},[t._v("重检")]),3==t.detailData.viewsType?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.toBottom()}}},[t._v("驳回")]):t._e()],1):t._e()])]):t._e()],1)},j=[],k=(a("7db0"),{props:["detailData","store"],data:function(){return{loading:!1,templateData:{InspectionList:[],AdditionList:[]},options:this.detailData.options,programmeId:"",labeList:[],userData:this.store.state.userData,labeName:"",isLaberEdit:!0,isEdit:!1,qualityResults:[],resultsList:[],slecteTagsName:[],moreShow:!0,rejectShow:!1,rejectMessage:"",appealNums:this.detailData.appealNums,form:{list:[],list2:[]}}},computed:{total:function(){var t=0;return this.templateData.InspectionList.forEach((function(e){t=+e.score+t})),this.templateData.AdditionList.forEach((function(e){var a=e.score||0;t=1===+e.score_type?+a+t:+t-a})),t},appealName:function(){return{1:"未质检",2:"已质检",3:"未申诉",4:"申诉中",5:"驳回",6:"已重检"}[this.detailData.appealType]||""},permit:function(){return(this.store.state.permissions.indexOf("quality_session_appeal_review")>-1||this.store.getters.isAdmin)&&this.userData.workNo!==this.detailData.seatId}},watch:{programmeId:{handler:function(t){t&&this.isEdit&&(this.getData(),this.getTemplateData())}},isEdit:{handler:function(t){t||(this.onGetScore(),this.getData())}},detailData:{deep:!0,immediate:!0,handler:function(t){this.rejectMessage=t.rejectMessage,this.programmeId=t.programmeId,this.onGetScore(),this.getData(),this.getAppealNums()}}},methods:{getAppealNums:function(){var t=this;2===+this.detailData.viewsType&&this.$post("/quality/apply/getReexamination",{conversationId:this.detailData.id,entId:this.userData.entid}).then((function(e){var a=e.data;a=a.list,t.appealNums=a.length?a[0].appealNums:0}))},toBottom:function(){this.rejectShow=!0;var t=this.$el.querySelector(".el-scrollbar__wrap");this.$nextTick((function(){t.scrollTop=t.scrollHeight}))},slecteTag:function(t){if(this.isLaberEdit){var e=this.slecteTagsName.indexOf(t);e>-1?this.slecteTagsName.splice(e,1):this.slecteTagsName.push(t)}},panName:function(t){return this.options.find((function(e){return e.companyId===t})).name},onSeeMore:function(t){this.moreShow=t,this.qualityResults=t?[this.resultsList[0]]:this.resultsList},onReject:function(){var t=this;if(this.rejectMessage){var e={conversationId:this.detailData.id,rejectReason:this.rejectMessage,entId:this.userData.entid};delete e.options,this.loading=!0,this.$http.post("/quality/apply/rejectReexamination",e).then((function(e){t.$message.success("驳回成功"),t.rejectMessage="",t.rejectShow=!1,t.$router.back()})).finally((function(){t.loading=!1}))}else this.$message.error("驳回理由不能为空")},onEdit:function(){this.isEdit=!0,this.slecteTagsName=[],this.getTemplateData(),this.getData()},onSubmit:function(t){var e=this;t.list=this.templateData.InspectionList.map((function(t){var e={};return e.names=t.standard_name,e.nums=t.score.toString()||"0",e})),t.list2=this.templateData.AdditionList.map((function(t){var e={},a=1===+t.score_type?"":"-";return e.names=t.additional_name.toString(),e.nums=(t.score?a+t.score:"0").toString(),e})),t=Object(n["a"])(Object(n["a"])(Object(n["a"])({},this.detailData),t),{},{entId:this.userData.entid,qualityPersionId:this.userData.userId,qualityPersionName:this.userData.username,conversationId:this.detailData.id,programmeId:this.programmeId,standTotal:this.total.toString(),tagName:this.slecteTagsName.join(",")}),delete t.options,this.loading=!0,this.$http.post("/quality/conversation/saveScore",t).then((function(){e.isEdit=!1,e.$message.success("保存成功"),3===+e.detailData.viewsType&&e.$router.back()})).finally((function(){e.loading=!1}))},onGetScore:function(){var t=this;this.$http.post("/quality/conversation/getScore",{conversationId:this.detailData.conversationId,entId:this.userData.entid,programmeId:this.programmeId}).then((function(e){var a=e.data;a=a.sort((function(t,e){return e.version-t.version})),a[0].appealMessage=t.detailData.message,a.map((function(t){return t.tagName=t.tagName?t.tagName.split(","):[],t})),t.slecteTagsName=a[0].tagName,t.resultsList=a,t.qualityResults=[a[0]]}))},getTemplateData:function(){var t=this;this.$post("/quality/conversation/getProgramme",{programId:this.programmeId,entId:this.userData.entid}).then((function(e){var a=e.data;a.InspectionList.length&&a.AdditionList.length?(t.form.list=a.InspectionList.map((function(t){return t.score=t.standard_score,t})),t.templateData=a):(t.programmeId="",t.$message.warning("质检方案内容为空，请重新选择质检方案"))})).catch((function(){t.programmeId=""}))},getData:function(){var t=this;this.$post("/quality/scheme/label/getLabel",{programmeId:this.programmeId}).then((function(e){e=e.data,t.labeList=e.params}))},onDelet:function(t){var e=this;this.$confirm("确定要删除".concat(t.name,"质检标签?"),"删除").then((function(){e.$http.post("/quality/scheme/label/delete",{labelId:t.labelId,programmeId:e.programmeId}).then((function(){e.$message.success("删除成功"),e.getData()}))}))},onAdd:function(){var t=this,e=this.labeName;e&&this.$http.post("/quality/scheme/label/saveSchemeLabel",{name:this.labeName,programmeId:this.programmeId,entId:this.userData.entid}).then((function(){t.$message.success("保存成功"),t.labeName="",t.getData()}))}}}),O=k,N=(a("f91d"),Object(d["a"])(O,w,j,!1,null,"94fea6aa",null)),x=N.exports,L=a("65f05"),S=a("d36e"),R=a("0f89"),M=a("bb76"),q=a("62d7"),P={props:["row","viewsType","options","programId","store","router"],components:{ComSessionInfo:S["a"],ComMenu:m,ComServiceSummary:R["a"],ComCustomerData:A,ComSatisfaction:L["a"],ComQuality:g,ComSessionRecord:M["a"],ComRelatedWorkOrder:q["a"],ComQualityResult:x},data:function(){var t=this.row;return{detailData:Object(n["a"])(Object(n["a"])({seachProgrammeId:this.programId,options:this.options,viewsType:this.viewsType||1},t),{},{id:1===this.viewsType?t.conId:t.conversationId,conId:1===this.viewsType?t.conId:t.conversationId}),modalProps:{drawer:!0,title:t.customerName,width:3===this.viewsType?"998px":"1240px",hideFooter:!0}}},computed:{sessionInfo:function(){return Object(n["a"])(Object(n["a"])({},this.detailData),{},{datadept:this.detailData.belongBusiness,agentno:this.detailData.seatName,status:this.detailData.handleType,channel:this.detailData.channelType})}},methods:{onChageDetail:function(t){this.detailData=t},onViewWorkorderDetail:function(t){var e="quality";this.$refs.Modal.show(!1),this.store.commit("SET_NORMAL_NAVIGATION",!0),this.router.push({name:"workorder-detail",params:{id:t,fromPath:e}})}}},$=P,B=(a("6d79"),Object(d["a"])($,i,s,!1,null,"7bd8ea1f",null));e["default"]=B.exports},"25d9":function(t,e,a){},"25f0":function(t,e,a){"use strict";var i=a("e330"),s=a("5e77").PROPER,n=a("6eeb"),r=a("825a"),o=a("3a9b"),l=a("577e"),c=a("d039"),d=a("ad6d"),u="toString",m=RegExp.prototype,p=m[u],f=i(d),h=c((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),v=s&&p.name!=u;(h||v)&&n(RegExp.prototype,u,(function(){var t=r(this),e=l(t.source),a=t.flags,i=l(void 0===a&&o(m,t)&&!("flags"in m)?f(t):a);return"/"+e+"/"+i}),{unsafe:!0})},3280:function(t,e,a){},"498a":function(t,e,a){"use strict";var i=a("23e7"),s=a("58a8").trim,n=a("c8d2");i({target:"String",proto:!0,forced:n("trim")},{trim:function(){return s(this)}})},"57b8":function(t,e,a){},"5ed8":function(t,e,a){},6276:function(t,e){t.exports="data:image/jpeg;base64,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"},"6d79":function(t,e,a){"use strict";a("5ed8")},7399:function(t,e,a){"use strict";a("a9ea")},"8c45":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{label:t.data.fieldName}},[t.data.fieldType===t.T.INPUT?[t.readonly?a("span",[t._v(t._s(t.model))]):a("el-input",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t.data.fieldType===t.T.TEXTAREA?[t.readonly?a("span",[t._v(t._s(t.model))]):a("el-input",{attrs:{type:"textarea"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t.data.fieldType===t.T.DATE?[t.readonly?a("span",[t._v(t._s(t.$adminCore.formatDate(+t.model,"yyyy-MM-dd")))]):a("el-date-picker",{attrs:{"value-format":"timestamp"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t.data.fieldType===t.T.TIME?[t.readonly?a("span",[t._v(t._s(t.model))]):a("el-time-picker",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t.data.fieldType===t.T.NUM_INPUT?[t.readonly?a("span",[t._v(t._s(t.model))]):a("el-input-number",{attrs:{"controls-position":"right"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t.data.fieldType===t.T.SELECT?[t.readonly?a("span",[t._v(t._s(t.getText(t.model)))]):a("el-select",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},t._l(t.options,(function(t){return a("el-option",{key:t.optionId,attrs:{value:t.optionId,label:t.value}})})),1)]:t.data.fieldType===t.T.CASCADER?[a("el-cascader",{class:{readonly:t.readonly},attrs:{disabled:t.readonly,options:t.options},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})]:t.data.fieldType===t.T.RADIO?[t.readonly?a("span",[t._v(t._s(t.getText(t.model)))]):a("el-radio-group",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},t._l(t.options,(function(e){return a("el-radio",{key:e.optionId,attrs:{label:e.optionId}},[t._v(t._s(e.value))])})),1)]:t.data.fieldType===t.T.CHECKBOX?[t.readonly?a("span",[t._v(t._s(t.getText(t.model)))]):a("el-checkbox-group",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},t._l(t.options,(function(e){return a("el-checkbox",{key:e.optionId,attrs:{label:e.optionId}},[t._v(t._s(e.value))])})),1)]:t._e()],2)},s=[],n=a("ade3"),r=a("5530"),o=(a("d81d"),a("d3b7"),a("a02a")),l=a("e139"),c={data:function(){return{T:l["a"],options:[],model:this.value}},props:{data:{type:Object,default:function(){return{}}},value:{},readonly:Boolean},watch:{value:function(t){this.model=t},model:function(t){this.$emit("input",t)}},mounted:function(){var t=this;Object(l["c"])(this.data.fieldType)&&this.$http("/ccas/cc/field/option/details/".concat(this.data.fieldId)).then((function(e){var a=e.data;t.options=t.data.fieldType===l["a"].CASCADER?Object(o["F"])(a.map((function(t){var e=t.optionId,a=t.value;return Object(r["a"])(Object(r["a"])({},t),{},{value:e,label:a})})),{key:"optionId"}):a}))},methods:{getText:function(t){var e=this.options.reduce((function(t,e){return Object(r["a"])(Object(r["a"])({},t),{},Object(n["a"])({},e.optionId,e.value))}),{});return t instanceof Array?t.map((function(t){return e[t]}))+"":e[t]}}},d=c,u=(a("afc7"),a("2877")),m=Object(u["a"])(d,i,s,!1,null,"338d9c7e",null);e["a"]=m.exports},"94b6":function(t,e,a){"use strict";a("57b8")},a9ea:function(t,e,a){},afc7:function(t,e,a){"use strict";a("3280")},c343:function(t,e,a){},c8d2:function(t,e,a){var i=a("5e77").PROPER,s=a("d039"),n=a("5899"),r="​᠎";t.exports=function(t){return s((function(){return!!n[t]()||r[t]()!==r||i&&n[t].name!==t}))}},de0b:function(t,e,a){"use strict";a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return l}));var i=a("ade3"),s="customer-center",n={CUSTOMER_CENTER:1,WECHAT:2,APP:3,PC_WEB:4,WEIBO:5,MOB_WEB:6,CALL_CENTER:7,WO_CENTER:8,ENT_WECHAT:9,WECHAT_APP:10,EMAIL:11},r=function(t){var e;return e={},Object(i["a"])(e,t.CUSTOMER_CENTER,"客户中心"),Object(i["a"])(e,t.WECHAT,"微信"),Object(i["a"])(e,t.APP,"APP"),Object(i["a"])(e,t.PC_WEB,"桌面网站"),Object(i["a"])(e,t.WEIBO,"微博"),Object(i["a"])(e,t.MOB_WEB,"移动网站"),Object(i["a"])(e,t.CALL_CENTER,"呼叫中心"),Object(i["a"])(e,t.WO_CENTER,"工单中心"),Object(i["a"])(e,t.ENT_WECHAT,"企业微信"),Object(i["a"])(e,t.WECHAT_APP,"微信小程序"),Object(i["a"])(e,t.EMAIL,"邮件"),e}(n),o={BASE:1,VIP:2},l=function(t){var e;return e={},Object(i["a"])(e,t.BASE,"普通客户"),Object(i["a"])(e,t.VIP,"VIP客户"),e}(o)},e139:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"d",(function(){return d}));var i,s=a("ade3"),n=(a("caad"),a("2532"),{INPUT:1,TEXTAREA:2,DATE:3,TIME:4,NUM_INPUT:5,SELECT:6,CASCADER:7,RADIO:8,CHECKBOX:9}),r=n,o=(i={},Object(s["a"])(i,r.INPUT,"单行文本框"),Object(s["a"])(i,r.TEXTAREA,"多行文本框"),Object(s["a"])(i,r.DATE,"日期"),Object(s["a"])(i,r.TIME,"时间"),Object(s["a"])(i,r.NUM_INPUT,"数值输入框"),Object(s["a"])(i,r.SELECT,"下拉框"),Object(s["a"])(i,r.CASCADER,"级联下拉框"),Object(s["a"])(i,r.RADIO,"单选框"),Object(s["a"])(i,r.CHECKBOX,"复选框"),i),l=function(t){return[r.SELECT,r.CASCADER,r.RADIO,r.CHECKBOX].includes(+t)},c=function(t){return o[t]},d=function(t){return 1===+t.requireWrite}},f91d:function(t,e,a){"use strict";a("c343")},fffc:function(t,e,a){"use strict";a.d(e,"n",(function(){return l})),a.d(e,"a",(function(){return f})),a.d(e,"f",(function(){return h})),a.d(e,"d",(function(){return v})),a.d(e,"e",(function(){return b})),a.d(e,"b",(function(){return g})),a.d(e,"j",(function(){return _})),a.d(e,"c",(function(){return y})),a.d(e,"o",(function(){return I})),a.d(e,"i",(function(){return C})),a.d(e,"h",(function(){return E})),a.d(e,"l",(function(){return T})),a.d(e,"k",(function(){return A})),a.d(e,"g",(function(){return w})),a.d(e,"m",(function(){return j}));var i=a("1da1"),s=a("2909"),n=a("5530"),r=a("ade3"),o=(a("96cf"),a("7db0"),a("d3b7"),a("b0c0"),a("a15b"),a("99af"),a("d81d"),a("4de4"),a("b64b"),a("caad"),a("2532"),a("3ca3"),a("ddb0"),a("159b"),a("a02a")),l="workorder",c={label:"尚未受理",value:0},d={label:"受理中",value:1},u={label:"等待回复",value:2},m={label:"已解决",value:3},p={label:"已关闭",value:4},f=[5,"已删除"],h=[c,d,u],v=[m,p],b=[c,d,u,m,p],g=[d,m,p],_=function(t){return(b.find((function(e){return e.value===t}))||{}).label},y=[[0,"我来受理工单","您好，我是 {COMPANY_NAME} 的客服代表 {SERVICE_NICK} ，很高兴为您服务！\n  我们已将您的请求生成工单 {TICKET_CODE} - {TICKET_TITLE}。该工单正在进行处理，一旦有任何更新我们会及时给您回复，请您耐心等待。"],[1,"尝试联系用户","您好，我是 {COMPANY_NAME} 的客服代表 {SERVICE_NICK} ，很抱歉在您百忙之中打扰您。\n  关于您的工单 {TICKET_CODE} - {TICKET_TITLE} ，我们希望确认您是否还存在其他疑问。鉴于还没有收到您的回复，我们会继续尝试联系您。如果您有任何进展或者其他疑问，可随时在系统中进行回复，感谢您的理解与支持。"],[2,"客服处理完毕，请用户确认","您好，您的工单 {TICKET_CODE} - {TICKET_TITLE} 已完成处理，请在回复中进行确认。\n  希望我们的工作能使您满意，如您有任何建议或意见，欢迎回复告知我们，我们会努力改进。"],[3,"用户没有回复工单","您好，您的工单 {TICKET_CODE} - {TICKET_TITLE} 用户超时未回复，置为已解决。"]],I=[{label:"低",value:0},{label:"中",value:1},{label:"高",value:2},{label:"紧急",value:3}],C=function(t){return(I.find((function(e){return e.value===t}))||{}).label},D={INPUT:0,TEXTAREA:1,RADIO:2,CHECKBOX:3,SELECT:4},E=function(t){var e;return e={},Object(r["a"])(e,t.INPUT,"单行文本框"),Object(r["a"])(e,t.TEXTAREA,"多行文本框"),Object(r["a"])(e,t.RADIO,"单选框"),Object(r["a"])(e,t.CHECKBOX,"复选框"),Object(r["a"])(e,t.SELECT,"下拉框"),e}(D),T=function(t){return!Object(o["v"])(t)&&t>1},A=function(t,e){var a=[],i=t.find((function(t){return t.id===e}));while(i)a.unshift(i.name),i=t.find((function(t){return t.id===i.parentId}));return a.join(" / ")},w=function(){return{label:"工单标题",prop:"name",minWidth:120,render:function(t,e){var a=e.row;return 1===a.flag&&new Date-new Date(a.lastUrgeTime)<864e5?t("span",[t("span",{style:"color:#E59208;border:1px solid #E59208;padding:2px;margin-right:5px"},"催"),t("span",a.name)]):t("span",a.name)}}},j={data:function(){var t=this,e=["number","name","channelId","status","sgroupName","acceptor","typeId","createTime"];return{priorities:I,types:[],skillGroups:[],states:b,allColumns:{base:{title:"基础字段",data:[{label:"工单编号",prop:"number",minWidth:140},w(),{label:"创建渠道",prop:"channelId",minWidth:80,render:function(t,e){var a=e.row;return t("span",1===a.channelId?"工单中心":"在线客服")}},{label:"工单描述",prop:"description",minWidth:120},{label:"工单状态",prop:"status",minWidth:80,render:function(t,e){var a=e.row;return t("span",_(a.status)||"已删除")}},{label:"优先级",prop:"priority",minWidth:80,render:function(t,e){var a=e.row;return t("span",C(a.priority))}},{label:"创建人",prop:"cuserName"},{label:"创建客服组",prop:"cgroupName",minWidth:120},{label:"受理客服组",prop:"sgroupName",minWidth:120},{label:"受理客服",prop:"acceptor"},{label:"分类",prop:"typeId",minWidth:140,render:function(e,a){var i=a.row;return e("span",t.getTypeText(i.typeId))}},{label:"创建时间",prop:"createTime",minWidth:140},{label:"首次响应时间",prop:"firstUpdateTime",minWidth:140},{label:"首次受理时间",prop:"firstAcceptTime",minWidth:140},{label:"更新时间",prop:"modifyTime",minWidth:140},{label:"首次解决时间",prop:"firstSolveTime",minWidth:140},{label:"最后回复人",prop:"lastReplingPersonName"}]},customer:{title:"客户字段",data:[{label:"客户昵称",prop:"customerNickName"},{label:"客户姓名",prop:"customerName"}]}},defaultProps:e,selectedProps:[].concat(e)}},computed:{typeList:function(){return Object(o["F"])(this.types.map((function(t){return Object(n["a"])(Object(n["a"])({},t),{},{value:t.id,label:t.name})})))},showedColumns:function(){var t=this;return[{type:"selection"}].concat(Object(s["a"])(Object.keys(this.allColumns).reduce((function(e,a){return[].concat(Object(s["a"])(e),Object(s["a"])(t.allColumns[a].data))}),[]).filter((function(e){return t.selectedProps.includes(e.prop)}))))},typeId:function(){var t=this.searchForm.typeId;return t&&t.length?t[t.length-1]:""}},mounted:function(){this.setInitForm&&this.setInitForm(),this.getInitData(),Object(o["g"])(this,this.getInitData)},methods:{getStateText:_,getInitData:function(){this.isActive?this.getData():(this.onReset(),this.isActive=!0),this.getTypes(),this.getSkillGroups()},onDelete:function(t){var e=this;this.delData({rows:t,action:function(t){return e.$post("/workOrder/delete",{orderId:t.map((function(t){return t.id}))+""})}})},getSkillGroups:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http("/orderGroup/listGroup");case 2:t.skillGroups=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},getGroupText:function(t){return(this.skillGroups.find((function(e){return e.id===t}))||{}).name},onCreate:function(){this.$openModal((function(){return a.e("chunk-497ef431").then(a.bind(null,"4bd2"))}),{},{success:this.onEditSuccess})},onBatchImport:function(){this.$openModal((function(){return a.e("chunk-2d0da7ad").then(a.bind(null,"6c7a"))}),{typeList:this.typeList},{success:this.onEditSuccess})},onBatchExport:function(t,e){var a=this,i=e.typeId||[],s=i[i.length-1];s?Object(o["i"])({fileName:"工单批量导出数据.xls",action:function(){return a.$post(t,Object(n["a"])(Object(n["a"])({},e),{},{typeId:s}),{responseType:"blob"})}}):this.$message("请先选择分类再导出")},onDetail:function(t){this.$router.push({name:"".concat(l,"-detail"),params:{id:t.id}})},onAccept:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=t instanceof Array?t.map((function(t){return t.id}))+"":t.id,a.next=3,e.$post("/workOrder/accept",{orderId:i});case 3:e.$message.success("接单成功"),e.getData();case 5:case"end":return a.stop()}}),a)})))()},getTypes:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http("/orderType/listByPage");case 2:t.types=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},getTypeText:function(t){return A(this.types,t)},onKeyChange:function(){var t=this;this.options.forEach((function(e){t.$set(t.searchForm,e[0],void 0)}))},onCustomField:function(){var t=this;this.$openModal("UiFieldCustom",{columns:this.allColumns,defaultProps:this.defaultProps,selectedProps:this.selectedProps},{success:function(e){t.selectedProps=e}})}}}}}]);