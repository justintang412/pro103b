(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac29d998"],{"17a7":function(t,e,n){},"6f38":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ul",{staticClass:"card-list"},t._l(t.stats,(function(e){return n("data-stat-card",{key:e.value,attrs:{data:e,active:t.current===e.value,onClick:t.onCardClick}})})),1),n("ui-table-view",t._g(t._b({},"ui-table-view",t.viewProps,!1),t.viewListeners))],1)},a=[],i=n("3835"),o=n("1da1"),u=n("5530"),c=(n("96cf"),n("a02a")),s=n("fffc"),l=n("8e9e"),d={name:"HomeMyWorkorder",mixins:[window.mixTableView],components:{DataStatCard:l["a"]},data:function(){var t=this;return{stats:[{label:"今日我处理的工单",num:0,value:0},{label:"我创建的工单",num:0,value:1},{label:"我未解决的工单",num:0,value:2},{label:"我客服组未分配的工单",num:0,value:3},{label:"我关注的工单",num:0,value:4}],current:2,types:[],columns:[{label:"工单编号",prop:"number",minWidth:140},Object(s["g"])(),{label:"工单状态",minWidth:80,render:function(t,e){var n=e.row;return t("span",Object(s["j"])(n.status)||"已删除")}},{label:"优先级",minWidth:80,render:function(t,e){var n=e.row;return t("span",Object(s["i"])(n.priority))}},{label:"受理客服组",prop:"sgroupName"},{label:"受理客服",prop:"acceptor"},{label:"分类",minWidth:120,render:function(e,n){var r=n.row;return e("span",t.getTypeText(r.typeId))}},{label:"创建时间",prop:"createTime",minWidth:140},{label:"操作",width:100,fixed:"right",render:this.$hBtns({label:"查看",action:this.onView})}]}},mounted:function(){this.setForm(),this.getInitData(),Object(c["g"])(this,this.getInitData)},methods:{getInitData:function(){this.getData(),this.getTypes(),this.getCountWorkOrder()},setForm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;this.current=t;var e=this.$adminCore.formatDate(new Date,"yyyy-MM-dd"),n="/workOrder/myWorkOrder",r={0:{type:2,beginTime:e,endTime:e,url:n},1:{type:3,url:n},2:{type:1,url:n},3:{type:1,url:"/workOrder/myGroupWorkOrder"},4:{type:5,url:n}}[t];this.tableForm=r,this.searchForm=Object(u["a"])({},r)},fetchMethod:function(t){return this.$http(t.url,{params:t}).then((function(t){var e=t.data;return{data:e.workOrder,total:e.count}}))},onCardClick:function(t){this.setForm(t.value),this.onSearch()},getTypes:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http("/orderType/listByPage");case 2:t.types=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},getTypeText:function(t){return Object(s["k"])(this.types,t)},onView:function(t){this.$router.push({name:"workorder-detail",params:{id:t.id}})},getCountWorkOrder:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,c,s,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http("/workOrder/countWorkOrder");case 2:n=e.sent,r=n.data,a=Object(i["a"])(t.stats,5),o=a[0],c=a[1],s=a[2],l=a[3],d=a[4],t.stats=[Object(u["a"])(Object(u["a"])({},o),{},{num:r.myDisposed}),Object(u["a"])(Object(u["a"])({},c),{},{num:r.myCreate}),Object(u["a"])(Object(u["a"])({},s),{},{num:r.myUnresolved}),Object(u["a"])(Object(u["a"])({},l),{},{num:r.myGroupUndistributed}),Object(u["a"])(Object(u["a"])({},d),{},{num:r.myAttention})];case 6:case"end":return e.stop()}}),e)})))()}}},p=d,h=(n("edca"),n("2877")),m=Object(h["a"])(p,r,a,!1,null,"5b1b1834",null);e["default"]=m.exports},"8e9e":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{class:["home-data-stat-card",{active:t.active,clickable:t.onClick}],on:{click:t.clickHandler}},[n("div",[n("p",{staticClass:"num"},[t._v(t._s(t.data.num))]),n("p",{staticClass:"label"},[t._v(t._s(t.data.label))])])])},a=[],i={props:{data:Object,active:Boolean,onClick:Function},methods:{clickHandler:function(){this.onClick&&this.onClick(this.data)}}},o=i,u=(n("a5d4"),n("2877")),c=Object(u["a"])(o,r,a,!1,null,null,null);e["a"]=c.exports},a5d4:function(t,e,n){"use strict";n("a9aa")},a9aa:function(t,e,n){},edca:function(t,e,n){"use strict";n("17a7")},fffc:function(t,e,n){"use strict";n.d(e,"n",(function(){return c})),n.d(e,"a",(function(){return m})),n.d(e,"f",(function(){return f})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return v})),n.d(e,"b",(function(){return O})),n.d(e,"j",(function(){return T})),n.d(e,"c",(function(){return g})),n.d(e,"o",(function(){return y})),n.d(e,"i",(function(){return w})),n.d(e,"h",(function(){return j})),n.d(e,"l",(function(){return k})),n.d(e,"k",(function(){return I})),n.d(e,"g",(function(){return E})),n.d(e,"m",(function(){return x}));var r=n("1da1"),a=n("2909"),i=n("5530"),o=n("ade3"),u=(n("96cf"),n("7db0"),n("d3b7"),n("b0c0"),n("a15b"),n("99af"),n("d81d"),n("4de4"),n("b64b"),n("caad"),n("2532"),n("3ca3"),n("ddb0"),n("159b"),n("a02a")),c="workorder",s={label:"尚未受理",value:0},l={label:"受理中",value:1},d={label:"等待回复",value:2},p={label:"已解决",value:3},h={label:"已关闭",value:4},m=[5,"已删除"],f=[s,l,d],b=[p,h],v=[s,l,d,p,h],O=[l,p,h],T=function(t){return(v.find((function(e){return e.value===t}))||{}).label},g=[[0,"我来受理工单","您好，我是 {COMPANY_NAME} 的客服代表 {SERVICE_NICK} ，很高兴为您服务！\n  我们已将您的请求生成工单 {TICKET_CODE} - {TICKET_TITLE}。该工单正在进行处理，一旦有任何更新我们会及时给您回复，请您耐心等待。"],[1,"尝试联系用户","您好，我是 {COMPANY_NAME} 的客服代表 {SERVICE_NICK} ，很抱歉在您百忙之中打扰您。\n  关于您的工单 {TICKET_CODE} - {TICKET_TITLE} ，我们希望确认您是否还存在其他疑问。鉴于还没有收到您的回复，我们会继续尝试联系您。如果您有任何进展或者其他疑问，可随时在系统中进行回复，感谢您的理解与支持。"],[2,"客服处理完毕，请用户确认","您好，您的工单 {TICKET_CODE} - {TICKET_TITLE} 已完成处理，请在回复中进行确认。\n  希望我们的工作能使您满意，如您有任何建议或意见，欢迎回复告知我们，我们会努力改进。"],[3,"用户没有回复工单","您好，您的工单 {TICKET_CODE} - {TICKET_TITLE} 用户超时未回复，置为已解决。"]],y=[{label:"低",value:0},{label:"中",value:1},{label:"高",value:2},{label:"紧急",value:3}],w=function(t){return(y.find((function(e){return e.value===t}))||{}).label},C={INPUT:0,TEXTAREA:1,RADIO:2,CHECKBOX:3,SELECT:4},j=function(t){var e;return e={},Object(o["a"])(e,t.INPUT,"单行文本框"),Object(o["a"])(e,t.TEXTAREA,"多行文本框"),Object(o["a"])(e,t.RADIO,"单选框"),Object(o["a"])(e,t.CHECKBOX,"复选框"),Object(o["a"])(e,t.SELECT,"下拉框"),e}(C),k=function(t){return!Object(u["v"])(t)&&t>1},I=function(t,e){var n=[],r=t.find((function(t){return t.id===e}));while(r)n.unshift(r.name),r=t.find((function(t){return t.id===r.parentId}));return n.join(" / ")},E=function(){return{label:"工单标题",prop:"name",minWidth:120,render:function(t,e){var n=e.row;return 1===n.flag&&new Date-new Date(n.lastUrgeTime)<864e5?t("span",[t("span",{style:"color:#E59208;border:1px solid #E59208;padding:2px;margin-right:5px"},"催"),t("span",n.name)]):t("span",n.name)}}},x={data:function(){var t=this,e=["number","name","channelId","status","sgroupName","acceptor","typeId","createTime"];return{priorities:y,types:[],skillGroups:[],states:v,allColumns:{base:{title:"基础字段",data:[{label:"工单编号",prop:"number",minWidth:140},E(),{label:"创建渠道",prop:"channelId",minWidth:80,render:function(t,e){var n=e.row;return t("span",1===n.channelId?"工单中心":"在线客服")}},{label:"工单描述",prop:"description",minWidth:120},{label:"工单状态",prop:"status",minWidth:80,render:function(t,e){var n=e.row;return t("span",T(n.status)||"已删除")}},{label:"优先级",prop:"priority",minWidth:80,render:function(t,e){var n=e.row;return t("span",w(n.priority))}},{label:"创建人",prop:"cuserName"},{label:"创建客服组",prop:"cgroupName",minWidth:120},{label:"受理客服组",prop:"sgroupName",minWidth:120},{label:"受理客服",prop:"acceptor"},{label:"分类",prop:"typeId",minWidth:140,render:function(e,n){var r=n.row;return e("span",t.getTypeText(r.typeId))}},{label:"创建时间",prop:"createTime",minWidth:140},{label:"首次响应时间",prop:"firstUpdateTime",minWidth:140},{label:"首次受理时间",prop:"firstAcceptTime",minWidth:140},{label:"更新时间",prop:"modifyTime",minWidth:140},{label:"首次解决时间",prop:"firstSolveTime",minWidth:140},{label:"最后回复人",prop:"lastReplingPersonName"}]},customer:{title:"客户字段",data:[{label:"客户昵称",prop:"customerNickName"},{label:"客户姓名",prop:"customerName"}]}},defaultProps:e,selectedProps:[].concat(e)}},computed:{typeList:function(){return Object(u["F"])(this.types.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{value:t.id,label:t.name})})))},showedColumns:function(){var t=this;return[{type:"selection"}].concat(Object(a["a"])(Object.keys(this.allColumns).reduce((function(e,n){return[].concat(Object(a["a"])(e),Object(a["a"])(t.allColumns[n].data))}),[]).filter((function(e){return t.selectedProps.includes(e.prop)}))))},typeId:function(){var t=this.searchForm.typeId;return t&&t.length?t[t.length-1]:""}},mounted:function(){this.setInitForm&&this.setInitForm(),this.getInitData(),Object(u["g"])(this,this.getInitData)},methods:{getStateText:T,getInitData:function(){this.isActive?this.getData():(this.onReset(),this.isActive=!0),this.getTypes(),this.getSkillGroups()},onDelete:function(t){var e=this;this.delData({rows:t,action:function(t){return e.$post("/workOrder/delete",{orderId:t.map((function(t){return t.id}))+""})}})},getSkillGroups:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http("/orderGroup/listGroup");case 2:t.skillGroups=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},getGroupText:function(t){return(this.skillGroups.find((function(e){return e.id===t}))||{}).name},onCreate:function(){this.$openModal((function(){return n.e("chunk-497ef431").then(n.bind(null,"4bd2"))}),{},{success:this.onEditSuccess})},onBatchImport:function(){this.$openModal((function(){return n.e("chunk-2d0da7ad").then(n.bind(null,"6c7a"))}),{typeList:this.typeList},{success:this.onEditSuccess})},onBatchExport:function(t,e){var n=this,r=e.typeId||[],a=r[r.length-1];a?Object(u["i"])({fileName:"工单批量导出数据.xls",action:function(){return n.$post(t,Object(i["a"])(Object(i["a"])({},e),{},{typeId:a}),{responseType:"blob"})}}):this.$message("请先选择分类再导出")},onDetail:function(t){this.$router.push({name:"".concat(c,"-detail"),params:{id:t.id}})},onAccept:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t instanceof Array?t.map((function(t){return t.id}))+"":t.id,n.next=3,e.$post("/workOrder/accept",{orderId:r});case 3:e.$message.success("接单成功"),e.getData();case 5:case"end":return n.stop()}}),n)})))()},getTypes:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http("/orderType/listByPage");case 2:t.types=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},getTypeText:function(t){return I(this.types,t)},onKeyChange:function(){var t=this;this.options.forEach((function(e){t.$set(t.searchForm,e[0],void 0)}))},onCustomField:function(){var t=this;this.$openModal("UiFieldCustom",{columns:this.allColumns,defaultProps:this.defaultProps,selectedProps:this.selectedProps},{success:function(e){t.selectedProps=e}})}}}}}]);